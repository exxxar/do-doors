import{_ as j,a as T}from"./DoorItemEditor-CVIeq5PZ.js";import{m as C,l as E,o as e,c as t,b as s,f as r,t as d,n as f,e as n,F as p,r as w,p as D,g as $,d as k,v as F,a as z,w as I,j as O}from"./app-z9kiq6Oc.js";import{L,I as B,C as S}from"./IndividualDataForm-192GgHrx.js";import{v as H}from"./vue-the-mask-5y75_0cE.js";const M={key:0,class:"row"},P={class:"col-md-6"},N={class:"row"},W={class:"col-md-6 col-12 mb-2"},U=["disabled"],q=s("i",{class:"fa-solid fa-floppy-disk"},null,-1),J={class:"col-md-6 col-12 mb-2"},G={class:"card rounded-0 border-black"},R={class:"card-body px-2 py-1"},A=s("label",{class:"font-size-10"},[s("i",{class:"fa-solid fa-signs-post"}),r(" Назначение двери")],-1),K={class:"col-md-6 col-12 mb-2"},Q={class:"card rounded-0 border-black"},X={class:"card-body px-2 py-1"},Y=s("label",{class:"font-size-10"},[s("i",{class:"fa-solid fa-ruler-vertical"}),r(" Высота, мм")],-1),Z=["innerHTML"],x={class:"col-md-6 col-12 mb-2"},ss={class:"card rounded-0 border-black"},os={class:"card-body px-2 py-1"},es=s("label",{class:"font-size-10"},[s("i",{class:"fa-solid fa-ruler-horizontal"}),r(" Ширина, мм ")],-1),ts=["innerHTML"],ls={class:"col-md-6 col-12 mb-2"},ds={class:"card rounded-0 border-black"},is={class:"card-body px-2 py-1"},ns=s("label",{class:"font-size-10"},[s("i",{class:"fa-brands fa-openid"}),r(" Тип открытия двери и толщина ")],-1),rs={class:"col-md-6 col-12 mb-2"},as={class:"card rounded-0 border-black"},cs={class:"card-body px-2 py-1"},_s=s("label",{class:"font-size-10"},[s("i",{class:"fa-solid fa-door-open"}),r(" Тип двери ")],-1),hs={class:"col-md-6 col-12 mb-2"},us={class:"card rounded-0 border-black"},ps={class:"card-body px-2 py-1"},fs=s("label",{class:"font-size-10"},[s("i",{class:"fa-solid fa-industry"}),r(" Производитель петель ")],-1),bs={class:"col-md-6 col-12 mb-2"},ms={class:"card rounded-0 border-black"},ys={class:"card-body px-2 py-1"},vs=s("label",{class:"font-size-10"},[s("i",{class:"fa-solid fa-angles-left"}),r(" Сторона петель ")],-1),ks={class:"col-md-6 col-12 mb-2"},gs={class:"card rounded-0 border-black"},$s={class:"card-body px-2 py-1"},ws=s("label",{class:"font-size-10"},[s("i",{class:"fa-solid fa-paint-roller"}),r(" Отделка первой стороны ")],-1),Fs={class:"col-md-6 col-12 mb-2"},Cs={class:"card-body px-2 py-1"},Ds=s("label",{class:"font-size-10"},[s("i",{class:"fa-solid fa-palette"}),r(" Цвет отделки первой стороны ")],-1),zs={key:1,class:"card rounded-0"},Vs=s("div",{class:"card-body p-3 disabled-element"},[s("p",{class:"text-center"},'Выбрано "Под покраску"')],-1),js=[Vs],Ts={class:"col-md-6 col-12 mb-2"},Es={class:"card rounded-0 border-black"},Is={class:"card-body px-2 py-1"},Os=s("label",{class:"font-size-10"},[s("i",{class:"fa-solid fa-paint-roller"}),r(" Отделка второй стороны ")],-1),Ls={class:"col-md-6 col-12 mb-2"},Bs={class:"card-body px-2 py-1"},Ss=s("label",{class:"font-size-10"},[s("i",{class:"fa-solid fa-palette"}),r(" Цвет отделки второй стороны ")],-1),Hs={key:1,class:"card rounded-0"},Ms=s("div",{class:"card-body p-3 disabled-element"},[s("p",{class:"text-center"},'Выбрано "Под покраску"')],-1),Ps=[Ms],Ns={class:"col-md-6 col-12 mb-2"},Ws={class:"card-body px-2 py-1"},Us=s("label",{class:"font-size-10"},[s("i",{class:"fa-solid fa-palette"}),r(" Цвет короба и каркаса ")],-1),qs={class:"col-md-6 col-12 mb-2"},Js={class:"card-body px-2 py-1"},Gs=s("label",{class:"font-size-10"},[s("i",{class:"fa-solid fa-palette"}),r(" Цвет уплотнителя ")],-1),Rs={class:"col-md-6 col-12 mb-2"},As={class:"card-body px-2 py-1"},Ks=s("label",{class:"font-size-10"},[s("i",{class:"fa-solid fa-palette"}),r(" Цвет фурнитуры ")],-1),Qs={key:0,class:"col-md-6 col-12 mb-2"},Xs={class:"card-body px-2 py-1"},Ys=s("label",{class:"font-size-10"},[s("i",{class:"fa-solid fa-palette"}),r(" Цвет фурнитуры ")],-1),Zs={class:"col-12 mb-2"},xs={style:{"min-height":"100px"},class:"card rounded-0 border-black"},so={class:"card-body px-2 py-1"},oo=s("label",{class:"font-size-10"},"Комментарий к двери ",-1),eo={key:0,class:"row py-3"},to={class:"col-12 d-flex align-items-center"},lo={key:0,class:"fw-bold"},io={key:1,class:"fw-bold"},no={key:0,class:"col-md-6 col-12 mb-2"},ro={class:"card rounded-0 border-black"},ao={class:"card-body px-2 py-1"},co=s("label",{class:"font-size-10"},"Отверстие под ручку ",-1),_o={key:1,class:"col-md-6 col-12 mb-2"},ho={key:0,class:"card rounded-0 border-black mb-2"},uo={class:"card-body px-2 py-1"},po=s("label",{class:"font-size-10"},"Вариант ручки ",-1),fo={key:1,class:"card rounded-0 border-black"},bo={class:"card-body px-2 py-1"},mo=s("label",{class:"font-size-10"},"Вариант завертки ",-1),yo={key:2,class:"col-12"},vo={class:"row"},ko={class:"col-12"},go={class:"mb-2"},$o={class:"col-lg-3 col-md-3 col-12 mb-2"},wo=["onClick"],Fo={class:"card-img-top",alt:"..."},Co={class:"card-body"},Do={key:0,class:"font-bold"},zo={key:1,class:"card-text"},Vo={key:3,class:"col-12"},jo=s("div",{class:"alert alert-warning rounded-0",role:"alert"},[s("p",null,"Вариантов изображений ручки нет")],-1),To=[jo],Eo={class:"col-12 d-flex align-items-center"},Io={key:0,class:"fw-bold"},Oo={key:1,class:"fw-bold"},Lo={class:"col-12 d-flex align-items-center"},Bo={key:0,class:"fw-bold"},So={key:1,class:"fw-bold"},Ho={key:4,class:"col-12"},Mo={class:"card rounded-0 border-black"},Po={class:"card-body px-2 py-1"},No=s("label",{class:"font-size-10"},"Вариант ",-1),Wo={class:"col-12 d-flex align-items-center"},Uo={key:0,class:"fw-bold"},qo={key:1,class:"fw-bold"},Jo={key:5,class:"col-12"},Go={class:"card rounded-0 border-black"},Ro={class:"card-body px-2 py-1"},Ao=s("label",{class:"font-size-10"},"Вариант ",-1),Ko={class:"col-12 d-flex align-items-center"},Qo={key:0,class:"fw-bold"},Xo={key:1,class:"fw-bold"},Yo={key:6,class:"col-12"},Zo={class:"card rounded-0 border-black"},xo={class:"card-body px-2 py-1"},se=s("label",{class:"font-size-10"},"Вариант ",-1),oe={class:"col-12 d-flex align-items-center"},ee={key:0,class:"fw-bold"},te={key:1,class:"fw-bold"},le={class:"col-12 d-flex align-items-center"},de={key:0,class:"fw-bold"},ie={key:1,class:"fw-bold"},ne={class:"col-12 d-flex align-items-center"},re={key:0,class:"fw-bold"},ae={key:1,class:"fw-bold"},ce={class:"col-md-6"},_e={class:"preview"},he={class:"card rounded-0 mt-3"},ue={class:"card-body"},pe=s("h6",null,"Характеристики",-1),fe={class:"text-muted font-bold"},be={class:"text-black mb-0"},me={key:0,class:"mr-1"},ye={key:1,class:"mr-1"},ve={key:2,class:"mr-1"},ke={key:3,class:"mr-1"},ge={key:4,class:"mr-1"},$e={key:5,class:"mr-1"},we={key:6,class:"mr-1"},Fe={key:7,class:"mr-1"},Ce={class:"row row-cols-md-2 mt-3"},De={class:"col mb-2"},ze={class:"card rounded-0 border-black"},Ve={class:"card-body px-2 py-1"},je=s("label",{class:"font-size-10"},"Тип цены ",-1),Te={key:0,class:"col mb-2"},Ee={class:"card rounded-0 border-black"},Ie={class:"card-body px-2 py-1"},Oe=s("label",{class:"font-size-10"},"Процент дилера ",-1),Le={class:"col mb-2"},Be={class:"card rounded-0 border-black"},Se={class:"card-body px-2 py-1"},He=s("label",{class:"font-size-10"},"Кол-во ",-1),Me={class:"col mb-2"},Pe={class:"card rounded-0 border-black"},Ne={class:"card-body px-2 py-1"},We=s("label",{class:"font-size-10"},"Цена ",-1),Ue={key:1,class:"col d-flex mb-2"},qe=s("i",{class:"fa-solid fa-floppy-disk"},null,-1),Je={key:1,class:"card rounded-0 mt-3"},Ge={class:"card-body"},Re={class:"table"},Ae=s("br",null,null,-1),Ke={key:0},Qe=s("br",null,null,-1),Xe={key:1,class:"row"},Ye=s("div",{class:"col-12"},[s("div",{class:"d-flex justify-content-center align-items-center flex-column",style:{"min-height":"500px"}},[s("h5",null,"Загружаем страничку...."),s("div",{class:"spinner-border my-3",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")])])],-1),Ze=[Ye],xe={name:"MyComponent",props:["modelValue","canEdit"],data(){return{loaded:!1,door:null,type_dictionary:{size:"Петли",handle_holes_type:"Отверстие под ручку",opening_type:"Тип открытия двери и толщина",box_and_frame_color:"Цвет короба и каркаса",door_type:"Тип двери",front_side_finish_color:"Цвет отделки внешней стороны",back_side_finish_color:"Цвет отделки внутренней стороны",seal_color:"Цвет уплотнителя",fittings_color:"Цвет фурнитуры",hinge_manufacturer:"Производитель петель",front_side_finish:"Отделка внешней стороны",back_side_finish:"Отделка внутренней стороны",base:"База (под покраску)",service_doorstep:"Работа с порогом",service_painting:"Покраска фурнитуры",service_door_closer:"Работа с доводчиком",service_handle:"Работа с ручками",service_stopper:"Работа со стопором"},tmp_prices:[],need_addition:!0,messages:[],filterHeight:null,filterWidth:null,selectedColorParam:null,loadedParams:!0,confirmModal:null,finishFrontVariantModal:null,finishBackVariantModal:null,colors:[],confirm:{title:null,message:null},color_sync_update:!1}},computed:{...C(["getErrors","getDictionary","cartTotalCount","cartProducts","cartTotalPrice"])},watch:{door:{handler(l){this.$emit("update:modelValue",this.door)},deep:!0}},mounted(){this.door=this.modelValue},methods:{editVariant(){this.$emit("edit")},invertHex(l){if(!l)return"#000000";var o=l.replace(/#/,""),i=parseInt(o.substr(0,2),16),c=parseInt(o.substr(2,2),16),h=parseInt(o.substr(4,2),16),u=(.2126*i+.7152*c+.0722*h)/255;return u>.5?"#000000":"#ffffff"}}},st=Object.assign(xe,{setup(l){return(o,i)=>{var h,u,b,m,y,v,a;const c=E("lazy");return o.door?(e(),t("div",M,[s("div",P,[s("div",N,[s("div",W,[s("button",{disabled:!l.canEdit,onClick:i[0]||(i[0]=(..._)=>o.editVariant&&o.editVariant(..._)),type:"button",class:"btn btn-dark rounded-0 w-100 p-3"},[q,r(" Редактировать ")],8,U)]),s("div",J,[s("div",G,[s("div",R,[A,s("p",null,d(o.door.purpose||"Не указано"),1)])])]),s("div",K,[s("div",Q,[s("div",X,[Y,s("p",{innerHTML:o.door.height},null,8,Z)])])]),s("div",x,[s("div",ss,[s("div",os,[es,s("p",{innerHTML:o.door.width},null,8,ts)])])]),s("div",ls,[s("div",ds,[s("div",is,[ns,s("p",null,d(o.door.opening_type.title||"-")+" (толщина "+d(o.door.opening_type.depth)+" мм)",1)])])]),s("div",rs,[s("div",as,[s("div",cs,[_s,s("p",null,d(o.door.door_type.title||"-"),1)])])]),s("div",hs,[s("div",us,[s("div",ps,[fs,s("p",null,d(o.door.hinge_manufacturer.title||"-"),1)])])]),s("div",bs,[s("div",ms,[s("div",ys,[vs,s("p",null,d(((h=o.door.loops)==null?void 0:h.title)||"-"),1)])])]),s("div",ks,[s("div",gs,[s("div",$s,[ws,s("p",null,d(((u=o.door.front_side_finish)==null?void 0:u.title)||"-"),1)])])]),s("div",Fs,[o.door.front_side_finish.title!=="Под покраску"?(e(),t("div",{key:0,style:f({"background-color":o.door.front_side_finish.code,color:o.invertHex(o.door.front_side_finish.code)}),class:"card rounded-0 border-black"},[s("div",Cs,[Ds,s("p",null,d(o.door.front_side_finish.title||"-"),1)])],4)):(e(),t("div",zs,js))]),s("div",Ts,[s("div",Es,[s("div",Is,[Os,s("p",null,d(o.door.back_side_finish.title||"-"),1)])])]),s("div",Ls,[o.door.back_side_finish.title!=="Под покраску"?(e(),t("div",{key:0,style:f({"background-color":o.door.back_side_finish.code,color:o.invertHex(o.door.back_side_finish.code)}),class:"card rounded-0 border-black"},[s("div",Bs,[Ss,s("p",null,d(o.door.back_side_finish.title||"-"),1)])],4)):(e(),t("div",Hs,Ps))]),s("div",Ns,[s("div",{style:f({"background-color":o.door.box_and_frame_color.code,color:o.invertHex(o.door.box_and_frame_color.code)}),class:"card rounded-0 border-black"},[s("div",Ws,[Us,s("p",null,d(o.door.box_and_frame_color.title||"-"),1)])],4)]),s("div",qs,[s("div",{style:f({"background-color":o.door.seal_color.code,color:o.invertHex(o.door.seal_color.code)}),class:"card rounded-0 border-black"},[s("div",Js,[Gs,s("p",null,d(o.door.seal_color.title||"-"),1)])],4)]),s("div",Rs,[s("div",{style:f({"background-color":o.door.fittings_color.code,color:o.invertHex(o.door.fittings_color.code)}),class:"card rounded-0 border-black"},[s("div",As,[Ks,s("p",null,d(o.door.fittings_color.title||"-"),1)])],4)]),o.door.fittings_color.title!=null&&o.door.fittings_color.is_ral?(e(),t("div",Qs,[s("div",{style:f({"background-color":o.door.service_painting.code,color:o.invertHex(o.door.service_painting.code)}),class:"card rounded-0 border-black"},[s("div",Xs,[Ys,s("p",null,d(o.door.service_painting.title||"-"),1)])],4)])):n("",!0),s("div",Zs,[s("div",xs,[s("div",so,[oo,s("p",null,d(o.door.comment||"-"),1)])])])]),o.need_addition?(e(),t("div",eo,[s("div",to,[s("p",null,[r(" Ручка: "),o.door.need_handle_holes?(e(),t("span",lo,"нужна")):(e(),t("span",io,"не нужна"))])]),o.door.need_handle_holes?(e(),t("div",no,[s("div",ro,[s("div",ao,[co,s("p",null,d(((b=o.door.handle_holes)==null?void 0:b.title)||"-"),1)])])])):n("",!0),o.door.need_handle_holes?(e(),t("div",_o,[o.door.handle_holes.id===1||o.door.handle_holes.id===2?(e(),t("div",ho,[s("div",uo,[po,s("p",null,d(o.door.handle_holes_type.title||"-"),1)])])):n("",!0),o.door.handle_holes.id===2?(e(),t("div",fo,[s("div",bo,[mo,s("p",null,d(o.door.handle_wrapper_type.title||"-"),1)])])):n("",!0)])):n("",!0),(o.door.handle_holes_type.variants||[]).length>0&&o.door.need_handle_holes&&o.door.handle_holes.id!==3?(e(),t("div",yo,[s("div",vo,[s("div",ko,[s("p",go,[r("Цвет ручки "+d(o.door.handle_holes_type.color||"не указан")+" ",1),o.door.handle_holes_type.color?(e(),t("span",{key:0,class:"d-inline-block",style:f([{"background-color":o.door.handle_holes_type.color},{width:"50px",height:"10px"}])},null,4)):n("",!0)])]),(e(!0),t(p,null,w(o.door.handle_holes_type.variants,(_,g)=>(e(),t("div",$o,[s("div",{class:D(["card cursor-pointer",{"border-secondary shadow-lg":_.selected}]),onClick:V=>o.selectSideFinish("handle_holes_type","variants",g)},[$(s("img",Fo,null,512),[[c,_.image]]),s("div",Co,[_.title?(e(),t("h6",Do,d(_.title||"не указано"),1)):n("",!0),_.description?(e(),t("p",zo,d(_.description||"не указано"),1)):n("",!0)])],10,wo)]))),256))])])):n("",!0),(o.door.handle_holes_type.variants||[]).length===0&&o.door.need_handle_holes?(e(),t("div",Vo,To)):n("",!0),s("div",Eo,[s("p",null,[r(" Верхняя перемычка: "),o.door.need_upper_jumper?(e(),t("span",Io,"нужна")):(e(),t("span",Oo,"не нужна"))])]),s("div",Lo,[s("p",null,[r(" Автоматический порог: "),o.door.need_upper_jumper?(e(),t("span",Bo,"нужен")):(e(),t("span",So,"не нужен"))])]),o.door.need_automatic_doorstep?(e(),t("div",Ho,[s("div",Mo,[s("div",Po,[No,s("p",null,d(((m=o.door.service_doorstep)==null?void 0:m.title)||"-"),1)])])])):n("",!0),s("div",Wo,[s("p",null,[r(" Скрытый стопор: "),o.door.need_hidden_stopper?(e(),t("span",Uo,"нужен")):(e(),t("span",qo,"не нужен"))])]),o.door.need_hidden_stopper?(e(),t("div",Jo,[s("div",Go,[s("div",Ro,[Ao,s("p",null,d(((y=o.door.service_stopper)==null?void 0:y.title)||"-"),1)])])])):n("",!0),s("div",Ko,[s("p",null,[r(" Скрытый доводчик: "),o.door.need_hidden_door_closer?(e(),t("span",Qo,"нужен")):(e(),t("span",Xo,"не нужен"))])]),o.door.need_hidden_door_closer?(e(),t("div",Yo,[s("div",Zo,[s("div",xo,[se,s("p",null,d(((v=o.door.service_door_closer)==null?void 0:v.title)||"-"),1)])])])):n("",!0),s("div",oe,[s("p",null,[r(" Скрытый плинтус: "),o.door.need_hidden_skirting_board?(e(),t("span",ee,"нужен")):(e(),t("span",te,"не нужен"))])]),s("div",le,[s("p",null,[r(" Установка двери: "),o.door.need_door_install?(e(),t("span",de,"нужна")):(e(),t("span",ie,"не нужна"))])]),s("div",ne,[s("p",null,[r(" Упаковка двери: "),o.door.need_wrapper?(e(),t("span",re,"нужна")):(e(),t("span",ae,"не нужна"))])])])):n("",!0)]),s("div",ce,[s("div",_e,[o.loadedParams?(e(),k(j,{key:0,disabled:!0,modelValue:o.door,"onUpdate:modelValue":i[1]||(i[1]=_=>o.door=_)},null,8,["modelValue"])):n("",!0),s("div",he,[s("div",ue,[pe,s("h6",fe,d(o.door.door_type.title)+" "+d(o.door.width)+"x"+d(o.door.height)+"x"+d(((a=o.door.opening_type)==null?void 0:a.depth)||0),1),s("h6",be,[o.door.box_and_frame_color.title?(e(),t("span",me,"("+d(o.door.box_and_frame_color.title)+"),",1)):n("",!0),o.door.front_side_finish.title?(e(),t("span",ye,"первая сторона "+d(o.door.front_side_finish.title)+", ",1)):n("",!0),o.door.back_side_finish.title?(e(),t("span",ve,"/вторая сторона "+d(o.door.back_side_finish.title)+",",1)):n("",!0),o.door.loops.title?(e(),t("span",ke,"петли "+d(o.door.loops.title),1)):n("",!0),o.door.hinge_manufacturer.title?(e(),t("span",ge,d(o.door.hinge_manufacturer.title),1)):n("",!0),o.door.fittings_color.title?(e(),t("span",$e,"("+d(o.door.fittings_color.title)+"),",1)):n("",!0),o.door.opening_type.title?(e(),t("span",we,d(o.door.opening_type.title)+",",1)):n("",!0),o.door.handle_holes.title?(e(),t("span",Fe,d(o.door.handle_holes.title),1)):n("",!0)]),s("div",Ce,[s("div",De,[s("div",ze,[s("div",Ve,[je,s("p",null,d(o.door.price_type.title||"-"),1)])])]),o.door.price_type.id===3?(e(),t("div",Te,[s("div",Ee,[s("div",Ie,[Oe,s("p",null,d(o.door.dealer_percent||"0"),1)])])])):n("",!0),s("div",Le,[s("div",Be,[s("div",Se,[He,s("p",null,d(o.door.count||"0"),1)])])]),s("div",Me,[s("div",Pe,[s("div",Ne,[We,s("p",null,d(o.door.price)+" ₽",1)])])]),l.canEdit?(e(),t("div",Ue,[s("button",{onClick:i[2]||(i[2]=(..._)=>o.editVariant&&o.editVariant(..._)),type:"button",class:"btn btn-dark rounded-0 w-100"},[qe,r(" Редактировать ")])])):n("",!0)])])]),o.tmp_prices.length>0?(e(),t("div",Je,[s("div",Ge,[s("table",Re,[s("tbody",null,[(e(!0),t(p,null,w(o.tmp_prices,_=>(e(),t("tr",null,[s("td",null,[r(d(o.type_dictionary[_.type]||_.type)+" ",1),o.door[_.type]?(e(),t(p,{key:0},[Ae,o.door[_.type].description?(e(),t("small",Ke,"("+d(o.door[_.type].description)+")",1)):n("",!0)],64)):n("",!0)]),s("td",null,[r(d(_.price||0)+" руб. ",1),_.full_price?(e(),t(p,{key:0},[Qe,s("small",null,"("+d(_.full_price||0)+" руб.)",1)],64)):n("",!0)])]))),256))])])])])):n("",!0)])])])):(e(),t("div",Xe,Ze))}}}),ot=s("div",{class:"alert alert-danger"}," Внимание! Редактирование заказа на текущий момент на стадии доработки! ",-1),et={class:"form-floating mb-2"},tt=s("label",{for:"contractNumber"},"Номер договора",-1),lt={class:"input-group mb-2"},dt={class:"form-floating"},it=s("label",{for:"checkout-name"},"Название компании\\Ф.И.О. ИП",-1),nt={key:0,class:"btn btn-outline-secondary",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},rt=s("i",{class:"fa-solid fa-up-right-and-down-left-from-center"},null,-1),at=[rt],ct={style:{"overflow-y":"scroll",height:"400px",width:"100%"},class:"dropdown-menu dropdown-menu-end rounded-0"},_t=s("i",{class:"fa-solid fa-ban"},null,-1),ht=s("li",null,[s("hr",{class:"dropdown-divider"})],-1),ut=s("i",{class:"fa-solid fa-plus"},null,-1),pt=s("li",null,[s("hr",{class:"dropdown-divider"})],-1),ft={class:"p-2"},bt={class:"form-floating mb-3"},mt={for:"floatingInput"},yt=["onClick"],vt=s("br",null,null,-1),kt={class:"badge rounded-0 btn-dark",style:{"font-size":"8px"}},gt=["href"],$t={key:0,class:"d-flex justify-content-center my-3"},wt=s("div",{class:"spinner-border text-primary mx-2",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")],-1),Ft={key:1,class:"card rounded-0"},Ct=s("div",{class:"card-body"},[s("p",null,"Вы должны добавить в корзину хотя бы одно изделие")],-1),Dt=[Ct],zt={props:["type","action","doors","order"],directives:{mask:H.mask},computed:{...C(["getErrors","getDictionary","cartTotalCount","cartTotalPrice","cartProducts"]),filteredClients(){if(!this.search)return this.self_clients||[];const l=this.search.toLowerCase();return this.self_clients.filter(o=>(o.title||"").toLowerCase().includes(l)||(o.fio||"").toLowerCase().includes(l))}},watch:{},data(){return{edit_requisites:!1,search:null,tab:0,timer:null,step:0,editor_modal:null,self_clients:[],clientForm:{id:null,name:null,phone:null,email:null,info:null,promo:null,contract_number:null,dealer_percent:0,summary_price_type:null,work_with_nds:1,items:[],current_payed:0,payed_percent:70,payed_percent_type:1,delivery_terms:null,ascent_floor:!1,work_days:0,installation:{need_door_install:!1,count:0,price:0,recount_type:0},designer:{is_fix:!1,value:0,price:0},passport:null,passport_issued:null,need_delivery:!1,delivery_type:1,delivery_address:null,delivery_price:null,delivery_city:null,delivery_service:null,discount_data:null}}},mounted(){var l,o;this.loadSelfClients(),this.clientForm.id=this.order.id,this.clientForm.contract_number=this.order.contract_number||this.order.id,this.clientForm.name=this.order.contact_person||null,this.clientForm.phone=((l=this.order.client)==null?void 0:l.phone)||null,this.clientForm.email=((o=this.order.client)==null?void 0:o.email)||null,this.clientForm.work_with_nds=this.order.organizational_form==="individual"?0:1},methods:{showEditorForm(){window.location.href="/clients"},selectItem(){},back(){console.log("click back"),this.$emit("callback")},preparedLawStatus(l){let i=(this.getDictionary.statuses||[]).find(c=>c.value===l)||null;return i?i.title:null},selectInfo(l){if(l==null){this.clientForm.id=null,this.clientForm.name=null,this.clientForm.email=null,this.clientForm.phone=null,this.clientForm.pasport=null,this.clientForm.pasport_issued=null,this.clientForm.fact_address=null;return}this.clientForm.id=l.id||null,this.clientForm.name=l.title||null,this.clientForm.email=l.email||null,this.clientForm.phone=l.phone||null,this.clientForm.delivery_address=l.fact_address||null,this.clientForm.pasport=l.pasport||null,this.clientForm.pasport_issued=l.pasport_issued||null},clearCart(){this.$store.dispatch("clearCart").then(l=>{this.$notify({title:"DoDoors",text:"Успешно очищено",type:"success"})}).catch(l=>{this.$notify({title:"DoDoors",text:"Ошибочка...",type:"error"})})},findPromo(){this.discount=0,!((this.clientForm.promo||"").length<=5)&&this.$store.dispatch("findPromoCode",{code:this.clientForm.promo}).then(l=>{this.discount=l.discount||0})},loadSelfClients(){this.$store.dispatch("loadSelfClients").then(l=>{this.self_clients=l.data||[]}).catch(()=>{})},submit(){this.timer=0;let l=setInterval(()=>{this.timer++},1e3);this.clientForm.items=this.cartProducts;let o=new FormData;Object.keys(this.clientForm).forEach(i=>{const c=this.clientForm[i]||"";typeof c=="object"?o.append(i,JSON.stringify(c)):o.append(i,c)}),o.append("items",JSON.stringify(this.doors)),o.append("total_price",this.cartTotalPrice),o.append("total_count",this.cartTotalCount),this.$store.dispatch("editOrder",{clientForm:o}).then(i=>{clearInterval(l),this.timer=null,this.step=0,this.tab=0,this.$store.dispatch("clearCart"),this.clientForm={name:null,phone:null,email:null,info:null,passport:null,passport_issued:null,delivery_address:null},this.$notify({title:"DoDoors",text:"Заказ передан менеджеру!",type:"success"}),this.loadSelfClients()}).catch(i=>{clearInterval(l),this.timer=null,this.$notify({title:"DoDoors",text:"Ошибочка...",type:"error"})})}}},Vt=Object.assign(zt,{__name:"CheckoutFormEditor",setup(l){return(o,i)=>(l.doors||[]).length>0?(e(),t("form",{key:0,onSubmit:i[8]||(i[8]=O((...c)=>o.submit&&o.submit(...c),["prevent"]))},[ot,s("div",et,[$(s("input",{type:"text","onUpdate:modelValue":i[0]||(i[0]=c=>o.clientForm.contract_number=c),class:"form-control",id:"contractNumber",required:"",placeholder:"Введите номер договора"},null,512),[[F,o.clientForm.contract_number]]),tt]),s("div",lt,[s("div",dt,[$(s("input",{type:"text",class:"form-control","onUpdate:modelValue":i[1]||(i[1]=c=>o.clientForm.name=c),id:"checkout-name",placeholder:"name@example.com",required:""},null,512),[[F,o.clientForm.name]]),it]),o.self_clients.length>0?(e(),t("button",nt,at)):n("",!0),s("ul",ct,[s("li",null,[s("a",{class:"dropdown-item",onClick:i[2]||(i[2]=c=>o.selectInfo(null)),href:"javascript:void(0)"},[_t,r(" Не выбрано")])]),ht,s("li",null,[s("a",{class:"dropdown-item",onClick:i[3]||(i[3]=(...c)=>o.showEditorForm&&o.showEditorForm(...c)),href:"javascript:void(0)"},[ut,r(" Создать нового")])]),pt,s("li",null,[s("div",ft,[s("div",bt,[$(s("input",{type:"search","onUpdate:modelValue":i[4]||(i[4]=c=>o.search=c),class:"form-control",id:"floatingInput",placeholder:"Имя"},null,512),[[F,o.search]]),s("label",mt,"Поиск (найдено "+d(o.filteredClients.length||0)+" клиентов) ",1)])]),(e(!0),t(p,null,w(o.filteredClients,(c,h)=>(e(),t("a",{class:D([{"btn-light":h%2===0},"p-2 d-block btn rounded-0"]),style:{"word-wrap":"break-word","overflow-wrap":"break-word"},href:"javascript:void(0)",onClick:u=>o.selectInfo(c)},[r(d(c.title||c.phone)+" ",1),vt,s("span",kt,d(o.preparedLawStatus(c.status)||"Не указан"),1)],10,yt))),256))])])]),o.clientForm.id?(e(),t("a",{key:0,class:"btn btn-link mb-2 p-0",href:"/client/"+o.clientForm.id,target:"_blank"},"Редактировать клиента",8,gt)):n("",!0),(l.type||0)===0?(e(),k(L,{key:1,modelValue:o.clientForm,"onUpdate:modelValue":i[5]||(i[5]=c=>o.clientForm=c)},null,8,["modelValue"])):n("",!0),(l.type||0)===1?(e(),k(B,{key:2,modelValue:o.clientForm,"onUpdate:modelValue":i[6]||(i[6]=c=>o.clientForm=c)},null,8,["modelValue"])):n("",!0),z(S,{disabled:o.timer,modelValue:o.clientForm,"onUpdate:modelValue":i[7]||(i[7]=c=>o.clientForm=c)},{loader:I(()=>[o.timer?(e(),t("div",$t,[wt,r(" Отправляем... ")])):n("",!0)]),_:1},8,["disabled","modelValue"])],32)):(e(),t("div",Ft,Dt))}}),jt={class:"row"},Tt={class:"col-12 mb-2 d-flex align-items-center"},Et={class:"d-flex justify-content-between w-100 align-items-center"},It={class:"d-flex"},Ot={class:"btn-group"},Lt=["disabled"],Bt=s("i",{class:"fa-regular fa-square-caret-left"},null,-1),St=[Bt],Ht={class:"btn rounded-0"},Mt=["disabled"],Pt=s("i",{class:"fa-regular fa-square-caret-right"},null,-1),Nt=[Pt],Wt=s("button",{class:"btn btn-dark rounded-0 ml-2",type:"button","data-bs-toggle":"offcanvas","data-bs-target":"#offcanvasWithBothOptions","aria-controls":"offcanvasWithBothOptions"},[s("i",{class:"fa-solid fa-arrow-up-right-from-square"}),r(" Список дверей в заказе ")],-1),Ut={class:"d-flex align-items-center"},qt={class:"fw-bold"},Jt={class:"dropdown"},Gt=s("button",{class:"btn btn-link",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[s("i",{class:"fa-solid fa-bars"})],-1),Rt={class:"dropdown-menu"},At=s("i",{class:"fa-solid fa-paper-plane mr-2"},null,-1),Kt=s("i",{class:"fa-solid fa-square-arrow-up-right mr-2"},null,-1),Qt=s("i",{class:"fa-solid fa-envelope mr-2"},null,-1),Xt=s("li",null,[s("hr",{class:"dropdown-divider"})],-1),Yt=["href"],Zt=s("i",{class:"fa-regular fa-file-excel mr-2"},null,-1),xt=["href"],sl=s("i",{class:"fa-solid fa-file-signature mr-2"},null,-1),ol=s("li",null,[s("hr",{class:"dropdown-divider"})],-1),el=s("i",{class:"fa-solid fa-trash-can mr-2"},null,-1),tl={key:0,class:"row"},ll={class:"col-lg-12"},dl={key:1,class:"row"},il={class:"col-lg-12"},nl={class:"offcanvas offcanvas-end","data-bs-scroll":"true",tabindex:"-1",id:"offcanvasWithBothOptions","aria-labelledby":"offcanvasWithBothOptionsLabel"},rl={class:"offcanvas-header"},al={key:0,class:"offcanvas-title fw-bold",id:"offcanvasWithBothOptionsLabel"},cl={key:1,class:"offcanvas-title fw-bold",id:"offcanvasWithBothOptionsLabel"},_l=s("button",{type:"button",class:"btn-close","data-bs-dismiss":"offcanvas","aria-label":"Close"},null,-1),hl={key:0,class:"offcanvas-body"},ul=["onClick"],pl={class:"card-body"},fl={class:"text-muted font-bold"},bl={class:"text-black mb-0"},ml={key:0},yl={key:1,class:"ml-1"},vl={key:2,class:"ml-1"},kl={key:3},gl={key:4,class:"ml-1"},$l={key:5,class:"ml-1"},wl={key:6,class:"ml-1"},Fl={key:7,class:"ml-1"},Cl={key:8,class:"ml-1"},Dl={key:9,class:"ml-1"},zl={key:10,class:"ml-1"},Vl={key:11,class:"ml-1"},jl={key:12,class:"ml-1"},Tl={key:13,class:"ml-1"},El={key:14,class:"ml-1"},Il={key:15,class:"ml-1"},Ol={key:16,class:"ml-1"},Ll={key:0,class:"card rounded-0"},Bl={class:"card-body"},Sl=s("h6",{class:"fw-bold mb-2"},"Сводная информация по заказу",-1),Hl={class:"d-flex justify-content-between"},Ml={class:"fw-bold"},Pl={class:"d-flex justify-content-between"},Nl={class:"fw-bold"},Wl={class:"d-flex justify-content-between"},Ul={class:"fw-bold"},ql={class:"d-flex justify-content-between"},Jl={key:0,class:"fw-bold"},Gl={key:1,class:"fw-bold"},Rl={class:"d-flex justify-content-between"},Al={class:"fw-bold"},Kl={class:"d-flex justify-content-between"},Ql={class:"fw-bold"},Xl={class:"d-flex justify-content-between"},Yl={class:"fw-bold"},Zl={class:"d-flex justify-content-between"},xl={class:"fw-bold"},sd={class:"d-flex justify-content-between mt-3 fw-bold"},od={class:"d-flex justify-content-between fw-bold"},ed={key:1,class:"card rounded-0"},td=s("div",{class:"card-body d-flex flex-column align-items-center"},[s("div",{class:"spinner-border",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")]),s("p",null,"Обновляем информацию о заказе...")],-1),ld=[td],dd={class:"offcanvas-body p-3"},id={class:"offcanvas-footer p-3"},nd={key:2,class:"offcanvas-footer p-3"},rd={key:1,class:"alert alert-dark"},ad={props:["doors","order","canEdit"],name:"MyComponent",data(){return{loading:!1,tab:0,cart_tab:0,timer:null,selected_index:0,formData:{contract_number:null,work_with_nds:null}}},computed:{...C(["getErrors"]),summary(){var o,i;let l=this.order;return l.total_price+(((o=l.config)==null?void 0:o.delivery_price)||0)+(((i=l.config)==null?void 0:i.install_price)||0)},summaryWithDiscount(){var l;return this.summary-(((l=this.order.discount)==null?void 0:l.amount)||0)}},mounted(){this.formData.contract_number=this.order.contract_number||null},methods:{sendOrder(l=!1,o=!1,i=!1){this.$store.dispatch("sendOrderToBitrix",{order_id:this.order.id,send_to_telegram:o,send_to_email:l,send_to_bitrix:i}).then(()=>{this.$notify({title:"DoDoors",text:"Информация успешно отправлена",type:"success"})}).catch(()=>{this.$notify({title:"DoDoors",text:"Ошибка отправки информации ",type:"error"})})},sendToBitrix(){this.sendOrder(!1,!1,!0)},sendToTelegram(){this.sendOrder(!1,!0,!1)},sendToEmail(){this.sendOrder(!0,!1,!1)},removeItem(){this.$store.dispatch("removeOrder",{orderId:this.order.id}).then(()=>{}).catch(()=>{})},nextDoor(l){l===1&&this.selected_index>0&&this.selected_index--,l===1&&this.selected_index===0&&(this.selected_index=this.doors.length-1),l===0&&this.selected_index<this.doors.length-1&&this.selected_index++,l===0&&this.selected_index===this.doors.length-1&&(this.selected_index=0),this.loading=!0,this.$nextTick(()=>{this.loading=!1})},submit(){this.timer=0;let l=setInterval(()=>{this.timer++},1e3);this.formData.id=this.order.id;let o=new FormData;Object.keys(this.formData).forEach(i=>{const c=this.formData[i]||"";typeof c=="object"?o.append(i,JSON.stringify(c)):o.append(i,c)}),this.$store.dispatch("contractProcessing",{processingForm:o}).then(i=>{clearInterval(l),this.timer=null,this.$notify({title:"DoDoors",text:"Номер договора успешно установлен!",type:"success"})}).catch(i=>{clearInterval(l),this.timer=null,this.$notify({title:"DoDoors",text:"Ошибочка...",type:"error"})})},selectDoor(l){this.loading=!0,this.tab=0,this.selected_index=l,this.$nextTick(()=>{this.loading=!1})},onStartEdit(){this.tab=1}}},pd=Object.assign(ad,{setup(l){return(o,i)=>{var c,h,u,b,m,y,v;return l.doors.length>0?(e(),t(p,{key:0},[s("div",jt,[s("div",Tt,[s("div",Et,[s("div",It,[s("div",Ot,[s("button",{type:"button",disabled:l.doors.length===1,onClick:i[0]||(i[0]=a=>o.nextDoor(0)),class:"btn btn-dark rounded-0"},St,8,Lt),s("button",Ht,d(o.selected_index+1)+"/"+d(l.doors.length),1),s("button",{type:"button",disabled:l.doors.length===1,onClick:i[1]||(i[1]=a=>o.nextDoor(1)),class:"btn btn-dark rounded-0 ml-2"},Nt,8,Mt)]),Wt]),s("div",Ut,[s("p",null,[r("Информация о заказе: "),s("span",qt,"№"+d(l.order.id),1)]),s("div",Jt,[Gt,s("ul",Rt,[s("li",null,[s("a",{class:"dropdown-item",onClick:i[2]||(i[2]=(...a)=>o.sendToTelegram&&o.sendToTelegram(...a)),href:"javascript:void(0)"},[At,r(" Отправить в телеграм ")])]),s("li",null,[s("a",{class:"dropdown-item",onClick:i[3]||(i[3]=(...a)=>o.sendToBitrix&&o.sendToBitrix(...a)),href:"javascript:void(0)"},[Kt,r(" Отправить в Битрикс ")])]),s("li",null,[s("a",{class:"dropdown-item",onClick:i[4]||(i[4]=(...a)=>o.sendToEmail&&o.sendToEmail(...a)),href:"javascript:void(0)"},[Qt,r(" Отправить на почту клиента ")])]),Xt,s("li",null,[s("a",{class:"dropdown-item",target:"_blank",href:"/orders/download-order-excel/"+l.order.id},[Zt,r("Скачать Excel-документ по заказу")],8,Yt)]),s("li",null,[s("a",{class:"dropdown-item",target:"_blank",href:"/orders/download-contract?id="+l.order.id},[sl,r("Скачать договор")],8,xt)]),ol,s("li",null,[s("a",{class:"dropdown-item text-danger",onClick:i[5]||(i[5]=(...a)=>o.removeItem&&o.removeItem(...a)),href:"javascript:void(0)"},[el,r("Удалить")])])])])])])])]),o.tab===0?(e(),t("div",tl,[s("div",ll,[o.loading?n("",!0):(e(),k(st,{key:0,"can-edit":l.canEdit,onEdit:o.onStartEdit,modelValue:l.doors[o.selected_index].door,"onUpdate:modelValue":i[6]||(i[6]=a=>l.doors[o.selected_index].door=a)},null,8,["can-edit","onEdit","modelValue"]))])])):n("",!0),o.tab===1?(e(),t("div",dl,[s("div",il,[o.loading?n("",!0):(e(),k(T,{key:0,"edit-order":!0,door:l.doors[o.selected_index]},null,8,["door"]))])])):n("",!0),s("div",nl,[s("div",rl,[o.cart_tab===0?(e(),t("h5",al,"Двери в заказе")):n("",!0),o.cart_tab===1?(e(),t("h5",cl,"Параметры заказа")):n("",!0),_l]),o.cart_tab===0?(e(),t("div",hl,[(e(!0),t(p,null,w(l.doors,(a,_)=>{var g;return e(),t("div",{onClick:V=>o.selectDoor(_),class:D([{"border-black":o.selected_index===_},"card btn btn-light text-left p-0 rounded-0 mb-2 cursor-pointer"])},[s("div",pl,[s("h6",fl,d(a.door.purpose||"-")+": "+d(a.door.door_type.title)+" "+d(a.door.width)+"x"+d(a.door.height)+"x"+d(((g=a.door.opening_type)==null?void 0:g.depth)||0),1),s("h6",bl,[a.door.box_and_frame_color.title?(e(),t("span",ml,"("+d(a.door.box_and_frame_color.title)+")",1)):n("",!0),r(" лицо "),a.door.front_side_finish.title?(e(),t("span",yl,d(a.door.front_side_finish.title),1)):n("",!0),r("/ "),a.door.back_side_finish.title?(e(),t("span",vl,d(a.door.back_side_finish.title)+",",1)):n("",!0),r(" петли "),a.door.loops.title?(e(),t("span",kl,d(a.door.loops.title)+",",1)):n("",!0),a.door.hinge_manufacturer.title?(e(),t("span",gl,d(a.door.hinge_manufacturer.title)+",",1)):n("",!0),a.door.fittings_color.title?(e(),t("span",$l,"("+d(a.door.fittings_color.title)+"),",1)):n("",!0),a.door.opening_type.title?(e(),t("span",wl,d(a.door.opening_type.title)+",",1)):n("",!0),a.door.handle_holes.title?(e(),t("span",Fl,d(a.door.handle_holes.title)+",",1)):n("",!0),a.door.need_automatic_doorstep?(e(),t("span",Cl," автоматический порожек,")):n("",!0),a.door.need_upper_jumper?(e(),t("span",Dl," верхняя перемычка,")):n("",!0),a.door.need_handle_holes?(e(),t("span",zl," дверная ручка,")):n("",!0),a.door.handle_holes_type.title?(e(),t("span",Vl,d(a.door.handle_holes_type.title)+",",1)):n("",!0),a.door.handle_holes.title?(e(),t("span",jl,d(a.door.handle_holes.title)+",",1)):n("",!0),a.door.need_hidden_door_closer?(e(),t("span",Tl," скрытый доводчик,")):n("",!0),a.door.need_hidden_skirting_board?(e(),t("span",El," скрытый плинтус,")):n("",!0),a.door.need_hidden_stopper?(e(),t("span",Il," скрытый стопор,")):n("",!0),a.door.need_door_install?(e(),t("span",Ol," установка двери")):n("",!0)])])],10,ul)}),256)),o.loading?(e(),t("div",ed,ld)):(e(),t("div",Ll,[s("div",Bl,[Sl,s("p",Hl,[r("Сумма за заказ "),s("span",Ml,d(l.order.total_price||0)+" руб",1)]),s("p",Pl,[r("Общее число дверей "),s("span",Nl,d(l.order.total_count||0)+" ед.",1)]),s("p",Wl,[r("Оплачено "),s("span",Ul,d(l.order.current_payed||0)+" руб ("+d(l.order.payed_percent||0)+"%)",1)]),s("p",ql,[r(" Оплата дизайнеру "),(c=l.order.config)!=null&&c.designer_work_type?(e(),t("span",Jl,d(((h=l.order.config)==null?void 0:h.designer_price)||0)+" руб",1)):(e(),t("span",Gl,d(((u=l.order.config)==null?void 0:u.designer_value)||0)+" %",1))]),s("p",Rl,[r("Цена за установку "),s("span",Al,d(((b=l.order.config)==null?void 0:b.install_price)||0)+" руб",1)]),s("p",Kl,[r("Цена за доставку "),s("span",Ql,d(((m=l.order.config)==null?void 0:m.delivery_price)||0)+" руб",1)]),s("p",Xl,[r("Скидка "),s("span",Yl,d(((y=l.order.discount)==null?void 0:y.percent)||0)+"%",1)]),s("p",Zl,[r("Сумма скидки "),s("span",xl,d(((v=l.order.discount)==null?void 0:v.amount)||0)+" руб",1)]),s("p",sd,[r("Итого "),s("span",null,d(o.summary)+" руб",1)]),s("p",od,[r("Итого со скидкой "),s("span",null,d(o.summaryWithDiscount)+" руб",1)])])]))])):n("",!0),o.cart_tab===1?(e(),t(p,{key:1},[s("div",dd,[z(Vt,{onBack:i[7]||(i[7]=a=>o.cart_tab=0),order:l.order,doors:l.doors},null,8,["order","doors"])]),s("div",id,[s("button",{type:"button",class:"btn btn-outline-secondary w-100 rounded-0 p-3",onClick:i[8]||(i[8]=a=>o.cart_tab=0)},"Назад ")])],64)):n("",!0),o.cart_tab===0?(e(),t("div",nd,[s("button",{type:"button",onClick:i[9]||(i[9]=a=>o.cart_tab=1),class:"btn btn-outline-dark p-3 w-100 rounded-0"},"Редактировать параметры заказа ")])):n("",!0)])],64)):(e(),t("p",rd," Данный заказ не содержит информации о дверях "))}}});export{pd as _};
