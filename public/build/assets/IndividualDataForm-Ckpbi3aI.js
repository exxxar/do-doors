import{m as O,o as n,c as r,b as t,f as k,t as v,e as u,F as g,p as b,g as m,h as P,v as y,r as E,x as R,l as M,s as U}from"./app-C4M7Oqyd.js";import{_ as z}from"./_plugin-vue_export-helper-DlAUqK2U.js";const A={props:["modelValue","disabled"],data(){return{discount_text:null,blocks:{install:!0,designer:!0,delivery:!0,develop:!0,price:!0,discount_detailing:!1,price_type_attention:!0},need_promo:!1,flgDays:!0,discount:0,clientForm:null,delivery_services:[]}},mounted(){if(localStorage.getItem("dodoors_cart_checkout_blocks")){const s=JSON.parse(localStorage.getItem("dodoors_cart_checkout_blocks")),o=Object.keys(this.blocks).length||0,_=Object.keys(s).length||0;console.log("keysCountOriginal",o),console.log("keysCountSaved",_),o===_?this.blocks=s:localStorage.setItem("dodoors_cart_checkout_blocks",JSON.stringify(this.blocks))}this.clientForm=this.modelValue,console.log("this.clientForm.summary_price_type",this.clientForm.summary_price_type),this.clientForm.summary_price_type||this.getDictionary.price_type_variants.forEach(s=>{s.key==="retail"&&(this.clientForm.summary_price_type=s)}),this.selectPayedPercentType(1),this.loadServicesByType()},computed:{...O(["getErrors","getDictionary","cartTotalCount","cartTotalPrice","cartProducts"]),designerPrice(){let s=0;return this.cartProducts.forEach(o=>{s+=o.product.base_price||0}),this.clientForm.designer.price=(s*this.clientForm.designer.value/100).toFixed(2),this.clientForm.designer.price},discountPriceAmount(){return Math.round(this.detailingSummaryPrice*this.discount/100)},detailingSummaryPrice(){let s="";const o={size:"Петли",handle_holes_type:"Ручка",handle_wrapper_type:"Завертка",opening_type:"Тип открытия двери и толщина",box_and_frame_color:"Цвет короба и каркаса",door_type:"Тип двери",front_side_finish_color:"Цвет отделки внешней стороны",back_side_finish_color:"Цвет отделки внутренней стороны",seal_color:"Цвет уплотнителя",fittings_color:"Цвет фурнитуры",hinge_manufacturer:"Производитель петель",front_side_finish:"Отделка внешней стороны",back_side_finish:"Отделка внутренней стороны",base:"База (под покраску)",service_doorstep:"Работа с порогом",service_painting:"Покраска фурнитуры",service_door_closer:"Работа с доводчиком",service_handle:"Услуги по монтажу ручки",service_stopper:"Работа со стопором"};let _=0;const F=["size","handle_holes_type","handle_wrapper_type","base"];return this.cartProducts.forEach(e=>{let p=0;s+=`<h6 class='fw-bold my-2' style='font-size: 10px;'>"`+(e.product.purpose||"Дверь")+'" кол-во '+e.quantity+"ед. </h6><ul style='font-size:10px;' class='list-group'>",e.product.detailing_price.forEach(l=>{if(F.indexOf(l.type)===-1){let d=l.full_price?l.full_price:l.price;p+=d,s+="<li class='list-group-item'>"+o[l.type]+" <span class='fw-bold'>"+d+" руб</span> </li>"}}),s+="<li class='list-group-item bg-secondary text-white d-flex justify-content-between'><span>Итого за дверь <span class='fw-bold'>"+p+" руб</span></span><span class='fw-bold'>"+p*e.quantity+" руб (x"+e.quantity+")</span> </li>",s+="</ul>",_+=p*e.quantity}),s+="<h6 class='fw-bold my-2' style='font-size: 10px;'>Скидку считаем от этого значения "+_+" руб</h6>",this.discount_text=s,_},fullSummaryPrice(){let s=this.clientForm.installation.count===0?this.cartTotalCount:this.clientForm.installation.count,o=this.clientForm.installation.recount_type===1?this.clientForm.installation.price*s:this.clientForm.installation.price;return this.cartTotalPrice-this.discountPriceAmount+o+this.clientForm.delivery_price}},watch:{discount:{handler(s){this.modelValue.discount_data={discount_percent:this.discount,discount_amount:this.discountPriceAmount},this.changeDiscount()},deep:!0},blocks:{handler(s){localStorage.setItem("dodoors_cart_checkout_blocks",JSON.stringify(this.blocks))},deep:!0},need_promo:{handler(s){this.need_promo&&(this.discount=0)},deep:!0},"clientForm.dealer_percent":{handler(s){this.recountPrices()},deep:!0},clientForm:{handler(s){!this.clientForm.designer.is_fix&&this.clientForm.designer.value>100&&(this.clientForm.designer.value=30),this.clientForm.price_with_discount=this.cartTotalPrice-this.discountPriceAmount,this.clientForm.detailing_summary_price=this.detailingSummaryPrice,this.clientForm.full_summary_price=this.fullSummaryPrice,this.$emit("update:modelValue",this.clientForm)},deep:!0}},methods:{changeDiscount(){this.clientForm.current_payed=Math.max(0,Math.round(this.fullSummaryPrice*this.clientForm.payed_percent/100))},recountPrices(){const s=this.clientForm.dealer_percent||0,o=this.clientForm.summary_price_type;let _=this.cartProducts;const F=this.getDictionary;let e=0,p=null,l=[],d=o.key,T=C=>Math.round(parseInt(C)/10)*10;_.forEach(C=>{var S;const c=C.product;let q=i=>{let h=typeof c.door_type.price=="object"?c.door_type.price[d]:c.door_type.price,a=c.door_type.id!==3?1:.8,f=c.door_type.need_percent_price?i*h/100:i*a+h;return l.push({type:"door_type",price:(f||0)>0?f:i}),(f||0)>0?f:i};Object.keys(c).forEach(i=>{let h=!1;if(i&&typeof c[i]=="object"&&c[i]!=null&&i!=="door_type"){if(i==="opening_type"&&c[i].sizes){h=!0;let a=c[i].sizes.findIndex(V=>V.width==c.width&&V.height==c.height),f=a===-1?0:c[i].sizes[a].price[d];e+=parseInt(f||0),console.log("opening_type",f,i),l.push({type:i,price:f})}if(i.indexOf("_color")!==-1&&c[i].sizes&&!h){h=!0;let a=(c[i]||{excludes:[]}).excludes.indexOf(i.substring(0,i.indexOf("_color")))!==-1,f=0;if(!c[i].assign_with_size)f=a?0:c[i].sizes[0].price[d];else{let V=c[i].sizes.findIndex(I=>I.width==c.width&&I.height==c.height);f=V===-1||a?0:c[i].sizes[V].price[d]}e+=parseInt(f||0),l.push({type:i,price:f})}if(i==="hinge_manufacturer"&&c[i].title!=null&&!h){h=!0;let a=c[i].price[d],f=0;c.size&&(f=c.size.loops.count*a),e+=parseInt(f||0),l.push({type:i,price:a,full_price:f})}if(i==="size"&&c[i].loops.price&&!h){h=!0;let a=c[i].loops.price[d];e+=parseInt(a||0),l.push({type:i,price:a})}if(i==="service_painting"&&c[i].title!=null&&!h){h=!0;let a=c.fittings_color.is_ral?c[i].price[d]:0,f=0;c.size&&(f=(c.size.loops.count+1)*a),e+=f||0,l.push({type:i,price:a,full_price:f})}if(c[i].price&&!h){let a=typeof c[i].price=="object"?c[i].price[d]||0:c[i].price||0;e+=parseInt(a||0),l.push({type:i,price:a})}}});let w=F.prices,x=0,D=!1,j=null;if(w.forEach(i=>{i.width===c.width&&i.height===c.height&&(D=!0,j=i)}),D){p=j.materials.find(h=>h.is_base)||{price:{wholesale:0,dealer:0,retail:0,cost:0}};let i=typeof p.price=="object"?p.price[d]:p.price;l.push({type:"base",price:i}),x=parseInt(q(i)),j.materials.forEach(h=>{if(h.id===c.front_side_finish.id&&!c.front_side_finish.is_base){let a=typeof h.price=="object"?h.price[d]:h.price;x+=a,l.push({type:"front_side_finish",price:a})}if(h.id===c.back_side_finish.id&&!c.back_side_finish.is_base){let a=typeof h.price=="object"?h.price[d]:h.price;x+=a,l.push({type:"back_side_finish",price:a})}})}else for(let i=0;i<w.length;i++)if(w[i].width>=c.width&&w[i].height>=c.height){p=w[i].materials.find(a=>a.is_base)||{price:{wholesale:0,dealer:0,retail:0,cost:0}};let h=typeof p.price=="object"?p.price[d]:p.price;l.push({type:"base",price:h}),x=parseInt(q(h)),w[i].materials.forEach(a=>{if(a.id===c.front_side_finish.id&&!c.front_side_finish.is_base){let f=typeof a.price=="object"?a.price[d]:a.price;x+=f,l.push({type:"front_side_finish",price:f})}}),w[i].materials.forEach(a=>{if(a.id===c.back_side_finish.id&&!c.back_side_finish.is_base){let f=typeof a.price=="object"?a.price[d]:a.price;x+=f,l.push({type:"back_side_finish",price:f})}});break}c.price=s===0?T(e+x):Math.round((T(e+x)||0)*(1+(s||0)/100)),c.base_price=((S=l.find(i=>i.type==="door_type"))==null?void 0:S.price)||0}),this.$store.dispatch("updateCartItems",_),this.changePayedPercent()},selectPriceType(s){this.clientForm.summary_price_type=s,this.recountPrices(),this.changePayedPercent()},loadServicesByType(){this.$store.dispatch("loadServicesByType",{type:"service_delivery"}).then(s=>{this.delivery_services=s.data||[]}).catch(()=>{})},selectPayedPercentType(s){switch(this.clientForm.payed_percent_type=s,s){case 0:this.clientForm.payed_percent=50;break;default:case 1:this.clientForm.payed_percent=70;break;case 2:this.clientForm.payed_percent=100;break}this.changePayedPercent()},hasRoles(s){let o=!1;return typeof s=="object"?this.$page.props.auth.roles.forEach(_=>{o=o||s.includes(_)}):this.$page.props.auth.roles.includes(s),o},changeCurrentPayed(){this.clientForm.payed_percent=Math.round(this.clientForm.current_payed/this.fullSummaryPrice*100)},changePayedPercent(){this.clientForm.current_payed=Math.round(this.cartTotalPrice*this.clientForm.payed_percent/100),this.changeDiscount()},selectDeliveryVariant(s){var e;this.clientForm.info=s.title,this.clientForm.delivery_service=s.title,this.clientForm.delivery_price=((e=s.price)==null?void 0:e.retail)||0;const o=s.title,_=/г\.\s*([А-Яа-яЁё\- ]+)/,F=o.match(_);F&&(this.clientForm.delivery_city=F[1].trim())},findPromo(){this.discount=0,!((this.clientForm.promo||"").length<=5)&&this.$store.dispatch("findPromoCode",{code:this.clientForm.promo}).then(s=>{this.discount=s.discount||0})}}},B={class:"font-bold d-flex justify-content-between align-items-center mb-2"},N={key:0},L={key:0,class:"fa-regular fa-square-plus"},J={key:1,class:"fa-regular fa-square-minus"},H={class:"form-check form-switch my-2"},G={class:"form-check-label",for:"need_promo_switcher"},K={class:"form-floating mb-2"},Q=t("label",{for:"checkout-promo"},"Скидка, %",-1),W={style:{"font-size":"10px","font-style":"italic","text-decoration":"underline"}},X={key:0,class:"fa-regular fa-square-plus"},Y={key:1,class:"fa-regular fa-square-minus"},Z=t("p",{class:"alert alert-light mb-2",style:{"font-size":"10px"}},"Внимание! В расчете скидки не участвует фурнитура, ручка (и завертка), доставка и установка",-1),$=["innerHTML"],ee={key:1,class:"form-floating mb-2"},te=t("label",{for:"checkout-promo"},"Промокод",-1),oe={key:1},le=t("p",null,[t("small",null,"Начальная внесенная покупателем сумма")],-1),ie={class:"form-floating mb-2"},se=t("label",{for:"checkout-name"},"Начальная сумма, руб",-1),ne=t("p",null,[t("small",null,"Процент внесенной суммы от полной стоимости")],-1),re={class:"my-2"},ce={class:"form-floating mb-2"},de=t("label",{for:"checkout-name"},"%",-1),ae={class:"mb-2 fw-bold d-flex justify-content-between align-items-center"},pe={key:0,class:"fa-regular fa-square-plus"},ue={key:1,class:"fa-regular fa-square-minus"},me={class:"form-check form-switch"},_e=t("label",{class:"form-check-label",for:"flexSwitchCheckDefault"},"Указать кол-во рабочих дней / Выбрать конкретную дату",-1),he={key:0,class:"form-floating mb-2"},fe=t("label",{for:"checkout-name"},"Кол-во рабочих дней",-1),ye={key:1,class:"form-floating mb-2"},be=t("label",{for:"checkout-name"},"Срок передачи товара покупателю",-1),ke={class:"mb-2 fw-bold d-flex justify-content-between align-items-center"},ve={key:0,class:"fa-regular fa-square-plus"},ge={key:1,class:"fa-regular fa-square-minus"},Fe={class:"my-2"},xe=t("h6",{class:"mb-2 fw-bold"},"Информация по доставке",-1),we={class:"form-floating mb-2"},Pe=t("label",{for:"delivery-price"},"Сумма за доставку",-1),Ve={class:"input-group mb-2"},Ce={class:"form-floating"},je=t("label",{for:"delivery-city"},"Город доставки",-1),Ue={class:"input-group-text rounded-0 border-secondary"},ze={class:"dropdown"},Te=t("button",{class:"btn btn-light",type:"button",id:"dropdownMenuButton","data-bs-toggle":"dropdown","aria-expanded":"false"},[t("i",{class:"fa-solid fa-map-location-dot"})],-1),qe={class:"dropdown-menu",style:{"max-height":"200px","overflow-y":"scroll"},"aria-labelledby":"dropdownMenuButton"},De=["onClick"],Se={class:"dropdown-item",href:"javascript:void(0)"},Ie={class:"form-floating mb-2"},Ee=t("label",{for:"delivery-address"},"Адрес доставки",-1),Me={key:0,class:"alert alert-light rounded-0 border-black"},Oe=t("i",{class:"fa-solid fa-xmark"},null,-1),Re=t("p",{class:"mb-2"},"Подъем на этаж",-1),Ae={class:"my-2"},Be={class:"mb-2 fw-bold d-flex justify-content-between align-items-center"},Ne={key:0,class:"fa-regular fa-square-plus"},Le={key:1,class:"fa-regular fa-square-minus"},Je={key:3,class:"my-2"},He={class:"form-floating mb-2"},Ge=t("label",{for:"installation-count"},"Дверей к установке",-1),Ke=t("p",{style:{"font-size":"10px"}},"Производить расчет цены",-1),Qe={class:"form-floating my-2"},We={for:"installation-price"},Xe={key:0},Ye={key:1},Ze={class:"mb-2 fw-bold d-flex justify-content-between align-items-center"},$e={key:0,class:"fa-regular fa-square-plus"},et={key:1,class:"fa-regular fa-square-minus"},tt={class:"my-2 d-flex justify-content-between align-items-center"},ot={key:0},lt={key:1},it={class:"form-floating mb-2"},st={for:"installation-count"},nt={key:0},rt={key:1},ct={key:0},dt={class:"form-floating mb-2"},at=t("label",{for:"dealer-percent"},"Процент дилера, %",-1),pt={class:"form-check form-switch"},ut=t("label",{class:"form-check-label",for:"send_to_bitix"},"Отправить в Битрикс",-1),mt={class:"form-check form-switch"},_t=t("label",{class:"form-check-label",for:"send_to_mail"},"Отправить на почту клиента",-1),ht={class:"form-check form-switch"},ft=t("label",{class:"form-check-label",for:"send_to_telegram"},"Отправить в телеграм",-1),yt={class:"form-check form-switch mb-2"},bt=t("label",{class:"form-check-label",for:"send_to_self_mail"},"Отправить себе на почту",-1),kt={key:7,class:"form-floating mb-2"},vt=t("label",{for:"self_email_address"},"Почта",-1),gt={key:8,class:"alert alert-light rounded-0 mb-2"},Ft=t("strong",{class:"fw-bold"},"Внимание!",-1),xt={key:9,class:"alert alert-light"},wt={class:"d-flex justify-content-between"},Pt={class:"d-flex justify-content-between"},Vt={class:"d-flex justify-content-between"},Ct={key:0,class:"d-flex justify-content-between"},jt={key:0},Ut={key:1},zt={key:1,class:"d-flex justify-content-between"},Tt={class:"d-flex justify-content-between fw-bold"},qt={class:"d-flex justify-content-between"},Dt={class:"fw-bold"},St={class:"btn-group w-100 mb-2"},It=["disabled"],Et=t("button",{type:"button",class:"btn btn-outline-dark rounded-0 dropdown-toggle dropdown-toggle-split","data-bs-toggle":"dropdown","aria-expanded":"false"},[t("i",{class:"fa-solid fa-hand-holding-dollar"})],-1),Mt={class:"dropdown-menu rounded-0"},Ot=["onClick"],Rt=["disabled"];function At(s,o,_,F,e,p){return e.clientForm?(n(),r(g,{key:0},[t("h6",B,[t("span",null,[k(" Итого цена "+v(s.cartTotalPrice-p.discountPriceAmount)+" ₽ ",1),e.discount>0?(n(),r("span",N,"(скидка "+v(e.discount)+"%)",1)):u("",!0)]),t("span",{onClick:o[0]||(o[0]=l=>e.blocks.price=!e.blocks.price)},[e.blocks.price?(n(),r("i",J)):(n(),r("i",L))])]),e.blocks.price?(n(),r(g,{key:0},[t("div",H,[t("label",G,[t("span",{class:b({"fw-bold":!e.need_promo})},"скидка",2),k(" \\ "),t("span",{class:b({"fw-bold":e.need_promo})},"промокод",2)]),m(t("input",{"onUpdate:modelValue":o[1]||(o[1]=l=>e.need_promo=l),class:"form-check-input",type:"checkbox",role:"switch",id:"need_promo_switcher"},null,512),[[P,e.need_promo]])]),e.need_promo?u("",!0):(n(),r(g,{key:0},[t("div",K,[m(t("input",{type:"text",class:"form-control","onUpdate:modelValue":o[2]||(o[2]=l=>e.discount=l),id:"checkout-promo",placeholder:"name@example.com"},null,512),[[y,e.discount]]),Q]),t("p",W,[k(" Ознакомиться с расчетом скидки "),t("span",{onClick:o[3]||(o[3]=l=>e.blocks.discount_detailing=!e.blocks.discount_detailing)},[e.blocks.discount_detailing?(n(),r("i",Y)):(n(),r("i",X))])]),e.blocks.discount_detailing?(n(),r(g,{key:0},[Z,e.discount_text?(n(),r("p",{key:0,innerHTML:e.discount_text},null,8,$)):u("",!0)],64)):u("",!0)],64)),e.need_promo?(n(),r("div",ee,[m(t("input",{type:"text",class:"form-control",onKeyup:o[4]||(o[4]=(...l)=>p.findPromo&&p.findPromo(...l)),"onUpdate:modelValue":o[5]||(o[5]=l=>e.clientForm.promo=l),id:"checkout-promo",placeholder:"name@example.com"},null,544),[[y,e.clientForm.promo]]),te])):u("",!0)],64)):u("",!0),p.hasRoles(["manager","administrator"])?(n(),r("div",oe,[e.blocks.price?(n(),r(g,{key:0},[le,t("div",ie,[m(t("input",{type:"text",class:"form-control",onChange:o[6]||(o[6]=(...l)=>p.changeCurrentPayed&&p.changeCurrentPayed(...l)),"onUpdate:modelValue":o[7]||(o[7]=l=>e.clientForm.current_payed=l),id:"checkout-name",placeholder:"",required:""},null,544),[[y,e.clientForm.current_payed]]),se]),ne,t("p",re,[t("span",{onClick:o[8]||(o[8]=l=>p.selectPayedPercentType(0)),class:b([{"btn-dark text-white":e.clientForm.payed_percent_type===0},"btn btn-outline-secondary text-black rounded-0 mr-2"]),style:{"font-size":"10px"}},"50\\50",2),t("span",{onClick:o[9]||(o[9]=l=>p.selectPayedPercentType(1)),class:b([{"btn-dark text-white":e.clientForm.payed_percent_type===1},"btn btn-outline-secondary text-black rounded-0 mr-2"]),style:{"font-size":"10px"}},"70\\30",2),t("span",{onClick:o[10]||(o[10]=l=>p.selectPayedPercentType(2)),class:b([{"btn-dark text-white":e.clientForm.payed_percent_type===2},"btn btn-outline-secondary text-black rounded-0 mr-2"]),style:{"font-size":"10px"}},"100% предоплата",2)]),t("div",ce,[m(t("input",{type:"text",class:"form-control",onChange:o[11]||(o[11]=(...l)=>p.changePayedPercent&&p.changePayedPercent(...l)),"onUpdate:modelValue":o[12]||(o[12]=l=>e.clientForm.payed_percent=l),id:"checkout-name",placeholder:"name@example.com",required:""},null,544),[[y,e.clientForm.payed_percent]]),de])],64)):u("",!0),t("h6",ae,[k("Срок изготовления "),t("span",{onClick:o[13]||(o[13]=l=>e.blocks.develop=!e.blocks.develop)},[e.blocks.develop?(n(),r("i",ue)):(n(),r("i",pe))])]),e.blocks.develop?(n(),r(g,{key:1},[t("div",me,[m(t("input",{onClick:o[14]||(o[14]=l=>e.flgDays=!e.flgDays),"onUpdate:modelValue":o[15]||(o[15]=l=>e.flgDays=l),class:"form-check-input",type:"checkbox",role:"switch",id:""},null,512),[[P,e.flgDays]]),_e]),e.flgDays?(n(),r("div",he,[m(t("input",{type:"text",class:"form-control","onUpdate:modelValue":o[16]||(o[16]=l=>e.clientForm.work_days=l),id:"checkout-name",placeholder:"name@example.com",required:""},null,512),[[y,e.clientForm.work_days]]),fe])):(n(),r("div",ye,[m(t("input",{type:"date",class:"form-control","onUpdate:modelValue":o[17]||(o[17]=l=>e.clientForm.delivery_terms=l),id:"checkout-name",placeholder:"name@example.com",required:""},null,512),[[y,e.clientForm.delivery_terms]]),be]))],64)):u("",!0),t("h6",ke,[k("Доставка "),t("span",{onClick:o[18]||(o[18]=l=>e.blocks.delivery=!e.blocks.delivery)},[e.blocks.delivery?(n(),r("i",ge)):(n(),r("i",ve))])]),e.blocks.delivery?(n(),r(g,{key:2},[t("div",Fe,[t("button",{type:"button",onClick:o[19]||(o[19]=l=>e.clientForm.delivery_type=0),class:b([{"btn-dark text-white":e.clientForm.delivery_type===0},"btn btn-outline-secondary text-black rounded-0 mr-2 mb-2"])},"Доставка до адреса ",2),t("button",{type:"button",onClick:o[20]||(o[20]=l=>e.clientForm.delivery_type=1),class:b([{"btn-dark text-white":e.clientForm.delivery_type===1},"btn btn-outline-secondary text-black rounded-0 mr-2 mb-2"])},"Самовывоз ",2),t("button",{type:"button",onClick:o[21]||(o[21]=l=>e.clientForm.delivery_type=2),class:b([{"btn-dark text-white":e.clientForm.delivery_type===2},"btn btn-outline-secondary text-black rounded-0 mr-2 mb-2"])},"ТК ",2),t("button",{type:"button",onClick:o[22]||(o[22]=l=>e.clientForm.delivery_type=3),class:b([{"btn-dark text-white":e.clientForm.delivery_type===3},"btn btn-outline-secondary text-black rounded-0 mr-2 mb-2"])},"Доставка до проходной ",2)]),e.clientForm.delivery_type===0?(n(),r(g,{key:0},[xe,t("div",we,[m(t("input",{type:"number",min:"0",class:"form-control","onUpdate:modelValue":o[23]||(o[23]=l=>e.clientForm.delivery_price=l),id:"delivery-price",placeholder:"name@example.com",required:""},null,512),[[y,e.clientForm.delivery_price]]),Pe]),t("div",Ve,[t("div",Ce,[m(t("input",{type:"text",class:"form-control","onUpdate:modelValue":o[24]||(o[24]=l=>e.clientForm.delivery_city=l),id:"delivery-city",placeholder:"name@example.com"},null,512),[[y,e.clientForm.delivery_city]]),je]),t("span",Ue,[t("div",ze,[Te,t("ul",qe,[(n(!0),r(g,null,E(e.delivery_services,l=>(n(),r("li",{onClick:d=>p.selectDeliveryVariant(l)},[t("a",Se,v(l.title||"-"),1)],8,De))),256))])])])]),t("div",Ie,[m(t("input",{type:"text",class:"form-control","onUpdate:modelValue":o[25]||(o[25]=l=>e.clientForm.delivery_address=l),id:"delivery-address",placeholder:"name@example.com"},null,512),[[y,e.clientForm.delivery_address]]),Ee]),e.clientForm.delivery_service?(n(),r("p",Me,[t("span",null,v(e.clientForm.delivery_service),1),t("a",{href:"javascript:void(0)",class:"d-block p-0 m-0 text-danger",style:{"font-size":"10px"},onClick:o[26]||(o[26]=l=>e.clientForm.delivery_service=null)},[Oe,k(" убрать сервис")])])):u("",!0),Re,t("div",Ae,[t("button",{type:"button",onClick:o[27]||(o[27]=l=>e.clientForm.ascent_floor=!0),class:b([{"btn-dark text-white":e.clientForm.ascent_floor===!0},"btn btn-outline-secondary text-black rounded-0 mr-2"])},"Нужен ",2),t("button",{type:"button",onClick:o[28]||(o[28]=l=>e.clientForm.ascent_floor=!1),class:b([{"btn-dark text-white":e.clientForm.ascent_floor===!1},"btn btn-outline-secondary text-black rounded-0 mr-2"])},"Не нужен ",2)])],64)):u("",!0)],64)):u("",!0),t("h6",Be,[k("Установка "),t("span",{onClick:o[29]||(o[29]=l=>e.blocks.install=!e.blocks.install)},[e.blocks.install?(n(),r("i",Le)):(n(),r("i",Ne))])]),e.blocks.install?(n(),r("div",Je,[t("button",{type:"button",onClick:o[30]||(o[30]=l=>e.clientForm.installation.need_door_install=!0),class:b([{"btn-dark text-white":e.clientForm.installation.need_door_install===!0},"btn btn-outline-secondary text-black rounded-0 mr-2"])},"Нужна ",2),t("button",{type:"button",onClick:o[31]||(o[31]=l=>e.clientForm.installation.need_door_install=!1),class:b([{"btn-dark text-white":e.clientForm.installation.need_door_install===!1},"btn btn-outline-secondary text-black rounded-0 mr-2"])},"Не нужна ",2)])):u("",!0),e.clientForm.installation.need_door_install?(n(),r(g,{key:4},[t("div",He,[m(t("input",{type:"number",class:"form-control","onUpdate:modelValue":o[32]||(o[32]=l=>e.clientForm.installation.count=l),id:"installation-count",placeholder:"name@example.com"},null,512),[[y,e.clientForm.installation.count]]),Ge]),Ke,t("button",{type:"button",onClick:o[33]||(o[33]=l=>e.clientForm.installation.recount_type=0),style:{"font-size":"10px"},class:b([{"btn-dark text-white":e.clientForm.installation.recount_type===0},"btn btn-outline-secondary text-black rounded-0 mr-2"])},"Суммарно ",2),t("button",{type:"button",style:{"font-size":"10px"},onClick:o[34]||(o[34]=l=>e.clientForm.installation.recount_type=1),class:b([{"btn-dark text-white":e.clientForm.installation.recount_type===1},"btn btn-outline-secondary text-black rounded-0 mr-2"])},"За единицу ",2),t("div",Qe,[m(t("input",{type:"number",class:"form-control","onUpdate:modelValue":o[35]||(o[35]=l=>e.clientForm.installation.price=l),id:"installation-price",placeholder:"name@example.com"},null,512),[[y,e.clientForm.installation.price]]),t("label",We,[k("Цена за установку, руб "),e.clientForm.installation.recount_type===1?(n(),r("span",Xe,"(за единицу)")):u("",!0),e.clientForm.installation.recount_type===0?(n(),r("span",Ye,"(суммарно)")):u("",!0)])])],64)):u("",!0),t("h6",Ze,[k("Работа дизайнера "),t("span",{onClick:o[36]||(o[36]=l=>e.blocks.designer=!e.blocks.designer)},[e.blocks.designer?(n(),r("i",et)):(n(),r("i",$e))])]),e.blocks.designer?(n(),r(g,{key:5},[t("div",tt,[t("div",null,[t("button",{type:"button",onClick:o[37]||(o[37]=l=>e.clientForm.designer.is_fix=!0),class:b([{"btn-dark text-white":e.clientForm.designer.is_fix===!0},"btn btn-outline-secondary text-black rounded-0 mr-2"])},"Фикс ",2),t("button",{type:"button",onClick:o[38]||(o[38]=l=>e.clientForm.designer.is_fix=!1),class:b([{"btn-dark text-white":e.clientForm.designer.is_fix===!1},"btn btn-outline-secondary text-black rounded-0 mr-2"])},"Процент ",2)]),e.clientForm.designer.is_fix?u("",!0):(n(),r("span",ot,v(p.designerPrice)+" руб",1)),e.clientForm.designer.is_fix?(n(),r("span",lt,v(e.clientForm.designer.value)+" руб",1)):u("",!0)]),t("div",it,[m(t("input",{type:"number",class:"form-control","onUpdate:modelValue":o[39]||(o[39]=l=>e.clientForm.designer.value=l),id:"designer-value",placeholder:"name@example.com"},null,512),[[y,e.clientForm.designer.value]]),t("label",st,[e.clientForm.designer.is_fix?(n(),r("span",nt,"Фиксированная оплата, руб")):u("",!0),e.clientForm.designer.is_fix?u("",!0):(n(),r("span",rt,"Процент за работу, %"))])])],64)):u("",!0),R(s.$slots,"loader"),e.clientForm.summary_price_type?(n(),r(g,{key:6},[e.clientForm.summary_price_type.id===3?(n(),r("div",ct,[t("div",dt,[m(t("input",{type:"number",min:"0",max:"100","onUpdate:modelValue":o[40]||(o[40]=l=>e.clientForm.dealer_percent=l),class:"form-control text-left",id:"dealer-percent",required:""},null,512),[[y,e.clientForm.dealer_percent]]),at])])):u("",!0)],64)):u("",!0),t("div",pt,[m(t("input",{"onUpdate:modelValue":o[41]||(o[41]=l=>_.modelValue.send_to_bitrix=l),class:"form-check-input",type:"checkbox",role:"switch",id:"send_to_bitix"},null,512),[[P,_.modelValue.send_to_bitrix]]),ut]),t("div",mt,[m(t("input",{class:"form-check-input","onUpdate:modelValue":o[42]||(o[42]=l=>_.modelValue.send_to_mail=l),type:"checkbox",role:"switch",id:"send_to_mail"},null,512),[[P,_.modelValue.send_to_mail]]),_t]),t("div",ht,[m(t("input",{class:"form-check-input","onUpdate:modelValue":o[43]||(o[43]=l=>_.modelValue.send_to_telegram=l),type:"checkbox",role:"switch",id:"send_to_telegram"},null,512),[[P,_.modelValue.send_to_telegram]]),ft]),t("div",yt,[m(t("input",{class:"form-check-input","onUpdate:modelValue":o[44]||(o[44]=l=>_.modelValue.send_to_self_mail=l),type:"checkbox",role:"switch",id:"send_to_self_mail"},null,512),[[P,_.modelValue.send_to_self_mail]]),bt]),_.modelValue.send_to_self_mail?(n(),r("div",kt,[m(t("input",{type:"email","onUpdate:modelValue":o[45]||(o[45]=l=>_.modelValue.self_email=l),class:"form-control",id:"self_email_address",placeholder:"name@example.com",required:""},null,512),[[y,_.modelValue.self_email]]),vt])):u("",!0),e.blocks.price_type_attention?(n(),r("p",gt,[Ft,k(" При смене типа цены будет проведен перерасчет всех цен на двери и изменены значения начальной внесенной суммы для покупателя "),t("a",{onClick:o[46]||(o[46]=l=>e.blocks.price_type_attention=!1),style:{"font-size":"10px"},class:"d-block text-danger",href:"javascript:void(0)"},"Скрыть и больше не показывать")])):u("",!0),e.clientForm.id==null?(n(),r("div",xt,[t("p",wt,[k("Цена без скидки "),t("span",null,v(s.cartTotalPrice)+" руб.",1)]),t("p",Pt,[k("Сумма скидки"),t("span",null,v(p.discountPriceAmount)+" руб. ("+v(e.discount)+"%)",1)]),t("p",Vt,[k("Цена со скидкой "),t("span",null,v(s.cartTotalPrice-p.discountPriceAmount)+" руб. ",1)]),e.clientForm.installation.price>0?(n(),r("p",Ct,[k("Цена установки "),e.clientForm.installation.recount_type===0?(n(),r("span",jt,v(e.clientForm.installation.price)+" руб.",1)):u("",!0),e.clientForm.installation.recount_type===1?(n(),r("span",Ut,v(e.clientForm.installation.price*(e.clientForm.installation.count===0?s.cartTotalCount:e.clientForm.installation.count))+" руб.",1)):u("",!0)])):u("",!0),e.clientForm.delivery_price>0?(n(),r("p",zt,[k("Цена доставки "),t("span",null,v(e.clientForm.delivery_price)+" руб.",1)])):u("",!0),t("p",Tt,[k("Итого "),t("span",null,v(p.fullSummaryPrice)+" руб.",1)]),t("p",qt,[k("Клиент должен внести "),t("span",Dt,v(e.clientForm.current_payed)+"руб. ("+v(e.clientForm.payed_percent)+"%)",1)])])):u("",!0),t("div",St,[t("button",{type:"submit",disabled:_.disabled,class:"btn btn-dark rounded-0 p-3"},"Отправить ",8,It),Et,t("ul",Mt,[(n(!0),r(g,null,E(s.getDictionary.price_type_variants,l=>(n(),r("li",null,[t("a",{onClick:d=>p.selectPriceType(l),class:b(["dropdown-item",{"bg-dark text-white":e.clientForm.summary_price_type.title===l.title}]),href:"javascript:void(0)"},v(l.title||"-"),11,Ot)]))),256))])])])):(n(),r("button",{key:2,disabled:_.disabled,class:"btn btn-dark w-100 my-2 rounded-0 p-3"},"Отправить ",8,Rt))],64)):u("",!0)}const vo=z(A,[["render",At]]),Bt={props:["modelValue"],data(){return{clientForm:null}},watch:{clientForm:{handler(s){this.$emit("update:modelValue",this.clientForm)},deep:!0}},mounted(){this.clientForm=this.modelValue}},Nt={class:"form-floating mb-2"},Lt=t("label",{for:"checkout-phone"},"Номер телефона",-1),Jt={class:"form-floating mb-2"},Ht=t("label",{for:"checkout-email"},"Электронная почта",-1),Gt={class:"form-floating"},Kt=t("label",{for:"checkout-info"},"Дополнительная информация",-1),Qt={class:"row my-2"},Wt={class:"col-md-4"},Xt={class:"form-check"},Yt=t("label",{class:"form-check-label",for:"work-with-nds"}," С НДС ",-1),Zt={class:"col-md-4"},$t={class:"form-check"},eo=t("label",{class:"form-check-label",for:"work-without-nds"}," Без НДС ",-1),to={class:"col-md-4"},oo={class:"form-check"},lo=t("label",{class:"form-check-label",for:"work-without-nds"}," Физ-лицо ",-1);function io(s,o,_,F,e,p){const l=M("mask");return e.clientForm?(n(),r(g,{key:0},[t("div",Nt,[m(t("input",{type:"text",class:"form-control","onUpdate:modelValue":o[0]||(o[0]=d=>e.clientForm.phone=d),id:"checkout-phone",placeholder:"name@example.com",required:""},null,512),[[l,"+7(###)###-##-##"],[y,e.clientForm.phone]]),Lt]),t("div",Jt,[m(t("input",{type:"email",class:"form-control","onUpdate:modelValue":o[1]||(o[1]=d=>e.clientForm.email=d),id:"checkout-email",placeholder:"name@example.com"},null,512),[[y,e.clientForm.email]]),Ht]),t("div",Gt,[m(t("textarea",{class:"form-control border-secondary rounded-0","onUpdate:modelValue":o[2]||(o[2]=d=>e.clientForm.info=d),placeholder:"Оставьте свой комментарий",id:"checkout-info"},null,512),[[y,e.clientForm.info]]),Kt]),t("div",Qt,[t("div",Wt,[t("div",Xt,[m(t("input",{class:"form-check-input",type:"radio",value:"1","onUpdate:modelValue":o[3]||(o[3]=d=>e.clientForm.work_with_nds=d),name:"flexRadioDefault",id:"work-with-nds"},null,512),[[U,e.clientForm.work_with_nds]]),Yt])]),t("div",Zt,[t("div",$t,[m(t("input",{class:"form-check-input",type:"radio",value:"0",name:"flexRadioDefault","onUpdate:modelValue":o[4]||(o[4]=d=>e.clientForm.work_with_nds=d),id:"work-without-nds"},null,512),[[U,e.clientForm.work_with_nds]]),eo])]),t("div",to,[t("div",oo,[m(t("input",{class:"form-check-input",type:"radio",value:"2",name:"flexRadioDefault","onUpdate:modelValue":o[5]||(o[5]=d=>e.clientForm.work_with_nds=d),id:"work-without-nds"},null,512),[[U,e.clientForm.work_with_nds]]),lo])])])],64)):u("",!0)}const go=z(Bt,[["render",io]]),so={props:["modelValue"],data(){return{clientForm:null}},watch:{clientForm:{handler(s){this.$emit("update:modelValue",this.clientForm)},deep:!0}},mounted(){this.clientForm=this.modelValue}},no={class:"form-floating mb-2"},ro=t("label",{for:"checkout-phone"},"Номер телефона",-1),co={class:"form-floating mb-2"},ao=t("label",{for:"checkout-email"},"Электронная почта",-1),po={class:"form-floating mb-2"},uo=t("label",{for:"checkout-email"},"Паспорт",-1),mo={class:"form-floating mb-2"},_o=t("label",{for:"checkout-email"},"Выдан",-1),ho={class:"form-floating mb-2"},fo=t("label",{for:"checkout-email"},"Дополнительная информация",-1);function yo(s,o,_,F,e,p){const l=M("mask");return e.clientForm?(n(),r(g,{key:0},[t("div",no,[m(t("input",{type:"text",class:"form-control","onUpdate:modelValue":o[0]||(o[0]=d=>e.clientForm.phone=d),id:"checkout-phone",placeholder:"name@example.com",required:""},null,512),[[l,"+7(###)###-##-##"],[y,e.clientForm.phone]]),ro]),t("div",co,[m(t("input",{type:"email",class:"form-control","onUpdate:modelValue":o[1]||(o[1]=d=>e.clientForm.email=d),id:"checkout-email",placeholder:"name@example.com"},null,512),[[y,e.clientForm.email]]),ao]),t("div",po,[m(t("input",{type:"text",class:"form-control","onUpdate:modelValue":o[2]||(o[2]=d=>e.clientForm.passport=d),id:"checkout-email",placeholder:"name@example.com"},null,512),[[l,"## ##  ######"],[y,e.clientForm.passport]]),uo]),t("div",mo,[m(t("input",{type:"text",class:"form-control","onUpdate:modelValue":o[3]||(o[3]=d=>e.clientForm.passport_issued=d),id:"checkout-email",placeholder:"name@example.com"},null,512),[[y,e.clientForm.passport_issued]]),_o]),t("div",ho,[m(t("input",{type:"text",class:"form-control","onUpdate:modelValue":o[4]||(o[4]=d=>e.clientForm.info=d),id:"checkout-email",placeholder:"name@example.com"},null,512),[[y,e.clientForm.info]]),fo])],64)):u("",!0)}const Fo=z(so,[["render",yo]]);export{vo as C,Fo as I,go as L};
