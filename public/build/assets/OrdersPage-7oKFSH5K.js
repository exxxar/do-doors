import{_ as C}from"./AuthenticatedLayout-BPDrkxgW.js";import{m as v,o,c as n,b as e,g as _,v as g,f as r,e as d,F as h,r as m,t as a,d as p,q as O,a as f,w as b,u as $,s as k,p as D,h as L,Z as j}from"./app-C4XhUTUs.js";import{P as y}from"./Pagination-B9t46zl0.js";import{_ as A}from"./CalcPreview-rk2qnQCT.js";import{D as I}from"./DownloadDocumentForm-BVhIKuJv.js";import{E as w}from"./main-D2ut9avD.js";import"./ApplicationLogo-BufCv91K.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./IndividualDataForm-7ZsgFr32.js";import"./vue-the-mask-DsWwTGu8.js";import"./DoorItemEditor-7BqxUOwR.js";import"./RalColorSelector-kXDVe58c.js";import"./HandleDetail-BlOFc7SH.js";const T={class:"row"},V={class:"col-12"},E={class:"input-group mb-3"},M={class:"form-floating"},P=e("label",{for:"search-orderDetails"},"Поиск по деталям заказа",-1),B=e("i",{class:"fa-solid fa-magnifying-glass"},null,-1),z=[B],F={class:"d-flex scrollable-area"},S={key:0,class:"table"},U={key:0},N=e("i",{class:"fa-solid fa-caret-down"},null,-1),R=[N],q={key:1},K=e("i",{class:"fa-solid fa-caret-up"},null,-1),G=[K],Z={key:0},H=e("i",{class:"fa-solid fa-caret-down"},null,-1),J=[H],Q={key:1},W=e("i",{class:"fa-solid fa-caret-up"},null,-1),X=[W],Y={key:0},x=e("i",{class:"fa-solid fa-caret-down"},null,-1),tt=[x],et={key:1},st=e("i",{class:"fa-solid fa-caret-up"},null,-1),ot=[st],nt={key:0},lt=e("i",{class:"fa-solid fa-caret-down"},null,-1),dt=[lt],it={key:1},rt=e("i",{class:"fa-solid fa-caret-up"},null,-1),at=[rt],ct={key:0},ut=e("i",{class:"fa-solid fa-caret-down"},null,-1),ht=[ut],_t={key:1},pt=e("i",{class:"fa-solid fa-caret-up"},null,-1),mt=[pt],ft={key:0},bt=e("i",{class:"fa-solid fa-caret-down"},null,-1),kt=[bt],vt={key:1},gt=e("i",{class:"fa-solid fa-caret-up"},null,-1),$t=[gt],yt={key:0},wt=e("i",{class:"fa-solid fa-caret-down"},null,-1),Ct=[wt],Ot={key:1},Dt=e("i",{class:"fa-solid fa-caret-up"},null,-1),Lt=[Dt],jt={key:0},At=e("i",{class:"fa-solid fa-caret-down"},null,-1),It=[At],Tt={key:1},Vt=e("i",{class:"fa-solid fa-caret-up"},null,-1),Et=[Vt],Mt=e("th",{scope:"col",class:"text-center"},"Действие",-1),Pt={scope:"row"},Bt=["onClick"],zt={class:"text-center"},Ft={class:"text-center"},St={class:"text-center"},Ut={class:"text-center"},Nt={class:"text-center"},Rt={class:"text-center"},qt={class:"text-center"},Kt={class:"dropdown"},Gt=e("button",{class:"btn btn-link",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-bars"})],-1),Zt={class:"dropdown-menu"},Ht=["onClick"],Jt=e("i",{class:"fa-solid fa-pen mr-2"},null,-1),Qt=["onClick"],Wt=e("i",{class:"fa-solid fa-trash-can mr-2"},null,-1),Xt={key:0,class:"alert alert-success",role:"alert"},Yt=e("h4",{class:"alert-heading"},"Детали заказа",-1),xt=e("p",null,"К сожалению,в данном заказе нет деталей заказа",-1),te=[Yt,xt],ee={key:1,class:"row mb-3"},se={class:"col-12"},oe={props:["orderId"],data(){return{sort:{column:null,direction:"desc"},search:null,current_page:0,paginate_object:null,items:[{id:null,title:null,price:0,variants:[]}]}},computed:{...v(["getOrderDetails","getOrderDetailsPaginateObject"])},mounted(){this.loadOrderDetails()},methods:{sortAndLoad(i){this.sort.column=i,this.sort.direction=this.sort.direction==="desc"?"asc":"desc",this.loadOrderDetails(this.current_page)},loadOrderDetails(i=0){this.current_page=i,this.$store.dispatch("loadOrderDetails",{dataObject:{order_id:this.orderId,search:this.search,order:this.sort.column,direction:this.sort.direction},page:this.current_page}).then(t=>{this.items=this.getOrderDetails,this.paginate_object=this.getOrderDetailsPaginateObject}).catch(()=>{this.loading=!1})},selectItem(i){this.$emit("select",i)},duplicateItem(i){this.$store.dispatch("duplicateOrderDetail",{orderDetailId:i}).then(()=>{this.sortAndLoad("id")})},removeItem(i){this.$store.dispatch("removeOrderDetail",{orderDetailId:i}).then(()=>{this.sortAndLoad("id")})}}},ne=Object.assign(oe,{__name:"OrderDetailTable",setup(i){return(t,l)=>(o(),n(h,null,[e("form",T,[e("div",V,[e("div",E,[e("div",M,[_(e("input",{type:"search","onUpdate:modelValue":l[0]||(l[0]=s=>t.search=s),class:"form-control",id:"search-orderDetails"},null,512),[[g,t.search]]),P]),e("button",{type:"button",onClick:l[1]||(l[1]=s=>t.sortAndLoad("id")),class:"btn btn-outline-secondary rounded-0"},z)])])]),e("div",F,[t.items.length>0?(o(),n("table",S,[e("thead",null,[e("tr",null,[e("th",{scope:"col",class:"cursor-pointer",onClick:l[2]||(l[2]=s=>t.sortAndLoad("id"))},[r("# "),t.sort.direction==="desc"&&t.sort.column==="id"?(o(),n("span",U,R)):d("",!0),t.sort.direction==="asc"&&t.sort.column==="id"?(o(),n("span",q,G)):d("",!0)]),e("th",{scope:"col",class:"text-center cursor-pointer",onClick:l[3]||(l[3]=s=>t.sortAndLoad("door_type"))},[r("Тип двери "),t.sort.direction==="desc"&&t.sort.column==="door_type"?(o(),n("span",Z,J)):d("",!0),t.sort.direction==="asc"&&t.sort.column==="door_type"?(o(),n("span",Q,X)):d("",!0)]),e("th",{scope:"col",class:"text-center cursor-pointer",onClick:l[4]||(l[4]=s=>t.sortAndLoad("count"))},[r("Кол-во "),t.sort.direction==="desc"&&t.sort.column==="count"?(o(),n("span",Y,tt)):d("",!0),t.sort.direction==="asc"&&t.sort.column==="count"?(o(),n("span",et,ot)):d("",!0)]),e("th",{scope:"col",class:"text-center cursor-pointer",onClick:l[5]||(l[5]=s=>t.sortAndLoad("price"))},[r("Цена "),t.sort.direction==="desc"&&t.sort.column==="price"?(o(),n("span",nt,dt)):d("",!0),t.sort.direction==="asc"&&t.sort.column==="price"?(o(),n("span",it,at)):d("",!0)]),e("th",{scope:"col",class:"text-center cursor-pointer",onClick:l[6]||(l[6]=s=>t.sortAndLoad("comment"))},[r("Комментарий "),t.sort.direction==="desc"&&t.sort.column==="comment"?(o(),n("span",ct,ht)):d("",!0),t.sort.direction==="asc"&&t.sort.column==="comment"?(o(),n("span",_t,mt)):d("",!0)]),e("th",{scope:"col",class:"text-center cursor-pointer",onClick:l[7]||(l[7]=s=>t.sortAndLoad("purpose"))},[r("Назначение двери "),t.sort.direction==="desc"&&t.sort.column==="purpose"?(o(),n("span",ft,kt)):d("",!0),t.sort.direction==="asc"&&t.sort.column==="purpose"?(o(),n("span",vt,$t)):d("",!0)]),e("th",{scope:"col",class:"text-center cursor-pointer",onClick:l[8]||(l[8]=s=>t.sortAndLoad("door"))},[r("Параметры двери "),t.sort.direction==="desc"&&t.sort.column==="door"?(o(),n("span",yt,Ct)):d("",!0),t.sort.direction==="asc"&&t.sort.column==="door"?(o(),n("span",Ot,Lt)):d("",!0)]),e("th",{scope:"col",class:"text-center cursor-pointer",onClick:l[9]||(l[9]=s=>t.sortAndLoad("updated_at"))},[r(" Дата изменения "),t.sort.direction==="desc"&&t.sort.column==="updated_at"?(o(),n("span",jt,It)):d("",!0),t.sort.direction==="asc"&&t.sort.column==="updated_at"?(o(),n("span",Tt,Et)):d("",!0)]),Mt])]),e("tbody",null,[(o(!0),n(h,null,m(t.items,(s,u)=>(o(),n("tr",null,[e("th",Pt,a(s.id||u),1),e("td",{class:"text-center",onClick:c=>t.selectItem(s)},a(s.door_type||"-"),9,Bt),e("td",zt,a(s.count||0),1),e("td",Ft,a(s.price||0),1),e("td",St,a(s.comment||"-"),1),e("td",Ut,a(s.purpose||"-"),1),e("td",Nt,a(s.door||"-"),1),e("td",Rt,a(s.updated_at||"-"),1),e("td",qt,[e("div",Kt,[Gt,e("ul",Zt,[e("li",null,[e("a",{class:"dropdown-item",onClick:c=>t.selectItem(s),href:"javascript:void(0)"},[Jt,r("Редактировать")],8,Ht)]),e("li",null,[e("a",{class:"dropdown-item text-danger",onClick:c=>t.removeItem(s.id),href:"javascript:void(0)"},[Wt,r("Удалить")],8,Qt)])])])])]))),256))])])):d("",!0)]),t.items.length===0?(o(),n("div",Xt,te)):d("",!0),t.items.length>0?(o(),n("div",ee,[e("div",se,[t.paginate_object?(o(),p(y,{key:0,onPagination_page:t.loadOrderDetails,pagination:t.paginate_object},null,8,["onPagination_page","pagination"])):d("",!0)])])):d("",!0)],64))}}),le={class:"row"},de={class:"col-12"},ie={class:"input-group mb-3"},re={class:"form-floating"},ae=e("label",{for:"search-orders"},"Поиск по заказам",-1),ce={class:"dropdown"},ue=e("button",{class:"btn btn-outline-secondary rounded-0 h-100",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-up-right-and-down-left-from-center"})],-1),he={class:"dropdown-menu"},_e=e("i",{class:"fa-solid fa-magnifying-glass"},null,-1),pe=e("i",{class:"fa-regular fa-file-excel"},null,-1),me={class:"col-12"},fe={class:"action-row"},be=["onClick"],ke=["onClick"],ve={class:"col-12 mb-2"},ge=["onClick"],$e=e("i",{class:"fa-solid fa-retweet"},null,-1),ye=[$e],we=e("i",{class:"fa-solid fa-xmark"},null,-1),Ce=[we],Oe={class:"col-12"},De={class:"my-3"},Le=["onClick"],je=e("i",{class:"fa-solid fa-xmark"},null,-1),Ae=[je],Ie={class:"d-flex flex-wrap"},Te={key:1,class:"my-2 small italic"},Ve={class:"d-flex scrollable-area"},Ee={key:0,class:"table"},Me={key:0},Pe=e("i",{class:"fa-solid fa-caret-down"},null,-1),Be=[Pe],ze={key:1},Fe=e("i",{class:"fa-solid fa-caret-up"},null,-1),Se=[Fe],Ue=e("th",{scope:"col",class:"text-center"},"Действие",-1),Ne={key:0},Re=e("i",{class:"fa-solid fa-caret-down"},null,-1),qe=[Re],Ke={key:1},Ge=e("i",{class:"fa-solid fa-caret-up"},null,-1),Ze=[Ge],He={key:0},Je=e("i",{class:"fa-solid fa-caret-down"},null,-1),Qe=[Je],We={key:1},Xe=e("i",{class:"fa-solid fa-caret-up"},null,-1),Ye=[Xe],xe={key:0},ts=e("i",{class:"fa-solid fa-caret-down"},null,-1),es=[ts],ss={key:1},os=e("i",{class:"fa-solid fa-caret-up"},null,-1),ns=[os],ls={key:0},ds=e("i",{class:"fa-solid fa-caret-down"},null,-1),is=[ds],rs={key:1},as=e("i",{class:"fa-solid fa-caret-up"},null,-1),cs=[as],us={key:0},hs=e("i",{class:"fa-solid fa-caret-down"},null,-1),_s=[hs],ps={key:1},ms=e("i",{class:"fa-solid fa-caret-up"},null,-1),fs=[ms],bs={key:0},ks=e("i",{class:"fa-solid fa-caret-down"},null,-1),vs=[ks],gs={key:1},$s=e("i",{class:"fa-solid fa-caret-up"},null,-1),ys=[$s],ws={key:0},Cs=e("i",{class:"fa-solid fa-caret-down"},null,-1),Os=[Cs],Ds={key:1},Ls=e("i",{class:"fa-solid fa-caret-up"},null,-1),js=[Ls],As={key:0},Is=e("i",{class:"fa-solid fa-caret-down"},null,-1),Ts=[Is],Vs={key:1},Es=e("i",{class:"fa-solid fa-caret-up"},null,-1),Ms=[Es],Ps={key:0},Bs=e("i",{class:"fa-solid fa-caret-down"},null,-1),zs=[Bs],Fs={key:1},Ss=e("i",{class:"fa-solid fa-caret-up"},null,-1),Us=[Ss],Ns={key:0},Rs=e("i",{class:"fa-solid fa-caret-down"},null,-1),qs=[Rs],Ks={key:1},Gs=e("i",{class:"fa-solid fa-caret-up"},null,-1),Zs=[Gs],Hs={key:0},Js=e("i",{class:"fa-solid fa-caret-down"},null,-1),Qs=[Js],Ws={key:1},Xs=e("i",{class:"fa-solid fa-caret-up"},null,-1),Ys=[Xs],xs={key:0},to=e("i",{class:"fa-solid fa-caret-down"},null,-1),eo=[to],so={key:1},oo=e("i",{class:"fa-solid fa-caret-up"},null,-1),no=[oo],lo={key:0},io=e("i",{class:"fa-solid fa-caret-down"},null,-1),ro=[io],ao={key:1},co=e("i",{class:"fa-solid fa-caret-up"},null,-1),uo=[co],ho={scope:"row"},_o={class:"form-check"},po=["value","id"],mo=["for"],fo={class:"text-center"},bo={class:"dropdown"},ko=e("button",{class:"btn btn-link",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-bars"})],-1),vo={class:"dropdown-menu"},go=["onClick"],$o=e("i",{class:"fa-solid fa-pen mr-2"},null,-1),yo=e("li",null,[e("hr",{class:"dropdown-divider"})],-1),wo=["onClick"],Co=e("i",{class:"fa-solid fa-paper-plane mr-2"},null,-1),Oo=["onClick"],Do=e("i",{class:"fa-solid fa-square-arrow-up-right mr-2"},null,-1),Lo=e("li",null,[e("hr",{class:"dropdown-divider"})],-1),jo=["href"],Ao=e("i",{class:"fa-regular fa-file-excel mr-2"},null,-1),Io=["onClick"],To=e("i",{class:"fa-solid fa-file-signature mr-2"},null,-1),Vo=e("li",null,[e("hr",{class:"dropdown-divider"})],-1),Eo=["onClick"],Mo=e("i",{class:"fa-solid fa-trash-can mr-2"},null,-1),Po=["onClick"],Bo=["onClick"],zo={key:2,class:"text-center"},Fo={key:3,class:"text-center"},So={key:4,class:"text-center"},Uo={key:0},No={key:1},Ro={key:5,class:"text-center"},qo={key:6,class:"text-center"},Ko={key:7,class:"text-center"},Go={key:8,class:"text-center"},Zo={key:9,class:"text-center"},Ho={key:10,class:"text-center"},Jo={key:11,class:"text-center"},Qo={key:12,class:"text-center"},Wo={key:2,class:"alert alert-success rounded-0",role:"alert"},Xo=e("h4",{class:"alert-heading"},"Заказы",-1),Yo=e("p",null,"К сожалению, раздел заказов пуст.",-1),xo=[Xo,Yo],tn={key:3,class:"row mb-3"},en={class:"col-12"},sn={class:"modal fade",id:"order-details",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},on={class:"modal-dialog modal-fullscreen"},nn={class:"modal-content"},ln=e("div",{class:"modal-header"},[e("h1",{class:"modal-title fs-5",id:"exampleModalLabel"},"Детали заказа"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},[e("i",{class:"fa-solid fa-xmark"})])],-1),dn={class:"modal-body"},rn=e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-outline-secondary rounded-0","data-bs-dismiss":"modal"},"Закрыть ")],-1),an={class:"modal fade",id:"confirm-modal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},cn={class:"modal-dialog modal-dialog-centered"},un={class:"modal-content rounded-0"},hn={class:"modal-body"},_n=e("div",{class:"d-flex justify-center p-3"},[e("img",{src:"/images/logo.png",style:{width:"100px"},alt:""})],-1),pn={class:"font-bold text-center py-3"},mn={class:"text-center pb-3"},fn={class:"row mb-3"},bn={class:"col-md-6 d-flex justify-center"},kn={class:"form-check"},vn=e("label",{class:"form-check-label",for:"work-with-nds"}," Работаю с НДС ",-1),gn={class:"col-md-6 d-flex justify-center"},$n={class:"form-check"},yn=e("label",{class:"form-check-label",for:"work-without-nds"}," Работаю без НДС ",-1),wn={class:"row"},Cn={class:"col-6"},On={class:"col-6"},Dn={class:"modal fade",id:"order-editor-modal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},Ln={class:"modal-dialog modal-xl"},jn={class:"modal-content rounded-0"},An={class:"modal-body"},In={components:{VueDatePicker:w},data(){return{editor_modal:null,selected_orders:[],selected_item:null,table:{contract_number:{title:"Номер договора",value:!0},contract_date:{title:"Дата договора",value:!0},completion_at:{title:"Дата закрытия",value:!0},client_id:{title:"Идентификатор клиента",value:!0},status:{title:"Статус",value:!0},source:{title:"Источник",value:!0},contact_person:{title:"Контактное лицо",value:!0},phone:{title:"Номер телефона",value:!0},organizational_form:{title:"Организационная форма",value:!0},contract_amount:{title:"Сумма договора",value:!0},paid:{title:"Оплачено",value:!0},debt:{title:"Остаток",value:!0},profit:{title:"Доход",value:!0}},sort:{column:null,date:null,direction:"desc"},selected_order:null,order_detail_modal:null,order_status:["Новый заказ","В работе","Завершен"],search:null,current_page:0,paginate_object:null,loading:!1,confirm_modal:null,confirm:{title:null,message:null,work_with_nds:1,item:null},items:[{id:null,contract_number:null,contract_date:null,completion_at:null,client_id:null,status:null,source:null,contact_person:null,phone:null,organizational_form:null,contract_amount:null,paid:null,debt:null,profit:null}]}},computed:{...v(["getOrders","getOrdersPaginateObject"])},mounted(){this.loadOrders(),this.order_detail_modal=new bootstrap.Modal(document.getElementById("order-details"),{}),this.confirm_modal=new bootstrap.Modal(document.getElementById("confirm-modal"),{}),this.editor_modal=new bootstrap.Modal(document.getElementById("order-editor-modal"),{})},methods:{selectOrder(i){let t=this.selected_orders.findIndex(l=>l===i);t===-1?this.selected_orders.push(i):this.selected_orders.splice(t,1)},resetColumns(){Object.keys(this.table).forEach(i=>{this.table[i].value=!0})},changeColumns(i){i?this.table[i].value=!this.table[i].value:Object.keys(this.table).forEach(t=>{this.table[t].value=!this.table[t].value})},openConfirmModal(i,t,l){this.confirm.title=i||null,this.confirm.message=t||null,this.confirm.item=l||null,this.confirm_modal.show()},sortAndLoad(i){this.sort.column=i,this.sort.direction=this.sort.direction==="desc"?"asc":"desc",this.loadOrders(this.current_page)},downloadSelectedOrders(){let i=this.sort,t=(i.date||[]).length>0?new Date(i.date[0]).getTime():null,l=(i.date||[]).length>1?new Date(i.date[1]).getTime():null,s=`/orders/download-filtered-orders?order=id&ids=${this.selected_orders.join(",")}&type=multiply`;t&&l&&(s+=`&df=${t}&dt=${l}`),this.search&&(s+=`&search=${this.search||null}`),window.open(s,"_blank").focus()},filteredDownload(){let i=this.sort,t=(i.date||[]).length>0?new Date(i.date[0]).getTime():null,l=(i.date||[]).length>1?new Date(i.date[1]).getTime():null,s="/orders/download-filtered-orders?order=id";t&&l&&(s+=`&df=${t}&dt=${l}`),this.search&&(s+=`&search=${this.search||null}`),window.open(s,"_blank").focus()},sendToBitrix(i){this.$store.dispatch("sendOrderToBitrix",{order_id:i.id}).then(()=>{this.$notify({title:"DoDoors",text:"Информация успешно отправлена в Битрикс",type:"success"})}).catch(()=>{this.$notify({title:"DoDoors",text:"Ошибка отправки информации в Битрикс",type:"error"})})},sendToTelegram(i){this.$store.dispatch("sendOrderToTelegram",{order_id:i.id}).then(()=>{this.$notify({title:"DoDoors",text:"Информация успешно отправлена в Телеграм",type:"success"})}).catch(()=>{this.$notify({title:"DoDoors",text:"Ошибка отправки информации в Телеграм",type:"error"})})},downloadDocument(i){window.open(`/orders/download-contract?id=${i.id}`,"_blank").focus()},loadOrders(i=0){this.current_page=i;let t=this.sort,l=(t.date||[]).length>0?t.date[0]:null,s=(t.date||[]).length>1?t.date[1]:null;this.$store.dispatch("loadOrders",{dataObject:{search:this.search,order:this.sort.column,direction:this.sort.direction,df:l||null,dt:s||null},page:this.current_page}).then(u=>{this.items=this.getOrders,this.paginate_object=this.getOrdersPaginateObject}).catch(()=>{this.loading=!1})},selectItemForEdit(i){if(i==null){this.selected_item=null,this.editor_modal.hide();return}this.selected_item=null,this.$nextTick(()=>{this.selected_item=i,this.editor_modal.show()})},selectItem(i){this.loading=!0,this.selected_order=i,this.$nextTick(()=>{this.loading=!1,this.order_detail_modal.show()})},duplicateItem(i){this.$store.dispatch("duplicateOrder",{materialId:i}).then(()=>{this.sortAndLoad("id")})},removeItem(i){this.$store.dispatch("removeOrder",{materialId:i}).then(()=>{this.sortAndLoad("id")})}}},Tn=Object.assign(In,{__name:"OrderTable",setup(i){return(t,l)=>(o(),n(h,null,[e("div",le,[e("div",de,[e("div",ie,[e("div",re,[_(e("input",{type:"search","onUpdate:modelValue":l[0]||(l[0]=s=>t.search=s),onKeydown:l[1]||(l[1]=O(s=>t.sortAndLoad("id"),["enter"])),class:"form-control",id:"search-orders"},null,544),[[g,t.search]]),ae]),e("div",ce,[ue,e("ul",he,[e("li",null,[e("a",{class:"dropdown-item",href:"javascript:void(0)",onClick:l[2]||(l[2]=s=>t.sortAndLoad("id"))},[_e,r(" Искать")])]),e("li",null,[e("a",{class:"dropdown-item",onClick:l[3]||(l[3]=(...s)=>t.filteredDownload&&t.filteredDownload(...s)),href:"javascript:void(0)"},[pe,r(" Скачать в Excel ")])])])])])]),e("div",me,[f($(w),{class:"rounded-0",locale:"ru",range:"","multi-calendars":"",modelValue:t.sort.date,"onUpdate:modelValue":l[4]||(l[4]=s=>t.sort.date=s)},{"action-row":b(({internalModelValue:s,selectDate:u,closePicker:c})=>[e("div",fe,[e("button",{class:"btn btn-dark rounded-0 mr-2",onClick:u},"Выбрать",8,be),e("button",{class:"btn btn-outline-secondary rounded-0",onClick:c},"Закрыть",8,ke)])]),_:1},8,["modelValue"])]),e("div",ve,[(o(!0),n(h,null,m(Object.keys(t.table),s=>(o(),n("span",{class:D(["badge mr-1 rounded-0 cursor-pointer",{"bg-dark":t.table[s].value===!0,"bg-secondary":t.table[s].value===!1}]),onClick:u=>t.changeColumns(s)},a(t.table[s].title||"-"),11,ge))),256)),e("span",{onClick:l[5]||(l[5]=s=>t.changeColumns(null)),class:"badge mr-1 bg-danger rounded-0 cursor-pointer"},ye),e("span",{onClick:l[6]||(l[6]=(...s)=>t.resetColumns&&t.resetColumns(...s)),class:"badge mr-1 bg-secondary rounded-0 cursor-pointer"},Ce)]),e("div",Oe,[f(I,null,{name:b(()=>[r(" Скачать договор по номеру заказа ")]),_:1})])]),t.selected_orders.length>0?(o(),n(h,{key:0},[e("p",De,[r("Выбрано "),e("span",null,"("+a(t.selected_orders.length)+")",1),r(" элементов: "),(o(!0),n(h,null,m(t.selected_orders,s=>(o(),n("span",{onClick:u=>t.selectOrder(s),class:"badge mr-1 bg-dark rounded-0 cursor-pointer"},a(s),9,Le))),256)),e("span",{onClick:l[7]||(l[7]=s=>t.selected_orders=[]),class:"badge mr-1 bg-secondary rounded-0 cursor-pointer"},Ae)]),e("div",Ie,[e("button",{onClick:l[8]||(l[8]=(...s)=>t.downloadSelectedOrders&&t.downloadSelectedOrders(...s)),type:"button",class:"btn btn-dark rounded-0 mr-2"},"Скачать эксель")])],64)):d("",!0),t.paginate_object?(o(),n("p",Te,[r("Найдено результатов "),e("strong",null,a(t.paginate_object.meta.total),1)])):d("",!0),e("div",Ve,[t.items.length>0?(o(),n("table",Ee,[e("thead",null,[e("tr",null,[e("th",{scope:"col",class:"cursor-pointer",onClick:l[9]||(l[9]=s=>t.sortAndLoad("id"))},[r("# "),t.sort.direction==="desc"&&t.sort.column==="id"?(o(),n("span",Me,Be)):d("",!0),t.sort.direction==="asc"&&t.sort.column==="id"?(o(),n("span",ze,Se)):d("",!0)]),Ue,t.table.contract_number.value?(o(),n("th",{key:0,scope:"col",class:"text-center cursor-pointer",onClick:l[10]||(l[10]=s=>t.sortAndLoad("contract_number"))},[r("Номер договора "),t.sort.direction==="desc"&&t.sort.column==="contract_number"?(o(),n("span",Ne,qe)):d("",!0),t.sort.direction==="asc"&&t.sort.column==="contract_number"?(o(),n("span",Ke,Ze)):d("",!0)])):d("",!0),t.table.contract_date.value?(o(),n("th",{key:1,scope:"col",class:"text-center cursor-pointer",onClick:l[11]||(l[11]=s=>t.sortAndLoad("contract_date"))},[r("Дата договора "),t.sort.direction==="desc"&&t.sort.column==="contract_date"?(o(),n("span",He,Qe)):d("",!0),t.sort.direction==="asc"&&t.sort.column==="contract_date"?(o(),n("span",We,Ye)):d("",!0)])):d("",!0),t.table.completion_at.value?(o(),n("th",{key:2,scope:"col",class:"text-center cursor-pointer",onClick:l[12]||(l[12]=s=>t.sortAndLoad("completion_at"))},[r("Дата закрытия "),t.sort.direction==="desc"&&t.sort.column==="completion_at"?(o(),n("span",xe,es)):d("",!0),t.sort.direction==="asc"&&t.sort.column==="completion_at"?(o(),n("span",ss,ns)):d("",!0)])):d("",!0),t.table.client_id.value?(o(),n("th",{key:3,scope:"col",class:"text-center cursor-pointer",onClick:l[13]||(l[13]=s=>t.sortAndLoad("client_id"))},[r("Клиент "),t.sort.direction==="desc"&&t.sort.column==="client_id"?(o(),n("span",ls,is)):d("",!0),t.sort.direction==="asc"&&t.sort.column==="client_id"?(o(),n("span",rs,cs)):d("",!0)])):d("",!0),t.table.status.value?(o(),n("th",{key:4,scope:"col",class:"text-center cursor-pointer",onClick:l[14]||(l[14]=s=>t.sortAndLoad("status"))},[r("Статус заказа "),t.sort.direction==="desc"&&t.sort.column==="status"?(o(),n("span",us,_s)):d("",!0),t.sort.direction==="asc"&&t.sort.column==="status"?(o(),n("span",ps,fs)):d("",!0)])):d("",!0),t.table.source.value?(o(),n("th",{key:5,scope:"col",class:"text-center cursor-pointer",onClick:l[15]||(l[15]=s=>t.sortAndLoad("source"))},[r("Источник "),t.sort.direction==="desc"&&t.sort.column==="source"?(o(),n("span",bs,vs)):d("",!0),t.sort.direction==="asc"&&t.sort.column==="source"?(o(),n("span",gs,ys)):d("",!0)])):d("",!0),t.table.contact_person.value?(o(),n("th",{key:6,scope:"col",class:"text-center cursor-pointer",onClick:l[16]||(l[16]=s=>t.sortAndLoad("contact_person"))},[r("Контактное лицо "),t.sort.direction==="desc"&&t.sort.column==="contact_person"?(o(),n("span",ws,Os)):d("",!0),t.sort.direction==="asc"&&t.sort.column==="contact_person"?(o(),n("span",Ds,js)):d("",!0)])):d("",!0),t.table.phone.value?(o(),n("th",{key:7,scope:"col",class:"text-center cursor-pointer",onClick:l[17]||(l[17]=s=>t.sortAndLoad("phone"))},[r("Телефон "),t.sort.direction==="desc"&&t.sort.column==="phone"?(o(),n("span",As,Ts)):d("",!0),t.sort.direction==="asc"&&t.sort.column==="phone"?(o(),n("span",Vs,Ms)):d("",!0)])):d("",!0),t.table.organizational_form.value?(o(),n("th",{key:8,scope:"col",class:"text-center cursor-pointer",onClick:l[18]||(l[18]=s=>t.sortAndLoad("organizational_form"))},[r("На ип\\ооо "),t.sort.direction==="desc"&&t.sort.column==="organizational_form"?(o(),n("span",Ps,zs)):d("",!0),t.sort.direction==="asc"&&t.sort.column==="organizational_form"?(o(),n("span",Fs,Us)):d("",!0)])):d("",!0),t.table.contract_amount.value?(o(),n("th",{key:9,scope:"col",class:"text-center cursor-pointer",onClick:l[19]||(l[19]=s=>t.sortAndLoad("contract_amount"))},[r("Сумма договора "),t.sort.direction==="desc"&&t.sort.column==="contract_amount"?(o(),n("span",Ns,qs)):d("",!0),t.sort.direction==="asc"&&t.sort.column==="contract_amount"?(o(),n("span",Ks,Zs)):d("",!0)])):d("",!0),t.table.paid.value?(o(),n("th",{key:10,scope:"col",class:"text-center cursor-pointer",onClick:l[20]||(l[20]=s=>t.sortAndLoad("paid"))},[r("Оплачено "),t.sort.direction==="desc"&&t.sort.column==="paid"?(o(),n("span",Hs,Qs)):d("",!0),t.sort.direction==="asc"&&t.sort.column==="paid"?(o(),n("span",Ws,Ys)):d("",!0)])):d("",!0),t.table.debt.value?(o(),n("th",{key:11,scope:"col",class:"text-center cursor-pointer",onClick:l[21]||(l[21]=s=>t.sortAndLoad("debt"))},[r("Задолженность "),t.sort.direction==="desc"&&t.sort.column==="debt"?(o(),n("span",xs,eo)):d("",!0),t.sort.direction==="asc"&&t.sort.column==="debt"?(o(),n("span",so,no)):d("",!0)])):d("",!0),t.table.profit.value?(o(),n("th",{key:12,scope:"col",class:"text-center cursor-pointer",onClick:l[22]||(l[22]=s=>t.sortAndLoad("profit"))},[r("Прибыль "),t.sort.direction==="desc"&&t.sort.column==="profit"?(o(),n("span",lo,ro)):d("",!0),t.sort.direction==="asc"&&t.sort.column==="profit"?(o(),n("span",ao,uo)):d("",!0)])):d("",!0)])]),e("tbody",null,[(o(!0),n(h,null,m(t.items,(s,u)=>(o(),n("tr",null,[e("th",ho,[e("div",_o,[_(e("input",{value:s.id,"onUpdate:modelValue":l[23]||(l[23]=c=>t.selected_orders=c),class:"form-check-input",type:"checkbox",id:"order-check-"+u},null,8,po),[[L,t.selected_orders]]),e("label",{class:"form-check-label",for:"order-check-"+u},a(s.id||u),9,mo)])]),e("td",fo,[e("div",bo,[ko,e("ul",vo,[e("li",null,[e("a",{class:"dropdown-item",onClick:c=>t.selectItemForEdit(s),href:"javascript:void(0)"},[$o,r("Редактор заказа")],8,go)]),yo,e("li",null,[e("a",{class:"dropdown-item disabled",onClick:c=>t.sendToTelegram(s),href:"javascript:void(0)"},[Co,r(" Отправить в телеграм ")],8,wo)]),e("li",null,[e("a",{class:"dropdown-item disabled",onClick:c=>t.sendToBitrix(s),href:"javascript:void(0)"},[Do,r(" Отправить в Битрикс ")],8,Oo)]),Lo,e("li",null,[e("a",{class:"dropdown-item",target:"_blank",href:"/orders/download-order-excel/"+s.id},[Ao,r("Скачать Excel-документ по заказу")],8,jo)]),e("li",null,[e("a",{class:"dropdown-item",onClick:c=>t.downloadDocument(s),href:"javascript:void(0)"},[To,r("Скачать договор")],8,Io)]),Vo,e("li",null,[e("a",{class:"dropdown-item text-danger",onClick:c=>t.removeItem(s.id),href:"javascript:void(0)"},[Mo,r("Удалить")],8,Eo)])])])]),t.table.contract_number.value?(o(),n("td",{key:0,class:"text-center",onClick:c=>t.selectItem(s)},a(s.contract_number||"-"),9,Po)):d("",!0),t.table.contract_date.value?(o(),n("td",{key:1,class:"text-center",onClick:c=>t.selectItem(s)},a(s.contract_date||"-"),9,Bo)):d("",!0),t.table.completion_at.value?(o(),n("td",zo,a(s.completion_at||"-"),1)):d("",!0),t.table.client_id.value?(o(),n("td",Fo,a(s.client_id||"-"),1)):d("",!0),t.table.status.value?(o(),n("td",So,[(s.status||0)<=2?(o(),n("span",Uo,a(t.order_status[s.status]),1)):(o(),n("span",No,"Не указан"))])):d("",!0),t.table.source.value?(o(),n("td",Ro,a(s.source||"-"),1)):d("",!0),t.table.contact_person.value?(o(),n("td",qo,a(s.contact_person||"-"),1)):d("",!0),t.table.phone.value?(o(),n("td",Ko,a(s.phone||"-"),1)):d("",!0),t.table.organizational_form.value?(o(),n("td",Go,a(s.organizational_form||"-"),1)):d("",!0),t.table.contract_amount.value?(o(),n("td",Zo,a(s.contract_amount||0),1)):d("",!0),t.table.paid.value?(o(),n("td",Ho,a(s.paid||0),1)):d("",!0),t.table.debt.value?(o(),n("td",Jo,a(s.debt||0),1)):d("",!0),t.table.profit.value?(o(),n("td",Qo,a(s.profit||0),1)):d("",!0)]))),256))])])):d("",!0)]),t.items.length===0?(o(),n("div",Wo,xo)):d("",!0),t.items.length>0?(o(),n("div",tn,[e("div",en,[t.paginate_object?(o(),p(y,{key:0,onPagination_page:t.loadOrders,pagination:t.paginate_object},null,8,["onPagination_page","pagination"])):d("",!0)])])):d("",!0),e("div",sn,[e("div",on,[e("div",nn,[ln,e("div",dn,[t.selected_order&&!t.loading?(o(),p(ne,{key:0,"order-id":t.selected_order.id},null,8,["order-id"])):d("",!0)]),rn])])]),e("div",an,[e("div",cn,[e("div",un,[e("div",hn,[_n,e("h3",pn,a(t.confirm.title||"-"),1),e("p",mn,a(t.confirm.message||"-"),1),e("div",fn,[e("div",bn,[e("div",kn,[_(e("input",{class:"form-check-input",type:"radio",value:"1","onUpdate:modelValue":l[24]||(l[24]=s=>t.confirm.work_with_nds=s),name:"flexRadioDefault",id:"work-with-nds"},null,512),[[k,t.confirm.work_with_nds]]),vn])]),e("div",gn,[e("div",$n,[_(e("input",{class:"form-check-input",type:"radio",value:"0",name:"flexRadioDefault","onUpdate:modelValue":l[25]||(l[25]=s=>t.confirm.work_with_nds=s),id:"work-without-nds"},null,512),[[k,t.confirm.work_with_nds]]),yn])])]),e("div",wn,[e("div",Cn,[e("button",{class:"btn btn-dark rounded-0 w-100",type:"button",onClick:l[26]||(l[26]=(...s)=>t.downloadDocument&&t.downloadDocument(...s))},"Скачать договор ")]),e("div",On,[e("button",{class:"btn btn-outline-secondary rounded-0 w-100",onClick:l[27]||(l[27]=s=>t.confirm_modal.hide())}," Закрыть ")])])])])])]),e("div",Dn,[e("div",Ln,[e("div",jn,[e("div",An,[t.selected_item?(o(),p(A,{key:0,"can-edit":!0,doors:t.selected_item.details,order:t.selected_item},null,8,["doors","order"])):d("",!0)])])])])],64))}}),Vn=e("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"},"Заказы",-1),En={class:"py-12"},Mn={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},Pn={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},Bn={class:"p-6 text-gray-900"},zn={data(){return{loading:!1,selectedOrder:null}},methods:{selectOrder(i){this.selectedOrder=i,this.loading=!0,this.$nextTick(()=>{this.loading=!1})},callbackOrderForm(){this.loading=!0,this.selectedOrder=null,this.$nextTick(()=>{this.loading=!1})}}},Xn=Object.assign(zn,{__name:"OrdersPage",setup(i){return(t,l)=>(o(),n(h,null,[f($(j),{title:"Заказы"}),f(C,null,{header:b(()=>[Vn]),default:b(()=>[e("div",En,[e("div",Mn,[e("div",Pn,[e("div",Bn,[t.loading?d("",!0):(o(),p(Tn,{key:0,onSelect:t.selectOrder},null,8,["onSelect"]))])])])])]),_:1})],64))}});export{Xn as default};
