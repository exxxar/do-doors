import{_ as C}from"./AuthenticatedLayout-ClXfq32N.js";import{m as v,o,c as n,b as e,g as _,v as g,f as i,e as d,F as h,r as m,t as r,d as p,q as O,a as f,w as b,u as $,s as k,p as L,h as j,Z as D}from"./app-CEPaiL6J.js";import{P as y}from"./Pagination-CGWxGn_t.js";import{_ as A}from"./CalcPreview-2_Y6koq6.js";import{E as w}from"./main-ljg9dK2M.js";import"./ApplicationLogo-BIaKT3wU.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./IndividualDataForm-7UUsIhLV.js";import"./vue-the-mask-u8XnSBtM.js";import"./DoorItemEditor-Ccp65dfC.js";import"./RalColorSelector-CgLsS-rC.js";import"./HandleDetail-oy-GtF_m.js";const I={class:"row"},V={class:"col-12"},E={class:"input-group mb-3"},M={class:"form-floating"},P=e("label",{for:"search-orderDetails"},"Поиск по деталям заказа",-1),T=e("i",{class:"fa-solid fa-magnifying-glass"},null,-1),z=[T],B={class:"d-flex scrollable-area"},S={key:0,class:"table"},U={key:0},F=e("i",{class:"fa-solid fa-caret-down"},null,-1),N=[F],R={key:1},K=e("i",{class:"fa-solid fa-caret-up"},null,-1),q=[K],G={key:0},Z=e("i",{class:"fa-solid fa-caret-down"},null,-1),H=[Z],J={key:1},Q=e("i",{class:"fa-solid fa-caret-up"},null,-1),W=[Q],X={key:0},Y=e("i",{class:"fa-solid fa-caret-down"},null,-1),x=[Y],tt={key:1},et=e("i",{class:"fa-solid fa-caret-up"},null,-1),st=[et],ot={key:0},nt=e("i",{class:"fa-solid fa-caret-down"},null,-1),lt=[nt],dt={key:1},at=e("i",{class:"fa-solid fa-caret-up"},null,-1),it=[at],rt={key:0},ct=e("i",{class:"fa-solid fa-caret-down"},null,-1),ut=[ct],ht={key:1},_t=e("i",{class:"fa-solid fa-caret-up"},null,-1),pt=[_t],mt={key:0},ft=e("i",{class:"fa-solid fa-caret-down"},null,-1),bt=[ft],kt={key:1},vt=e("i",{class:"fa-solid fa-caret-up"},null,-1),gt=[vt],$t={key:0},yt=e("i",{class:"fa-solid fa-caret-down"},null,-1),wt=[yt],Ct={key:1},Ot=e("i",{class:"fa-solid fa-caret-up"},null,-1),Lt=[Ot],jt={key:0},Dt=e("i",{class:"fa-solid fa-caret-down"},null,-1),At=[Dt],It={key:1},Vt=e("i",{class:"fa-solid fa-caret-up"},null,-1),Et=[Vt],Mt=e("th",{scope:"col",class:"text-center"},"Действие",-1),Pt={scope:"row"},Tt=["onClick"],zt={class:"text-center"},Bt={class:"text-center"},St={class:"text-center"},Ut={class:"text-center"},Ft={class:"text-center"},Nt={class:"text-center"},Rt={class:"text-center"},Kt={class:"dropdown"},qt=e("button",{class:"btn btn-link",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-bars"})],-1),Gt={class:"dropdown-menu"},Zt=["onClick"],Ht=e("i",{class:"fa-solid fa-pen mr-2"},null,-1),Jt=["onClick"],Qt=e("i",{class:"fa-solid fa-trash-can mr-2"},null,-1),Wt={key:0,class:"alert alert-success",role:"alert"},Xt=e("h4",{class:"alert-heading"},"Детали заказа",-1),Yt=e("p",null,"К сожалению,в данном заказе нет деталей заказа",-1),xt=[Xt,Yt],te={key:1,class:"row mb-3"},ee={class:"col-12"},se={props:["orderId"],data(){return{sort:{column:null,direction:"desc"},search:null,current_page:0,paginate_object:null,items:[{id:null,title:null,price:0,variants:[]}]}},computed:{...v(["getOrderDetails","getOrderDetailsPaginateObject"])},mounted(){this.loadOrderDetails()},methods:{sortAndLoad(a){this.sort.column=a,this.sort.direction=this.sort.direction==="desc"?"asc":"desc",this.loadOrderDetails(this.current_page)},loadOrderDetails(a=0){this.current_page=a,this.$store.dispatch("loadOrderDetails",{dataObject:{order_id:this.orderId,search:this.search,order:this.sort.column,direction:this.sort.direction},page:this.current_page}).then(t=>{this.items=this.getOrderDetails,this.paginate_object=this.getOrderDetailsPaginateObject}).catch(()=>{this.loading=!1})},selectItem(a){this.$emit("select",a)},duplicateItem(a){this.$store.dispatch("duplicateOrderDetail",{orderDetailId:a}).then(()=>{this.sortAndLoad("id")})},removeItem(a){this.$store.dispatch("removeOrderDetail",{orderDetailId:a}).then(()=>{this.sortAndLoad("id")})}}},oe=Object.assign(se,{__name:"OrderDetailTable",setup(a){return(t,l)=>(o(),n(h,null,[e("form",I,[e("div",V,[e("div",E,[e("div",M,[_(e("input",{type:"search","onUpdate:modelValue":l[0]||(l[0]=s=>t.search=s),class:"form-control",id:"search-orderDetails"},null,512),[[g,t.search]]),P]),e("button",{type:"button",onClick:l[1]||(l[1]=s=>t.sortAndLoad("id")),class:"btn btn-outline-secondary rounded-0"},z)])])]),e("div",B,[t.items.length>0?(o(),n("table",S,[e("thead",null,[e("tr",null,[e("th",{scope:"col",class:"cursor-pointer",onClick:l[2]||(l[2]=s=>t.sortAndLoad("id"))},[i("# "),t.sort.direction==="desc"&&t.sort.column==="id"?(o(),n("span",U,N)):d("",!0),t.sort.direction==="asc"&&t.sort.column==="id"?(o(),n("span",R,q)):d("",!0)]),e("th",{scope:"col",class:"text-center cursor-pointer",onClick:l[3]||(l[3]=s=>t.sortAndLoad("door_type"))},[i("Тип двери "),t.sort.direction==="desc"&&t.sort.column==="door_type"?(o(),n("span",G,H)):d("",!0),t.sort.direction==="asc"&&t.sort.column==="door_type"?(o(),n("span",J,W)):d("",!0)]),e("th",{scope:"col",class:"text-center cursor-pointer",onClick:l[4]||(l[4]=s=>t.sortAndLoad("count"))},[i("Кол-во "),t.sort.direction==="desc"&&t.sort.column==="count"?(o(),n("span",X,x)):d("",!0),t.sort.direction==="asc"&&t.sort.column==="count"?(o(),n("span",tt,st)):d("",!0)]),e("th",{scope:"col",class:"text-center cursor-pointer",onClick:l[5]||(l[5]=s=>t.sortAndLoad("price"))},[i("Цена "),t.sort.direction==="desc"&&t.sort.column==="price"?(o(),n("span",ot,lt)):d("",!0),t.sort.direction==="asc"&&t.sort.column==="price"?(o(),n("span",dt,it)):d("",!0)]),e("th",{scope:"col",class:"text-center cursor-pointer",onClick:l[6]||(l[6]=s=>t.sortAndLoad("comment"))},[i("Комментарий "),t.sort.direction==="desc"&&t.sort.column==="comment"?(o(),n("span",rt,ut)):d("",!0),t.sort.direction==="asc"&&t.sort.column==="comment"?(o(),n("span",ht,pt)):d("",!0)]),e("th",{scope:"col",class:"text-center cursor-pointer",onClick:l[7]||(l[7]=s=>t.sortAndLoad("purpose"))},[i("Назначение двери "),t.sort.direction==="desc"&&t.sort.column==="purpose"?(o(),n("span",mt,bt)):d("",!0),t.sort.direction==="asc"&&t.sort.column==="purpose"?(o(),n("span",kt,gt)):d("",!0)]),e("th",{scope:"col",class:"text-center cursor-pointer",onClick:l[8]||(l[8]=s=>t.sortAndLoad("door"))},[i("Параметры двери "),t.sort.direction==="desc"&&t.sort.column==="door"?(o(),n("span",$t,wt)):d("",!0),t.sort.direction==="asc"&&t.sort.column==="door"?(o(),n("span",Ct,Lt)):d("",!0)]),e("th",{scope:"col",class:"text-center cursor-pointer",onClick:l[9]||(l[9]=s=>t.sortAndLoad("updated_at"))},[i(" Дата изменения "),t.sort.direction==="desc"&&t.sort.column==="updated_at"?(o(),n("span",jt,At)):d("",!0),t.sort.direction==="asc"&&t.sort.column==="updated_at"?(o(),n("span",It,Et)):d("",!0)]),Mt])]),e("tbody",null,[(o(!0),n(h,null,m(t.items,(s,u)=>(o(),n("tr",null,[e("th",Pt,r(s.id||u),1),e("td",{class:"text-center",onClick:c=>t.selectItem(s)},r(s.door_type||"-"),9,Tt),e("td",zt,r(s.count||0),1),e("td",Bt,r(s.price||0),1),e("td",St,r(s.comment||"-"),1),e("td",Ut,r(s.purpose||"-"),1),e("td",Ft,r(s.door||"-"),1),e("td",Nt,r(s.updated_at||"-"),1),e("td",Rt,[e("div",Kt,[qt,e("ul",Gt,[e("li",null,[e("a",{class:"dropdown-item",onClick:c=>t.selectItem(s),href:"javascript:void(0)"},[Ht,i("Редактировать")],8,Zt)]),e("li",null,[e("a",{class:"dropdown-item text-danger",onClick:c=>t.removeItem(s.id),href:"javascript:void(0)"},[Qt,i("Удалить")],8,Jt)])])])])]))),256))])])):d("",!0)]),t.items.length===0?(o(),n("div",Wt,xt)):d("",!0),t.items.length>0?(o(),n("div",te,[e("div",ee,[t.paginate_object?(o(),p(y,{key:0,onPagination_page:t.loadOrderDetails,pagination:t.paginate_object},null,8,["onPagination_page","pagination"])):d("",!0)])])):d("",!0)],64))}}),ne={class:"row"},le={class:"col-12"},de={class:"input-group mb-3"},ae={class:"form-floating"},ie=e("label",{for:"search-orders"},"Поиск по заказам",-1),re={class:"dropdown"},ce=e("button",{class:"btn btn-outline-secondary rounded-0 h-100",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-up-right-and-down-left-from-center"})],-1),ue={class:"dropdown-menu"},he=e("i",{class:"fa-solid fa-magnifying-glass"},null,-1),_e=e("i",{class:"fa-regular fa-file-excel"},null,-1),pe={class:"col-12"},me={class:"action-row"},fe=["onClick"],be=["onClick"],ke={class:"col-12"},ve=["onClick"],ge=e("i",{class:"fa-solid fa-retweet"},null,-1),$e=[ge],ye=e("i",{class:"fa-solid fa-xmark"},null,-1),we=[ye],Ce={class:"my-3"},Oe=["onClick"],Le=e("i",{class:"fa-solid fa-xmark"},null,-1),je=[Le],De={class:"d-flex flex-wrap"},Ae={key:1,class:"my-2 small italic"},Ie={class:"d-flex scrollable-area"},Ve={key:0,class:"table"},Ee={key:0},Me=e("i",{class:"fa-solid fa-caret-down"},null,-1),Pe=[Me],Te={key:1},ze=e("i",{class:"fa-solid fa-caret-up"},null,-1),Be=[ze],Se=e("th",{scope:"col",class:"text-center"},"Действие",-1),Ue={key:0},Fe=e("i",{class:"fa-solid fa-caret-down"},null,-1),Ne=[Fe],Re={key:1},Ke=e("i",{class:"fa-solid fa-caret-up"},null,-1),qe=[Ke],Ge={key:0},Ze=e("i",{class:"fa-solid fa-caret-down"},null,-1),He=[Ze],Je={key:1},Qe=e("i",{class:"fa-solid fa-caret-up"},null,-1),We=[Qe],Xe={key:0},Ye=e("i",{class:"fa-solid fa-caret-down"},null,-1),xe=[Ye],ts={key:1},es=e("i",{class:"fa-solid fa-caret-up"},null,-1),ss=[es],os={key:0},ns=e("i",{class:"fa-solid fa-caret-down"},null,-1),ls=[ns],ds={key:1},as=e("i",{class:"fa-solid fa-caret-up"},null,-1),is=[as],rs={key:0},cs=e("i",{class:"fa-solid fa-caret-down"},null,-1),us=[cs],hs={key:1},_s=e("i",{class:"fa-solid fa-caret-up"},null,-1),ps=[_s],ms={key:0},fs=e("i",{class:"fa-solid fa-caret-down"},null,-1),bs=[fs],ks={key:1},vs=e("i",{class:"fa-solid fa-caret-up"},null,-1),gs=[vs],$s={key:0},ys=e("i",{class:"fa-solid fa-caret-down"},null,-1),ws=[ys],Cs={key:1},Os=e("i",{class:"fa-solid fa-caret-up"},null,-1),Ls=[Os],js={key:0},Ds=e("i",{class:"fa-solid fa-caret-down"},null,-1),As=[Ds],Is={key:1},Vs=e("i",{class:"fa-solid fa-caret-up"},null,-1),Es=[Vs],Ms={key:0},Ps=e("i",{class:"fa-solid fa-caret-down"},null,-1),Ts=[Ps],zs={key:1},Bs=e("i",{class:"fa-solid fa-caret-up"},null,-1),Ss=[Bs],Us={key:0},Fs=e("i",{class:"fa-solid fa-caret-down"},null,-1),Ns=[Fs],Rs={key:1},Ks=e("i",{class:"fa-solid fa-caret-up"},null,-1),qs=[Ks],Gs={key:0},Zs=e("i",{class:"fa-solid fa-caret-down"},null,-1),Hs=[Zs],Js={key:1},Qs=e("i",{class:"fa-solid fa-caret-up"},null,-1),Ws=[Qs],Xs={key:0},Ys=e("i",{class:"fa-solid fa-caret-down"},null,-1),xs=[Ys],to={key:1},eo=e("i",{class:"fa-solid fa-caret-up"},null,-1),so=[eo],oo={key:0},no=e("i",{class:"fa-solid fa-caret-down"},null,-1),lo=[no],ao={key:1},io=e("i",{class:"fa-solid fa-caret-up"},null,-1),ro=[io],co={scope:"row"},uo={class:"form-check"},ho=["value","id"],_o=["for"],po={class:"text-center"},mo={class:"dropdown"},fo=e("button",{class:"btn btn-link",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-bars"})],-1),bo={class:"dropdown-menu"},ko=["href"],vo=e("i",{class:"fa-regular fa-file-excel mr-2"},null,-1),go=["onClick"],$o=e("i",{class:"fa-solid fa-file-signature mr-2"},null,-1),yo=["onClick"],wo=e("i",{class:"fa-solid fa-pen mr-2"},null,-1),Co=["onClick"],Oo=e("i",{class:"fa-solid fa-trash-can mr-2"},null,-1),Lo=["onClick"],jo=["onClick"],Do={key:2,class:"text-center"},Ao={key:3,class:"text-center"},Io={key:4,class:"text-center"},Vo={key:0},Eo={key:1},Mo={key:5,class:"text-center"},Po={key:6,class:"text-center"},To={key:7,class:"text-center"},zo={key:8,class:"text-center"},Bo={key:9,class:"text-center"},So={key:10,class:"text-center"},Uo={key:11,class:"text-center"},Fo={key:12,class:"text-center"},No={key:2,class:"alert alert-success rounded-0",role:"alert"},Ro=e("h4",{class:"alert-heading"},"Заказы",-1),Ko=e("p",null,"К сожалению, раздел заказов пуст.",-1),qo=[Ro,Ko],Go={key:3,class:"row mb-3"},Zo={class:"col-12"},Ho={class:"modal fade",id:"order-details",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},Jo={class:"modal-dialog modal-fullscreen"},Qo={class:"modal-content"},Wo=e("div",{class:"modal-header"},[e("h1",{class:"modal-title fs-5",id:"exampleModalLabel"},"Детали заказа"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},[e("i",{class:"fa-solid fa-xmark"})])],-1),Xo={class:"modal-body"},Yo=e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-outline-secondary rounded-0","data-bs-dismiss":"modal"},"Закрыть ")],-1),xo={class:"modal fade",id:"confirm-modal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},tn={class:"modal-dialog modal-dialog-centered"},en={class:"modal-content rounded-0"},sn={class:"modal-body"},on=e("div",{class:"d-flex justify-center p-3"},[e("img",{src:"/images/logo.png",style:{width:"100px"},alt:""})],-1),nn={class:"font-bold text-center py-3"},ln={class:"text-center pb-3"},dn={class:"row mb-3"},an={class:"col-md-6 d-flex justify-center"},rn={class:"form-check"},cn=e("label",{class:"form-check-label",for:"work-with-nds"}," Работаю с НДС ",-1),un={class:"col-md-6 d-flex justify-center"},hn={class:"form-check"},_n=e("label",{class:"form-check-label",for:"work-without-nds"}," Работаю без НДС ",-1),pn={class:"row"},mn={class:"col-6"},fn={class:"col-6"},bn={class:"modal fade",id:"order-editor-modal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},kn={class:"modal-dialog modal-xl"},vn={class:"modal-content rounded-0"},gn={class:"modal-body"},$n={components:{VueDatePicker:w},data(){return{editor_modal:null,selected_orders:[],selected_item:null,table:{contract_number:{title:"Номер договора",value:!0},contract_date:{title:"Дата договора",value:!0},completion_at:{title:"Дата закрытия",value:!0},client_id:{title:"Идентификатор клиента",value:!0},status:{title:"Статус",value:!0},source:{title:"Источник",value:!0},contact_person:{title:"Контактное лицо",value:!0},phone:{title:"Номер телефона",value:!0},organizational_form:{title:"Организационная форма",value:!0},contract_amount:{title:"Сумма договора",value:!0},paid:{title:"Оплачено",value:!0},debt:{title:"Остаток",value:!0},profit:{title:"Доход",value:!0}},sort:{column:null,date:null,direction:"desc"},selected_order:null,order_detail_modal:null,order_status:["Новый заказ","В работе","Завершен"],search:null,current_page:0,paginate_object:null,loading:!1,confirm_modal:null,confirm:{title:null,message:null,work_with_nds:1,item:null},items:[{id:null,contract_number:null,contract_date:null,completion_at:null,client_id:null,status:null,source:null,contact_person:null,phone:null,organizational_form:null,contract_amount:null,paid:null,debt:null,profit:null}]}},computed:{...v(["getOrders","getOrdersPaginateObject"])},mounted(){this.loadOrders(),this.order_detail_modal=new bootstrap.Modal(document.getElementById("order-details"),{}),this.confirm_modal=new bootstrap.Modal(document.getElementById("confirm-modal"),{}),this.editor_modal=new bootstrap.Modal(document.getElementById("order-editor-modal"),{})},methods:{selectOrder(a){let t=this.selected_orders.findIndex(l=>l===a);t===-1?this.selected_orders.push(a):this.selected_orders.splice(t,1)},resetColumns(){Object.keys(this.table).forEach(a=>{this.table[a].value=!0})},changeColumns(a){a?this.table[a].value=!this.table[a].value:Object.keys(this.table).forEach(t=>{this.table[t].value=!this.table[t].value})},openConfirmModal(a,t,l){this.confirm.title=a||null,this.confirm.message=t||null,this.confirm.item=l||null,this.confirm_modal.show()},sortAndLoad(a){this.sort.column=a,this.sort.direction=this.sort.direction==="desc"?"asc":"desc",this.loadOrders(this.current_page)},downloadSelectedOrders(){let a=this.sort,t=(a.date||[]).length>0?new Date(a.date[0]).getTime():null,l=(a.date||[]).length>1?new Date(a.date[1]).getTime():null,s=`/orders/download-filtered-orders?order=id&ids=${this.selected_orders.join(",")}&type=multiply`;t&&l&&(s+=`&df=${t}&dt=${l}`),this.search&&(s+=`&search=${this.search||null}`),window.open(s,"_blank").focus()},filteredDownload(){let a=this.sort,t=(a.date||[]).length>0?new Date(a.date[0]).getTime():null,l=(a.date||[]).length>1?new Date(a.date[1]).getTime():null,s="/orders/download-filtered-orders?order=id";t&&l&&(s+=`&df=${t}&dt=${l}`),this.search&&(s+=`&search=${this.search||null}`),window.open(s,"_blank").focus()},downloadDocument(a){window.open(`/orders/download-contract?c=${a.client_id}&o=${a.id}`,"_blank").focus(),this.confirm_modal.hide()},loadOrders(a=0){this.current_page=a;let t=this.sort,l=(t.date||[]).length>0?t.date[0]:null,s=(t.date||[]).length>1?t.date[1]:null;this.$store.dispatch("loadOrders",{dataObject:{search:this.search,order:this.sort.column,direction:this.sort.direction,df:l||null,dt:s||null},page:this.current_page}).then(u=>{this.items=this.getOrders,this.paginate_object=this.getOrdersPaginateObject}).catch(()=>{this.loading=!1})},selectItemForEdit(a){if(a==null){this.selected_item=null,this.editor_modal.hide();return}this.selected_item=null,this.$nextTick(()=>{this.selected_item=a,this.editor_modal.show()})},selectItem(a){this.loading=!0,this.selected_order=a,this.$nextTick(()=>{this.loading=!1,this.order_detail_modal.show()})},duplicateItem(a){this.$store.dispatch("duplicateOrder",{materialId:a}).then(()=>{this.sortAndLoad("id")})},removeItem(a){this.$store.dispatch("removeOrder",{materialId:a}).then(()=>{this.sortAndLoad("id")})}}},yn=Object.assign($n,{__name:"OrderTable",setup(a){return(t,l)=>(o(),n(h,null,[e("div",ne,[e("div",le,[e("div",de,[e("div",ae,[_(e("input",{type:"search","onUpdate:modelValue":l[0]||(l[0]=s=>t.search=s),onKeydown:l[1]||(l[1]=O(s=>t.sortAndLoad("id"),["enter"])),class:"form-control",id:"search-orders"},null,544),[[g,t.search]]),ie]),e("div",re,[ce,e("ul",ue,[e("li",null,[e("a",{class:"dropdown-item",href:"javascript:void(0)",onClick:l[2]||(l[2]=s=>t.sortAndLoad("id"))},[he,i(" Искать")])]),e("li",null,[e("a",{class:"dropdown-item",onClick:l[3]||(l[3]=(...s)=>t.filteredDownload&&t.filteredDownload(...s)),href:"javascript:void(0)"},[_e,i(" Скачать в Excel ")])])])])])]),e("div",pe,[f($(w),{class:"rounded-0",locale:"ru",range:"","multi-calendars":"",modelValue:t.sort.date,"onUpdate:modelValue":l[4]||(l[4]=s=>t.sort.date=s)},{"action-row":b(({internalModelValue:s,selectDate:u,closePicker:c})=>[e("div",me,[e("button",{class:"btn btn-dark rounded-0 mr-2",onClick:u},"Выбрать",8,fe),e("button",{class:"btn btn-outline-secondary rounded-0",onClick:c},"Закрыть",8,be)])]),_:1},8,["modelValue"])]),e("div",ke,[(o(!0),n(h,null,m(Object.keys(t.table),s=>(o(),n("span",{class:L(["badge mr-1 rounded-0 cursor-pointer",{"bg-dark":t.table[s].value===!0,"bg-secondary":t.table[s].value===!1}]),onClick:u=>t.changeColumns(s)},r(t.table[s].title||"-"),11,ve))),256)),e("span",{onClick:l[5]||(l[5]=s=>t.changeColumns(null)),class:"badge mr-1 bg-danger rounded-0 cursor-pointer"},$e),e("span",{onClick:l[6]||(l[6]=(...s)=>t.resetColumns&&t.resetColumns(...s)),class:"badge mr-1 bg-secondary rounded-0 cursor-pointer"},we)])]),t.selected_orders.length>0?(o(),n(h,{key:0},[e("p",Ce,[i("Выбрано "),e("span",null,"("+r(t.selected_orders.length)+")",1),i(" элементов: "),(o(!0),n(h,null,m(t.selected_orders,s=>(o(),n("span",{onClick:u=>t.selectOrder(s),class:"badge mr-1 bg-dark rounded-0 cursor-pointer"},r(s),9,Oe))),256)),e("span",{onClick:l[7]||(l[7]=s=>t.selected_orders=[]),class:"badge mr-1 bg-secondary rounded-0 cursor-pointer"},je)]),e("div",De,[e("button",{onClick:l[8]||(l[8]=(...s)=>t.downloadSelectedOrders&&t.downloadSelectedOrders(...s)),type:"button",class:"btn btn-dark rounded-0 mr-2"},"Скачать эксель")])],64)):d("",!0),t.paginate_object?(o(),n("p",Ae,[i("Найдено результатов "),e("strong",null,r(t.paginate_object.meta.total),1)])):d("",!0),e("div",Ie,[t.items.length>0?(o(),n("table",Ve,[e("thead",null,[e("tr",null,[e("th",{scope:"col",class:"cursor-pointer",onClick:l[9]||(l[9]=s=>t.sortAndLoad("id"))},[i("# "),t.sort.direction==="desc"&&t.sort.column==="id"?(o(),n("span",Ee,Pe)):d("",!0),t.sort.direction==="asc"&&t.sort.column==="id"?(o(),n("span",Te,Be)):d("",!0)]),Se,t.table.contract_number.value?(o(),n("th",{key:0,scope:"col",class:"text-center cursor-pointer",onClick:l[10]||(l[10]=s=>t.sortAndLoad("contract_number"))},[i("Номер договора "),t.sort.direction==="desc"&&t.sort.column==="contract_number"?(o(),n("span",Ue,Ne)):d("",!0),t.sort.direction==="asc"&&t.sort.column==="contract_number"?(o(),n("span",Re,qe)):d("",!0)])):d("",!0),t.table.contract_date.value?(o(),n("th",{key:1,scope:"col",class:"text-center cursor-pointer",onClick:l[11]||(l[11]=s=>t.sortAndLoad("contract_date"))},[i("Дата договора "),t.sort.direction==="desc"&&t.sort.column==="contract_date"?(o(),n("span",Ge,He)):d("",!0),t.sort.direction==="asc"&&t.sort.column==="contract_date"?(o(),n("span",Je,We)):d("",!0)])):d("",!0),t.table.completion_at.value?(o(),n("th",{key:2,scope:"col",class:"text-center cursor-pointer",onClick:l[12]||(l[12]=s=>t.sortAndLoad("completion_at"))},[i("Дата закрытия "),t.sort.direction==="desc"&&t.sort.column==="completion_at"?(o(),n("span",Xe,xe)):d("",!0),t.sort.direction==="asc"&&t.sort.column==="completion_at"?(o(),n("span",ts,ss)):d("",!0)])):d("",!0),t.table.client_id.value?(o(),n("th",{key:3,scope:"col",class:"text-center cursor-pointer",onClick:l[13]||(l[13]=s=>t.sortAndLoad("client_id"))},[i("Клиент "),t.sort.direction==="desc"&&t.sort.column==="client_id"?(o(),n("span",os,ls)):d("",!0),t.sort.direction==="asc"&&t.sort.column==="client_id"?(o(),n("span",ds,is)):d("",!0)])):d("",!0),t.table.status.value?(o(),n("th",{key:4,scope:"col",class:"text-center cursor-pointer",onClick:l[14]||(l[14]=s=>t.sortAndLoad("status"))},[i("Статус заказа "),t.sort.direction==="desc"&&t.sort.column==="status"?(o(),n("span",rs,us)):d("",!0),t.sort.direction==="asc"&&t.sort.column==="status"?(o(),n("span",hs,ps)):d("",!0)])):d("",!0),t.table.source.value?(o(),n("th",{key:5,scope:"col",class:"text-center cursor-pointer",onClick:l[15]||(l[15]=s=>t.sortAndLoad("source"))},[i("Источник "),t.sort.direction==="desc"&&t.sort.column==="source"?(o(),n("span",ms,bs)):d("",!0),t.sort.direction==="asc"&&t.sort.column==="source"?(o(),n("span",ks,gs)):d("",!0)])):d("",!0),t.table.contact_person.value?(o(),n("th",{key:6,scope:"col",class:"text-center cursor-pointer",onClick:l[16]||(l[16]=s=>t.sortAndLoad("contact_person"))},[i("Контактное лицо "),t.sort.direction==="desc"&&t.sort.column==="contact_person"?(o(),n("span",$s,ws)):d("",!0),t.sort.direction==="asc"&&t.sort.column==="contact_person"?(o(),n("span",Cs,Ls)):d("",!0)])):d("",!0),t.table.phone.value?(o(),n("th",{key:7,scope:"col",class:"text-center cursor-pointer",onClick:l[17]||(l[17]=s=>t.sortAndLoad("phone"))},[i("Телефон "),t.sort.direction==="desc"&&t.sort.column==="phone"?(o(),n("span",js,As)):d("",!0),t.sort.direction==="asc"&&t.sort.column==="phone"?(o(),n("span",Is,Es)):d("",!0)])):d("",!0),t.table.organizational_form.value?(o(),n("th",{key:8,scope:"col",class:"text-center cursor-pointer",onClick:l[18]||(l[18]=s=>t.sortAndLoad("organizational_form"))},[i("На ип\\ооо "),t.sort.direction==="desc"&&t.sort.column==="organizational_form"?(o(),n("span",Ms,Ts)):d("",!0),t.sort.direction==="asc"&&t.sort.column==="organizational_form"?(o(),n("span",zs,Ss)):d("",!0)])):d("",!0),t.table.contract_amount.value?(o(),n("th",{key:9,scope:"col",class:"text-center cursor-pointer",onClick:l[19]||(l[19]=s=>t.sortAndLoad("contract_amount"))},[i("Сумма договора "),t.sort.direction==="desc"&&t.sort.column==="contract_amount"?(o(),n("span",Us,Ns)):d("",!0),t.sort.direction==="asc"&&t.sort.column==="contract_amount"?(o(),n("span",Rs,qs)):d("",!0)])):d("",!0),t.table.paid.value?(o(),n("th",{key:10,scope:"col",class:"text-center cursor-pointer",onClick:l[20]||(l[20]=s=>t.sortAndLoad("paid"))},[i("Оплачено "),t.sort.direction==="desc"&&t.sort.column==="paid"?(o(),n("span",Gs,Hs)):d("",!0),t.sort.direction==="asc"&&t.sort.column==="paid"?(o(),n("span",Js,Ws)):d("",!0)])):d("",!0),t.table.debt.value?(o(),n("th",{key:11,scope:"col",class:"text-center cursor-pointer",onClick:l[21]||(l[21]=s=>t.sortAndLoad("debt"))},[i("Задолженность "),t.sort.direction==="desc"&&t.sort.column==="debt"?(o(),n("span",Xs,xs)):d("",!0),t.sort.direction==="asc"&&t.sort.column==="debt"?(o(),n("span",to,so)):d("",!0)])):d("",!0),t.table.profit.value?(o(),n("th",{key:12,scope:"col",class:"text-center cursor-pointer",onClick:l[22]||(l[22]=s=>t.sortAndLoad("profit"))},[i("Прибыль "),t.sort.direction==="desc"&&t.sort.column==="profit"?(o(),n("span",oo,lo)):d("",!0),t.sort.direction==="asc"&&t.sort.column==="profit"?(o(),n("span",ao,ro)):d("",!0)])):d("",!0)])]),e("tbody",null,[(o(!0),n(h,null,m(t.items,(s,u)=>(o(),n("tr",null,[e("th",co,[e("div",uo,[_(e("input",{value:s.id,"onUpdate:modelValue":l[23]||(l[23]=c=>t.selected_orders=c),class:"form-check-input",type:"checkbox",id:"order-check-"+u},null,8,ho),[[j,t.selected_orders]]),e("label",{class:"form-check-label",for:"order-check-"+u},r(s.id||u),9,_o)])]),e("td",po,[e("div",mo,[fo,e("ul",bo,[e("li",null,[e("a",{class:"dropdown-item",target:"_blank",href:"/orders/download-order-excel/"+s.id},[vo,i("Скачать Excel-документ по заказу")],8,ko)]),e("li",null,[e("a",{class:"dropdown-item",onClick:c=>t.downloadDocument(s),href:"javascript:void(0)"},[$o,i("Скачать договор")],8,go)]),e("li",null,[e("a",{class:"dropdown-item",onClick:c=>t.selectItemForEdit(s),href:"javascript:void(0)"},[wo,i("Редактор заказа")],8,yo)]),e("li",null,[e("a",{class:"dropdown-item text-danger",onClick:c=>t.removeItem(s.id),href:"javascript:void(0)"},[Oo,i("Удалить")],8,Co)])])])]),t.table.contract_number.value?(o(),n("td",{key:0,class:"text-center",onClick:c=>t.selectItem(s)},r(s.contract_number||"-"),9,Lo)):d("",!0),t.table.contract_date.value?(o(),n("td",{key:1,class:"text-center",onClick:c=>t.selectItem(s)},r(s.contract_date||"-"),9,jo)):d("",!0),t.table.completion_at.value?(o(),n("td",Do,r(s.completion_at||"-"),1)):d("",!0),t.table.client_id.value?(o(),n("td",Ao,r(s.client_id||"-"),1)):d("",!0),t.table.status.value?(o(),n("td",Io,[(s.status||0)<=2?(o(),n("span",Vo,r(t.order_status[s.status]),1)):(o(),n("span",Eo,"Не указан"))])):d("",!0),t.table.source.value?(o(),n("td",Mo,r(s.source||"-"),1)):d("",!0),t.table.contact_person.value?(o(),n("td",Po,r(s.contact_person||"-"),1)):d("",!0),t.table.phone.value?(o(),n("td",To,r(s.phone||"-"),1)):d("",!0),t.table.organizational_form.value?(o(),n("td",zo,r(s.organizational_form||"-"),1)):d("",!0),t.table.contract_amount.value?(o(),n("td",Bo,r(s.contract_amount||0),1)):d("",!0),t.table.paid.value?(o(),n("td",So,r(s.paid||0),1)):d("",!0),t.table.debt.value?(o(),n("td",Uo,r(s.debt||0),1)):d("",!0),t.table.profit.value?(o(),n("td",Fo,r(s.profit||0),1)):d("",!0)]))),256))])])):d("",!0)]),t.items.length===0?(o(),n("div",No,qo)):d("",!0),t.items.length>0?(o(),n("div",Go,[e("div",Zo,[t.paginate_object?(o(),p(y,{key:0,onPagination_page:t.loadOrders,pagination:t.paginate_object},null,8,["onPagination_page","pagination"])):d("",!0)])])):d("",!0),e("div",Ho,[e("div",Jo,[e("div",Qo,[Wo,e("div",Xo,[t.selected_order&&!t.loading?(o(),p(oe,{key:0,"order-id":t.selected_order.id},null,8,["order-id"])):d("",!0)]),Yo])])]),e("div",xo,[e("div",tn,[e("div",en,[e("div",sn,[on,e("h3",nn,r(t.confirm.title||"-"),1),e("p",ln,r(t.confirm.message||"-"),1),e("div",dn,[e("div",an,[e("div",rn,[_(e("input",{class:"form-check-input",type:"radio",value:"1","onUpdate:modelValue":l[24]||(l[24]=s=>t.confirm.work_with_nds=s),name:"flexRadioDefault",id:"work-with-nds"},null,512),[[k,t.confirm.work_with_nds]]),cn])]),e("div",un,[e("div",hn,[_(e("input",{class:"form-check-input",type:"radio",value:"0",name:"flexRadioDefault","onUpdate:modelValue":l[25]||(l[25]=s=>t.confirm.work_with_nds=s),id:"work-without-nds"},null,512),[[k,t.confirm.work_with_nds]]),_n])])]),e("div",pn,[e("div",mn,[e("button",{class:"btn btn-dark rounded-0 w-100",type:"button",onClick:l[26]||(l[26]=(...s)=>t.downloadDocument&&t.downloadDocument(...s))},"Скачать договор ")]),e("div",fn,[e("button",{class:"btn btn-outline-secondary rounded-0 w-100",onClick:l[27]||(l[27]=s=>t.confirm_modal.hide())}," Закрыть ")])])])])])]),e("div",bn,[e("div",kn,[e("div",vn,[e("div",gn,[t.selected_item?(o(),p(A,{key:0,"can-edit":!0,doors:t.selected_item.details,order:t.selected_item},null,8,["doors","order"])):d("",!0)])])])])],64))}}),wn=e("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"},"Заказы",-1),Cn={class:"py-12"},On={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},Ln={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},jn={class:"p-6 text-gray-900"},Dn={data(){return{loading:!1,selectedOrder:null}},methods:{selectOrder(a){this.selectedOrder=a,this.loading=!0,this.$nextTick(()=>{this.loading=!1})},callbackOrderForm(){this.loading=!0,this.selectedOrder=null,this.$nextTick(()=>{this.loading=!1})}}},Nn=Object.assign(Dn,{__name:"OrdersPage",setup(a){return(t,l)=>(o(),n(h,null,[f($(D),{title:"Заказы"}),f(C,null,{header:b(()=>[wn]),default:b(()=>[e("div",Cn,[e("div",On,[e("div",Ln,[e("div",jn,[t.loading?d("",!0):(o(),p(yn,{key:0,onSelect:t.selectOrder},null,8,["onSelect"]))])])])])]),_:1})],64))}});export{Nn as default};
