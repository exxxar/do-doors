import{_ as w}from"./AuthenticatedLayout-C4PMsOFn.js";import{o as s,c as o,b as e,g as p,v as m,h as $,f as d,F as u,r as k,e as l,j as V,t as h,m as D,d as f,k as C,a as b,u as j,w as g,Z as F}from"./app-B4-K4w0I.js";import{P as I}from"./Pagination-BHadVyzS.js";import{_ as L}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ApplicationLogo-CVX5PyU6.js";import"./IndividualDataForm-DONMgE2Z.js";import"./vue-the-mask-BrpEz10W.js";const A={props:["item"],data(){return{messages:[],loading:!1,form:{id:null,title:null,need_percent_price:!1,price:{wholesale:0,dealer:0,retail:0,cost:0}}}},computed:{needClearForm(){return this.form.id||this.form.title||this.form.price}},mounted(){this.item&&this.$nextTick(()=>{this.form={id:this.item.id||null,title:this.item.title||null,need_percent_price:this.item.need_percent_price||!1,price:this.item.price||{wholesale:0,dealer:0,retail:0,cost:0}}})},methods:{alert(n){this.messages.push(n)},resetForm(){this.form.id=null,this.form.title=null,this.form.need_percent_price=!1,this.form.price={wholesale:0,dealer:0,retail:0,cost:0},this.$emit("callback")},removeMessage(n){this.messages.splice(n,1)},submit(){let n=new FormData;Object.keys(this.form).forEach(t=>{const r=this.form[t]||"";typeof r=="object"?n.append(t,JSON.stringify(r)):n.append(t,r)}),this.$store.dispatch("storeDoorVariant",{doorVariantForm:n}).then(t=>{this.$emit("callback"),this.resetForm()}).catch(t=>{})}}},M={class:"form-floating mb-3"},O=e("label",{for:"door-variant-title"},"Наименование варианта двери",-1),P={class:"form-check form-switch mb-3"},T=e("label",{class:"form-check-label",for:"is-base"}," Использовать процент от базовой цены ",-1),U={class:"card rounded-0 mb-3 border-black"},N=e("div",{class:"card-header bg-dark text-white rounded-0"},[e("h6",null,"Настройка цены")],-1),S={class:"card-body"},q={class:"row"},B={class:"col-6"},E={class:"form-floating mb-3"},G={for:"price-wholesale"},J={key:0},Z={key:1},z={class:"col-6"},H={class:"form-floating mb-3"},K={for:"price-retail"},Q={key:0},R={key:1},W={class:"col-6"},X={class:"form-floating"},Y={for:"price-dealer"},x={key:0},ee={key:1},te={class:"col-6"},se={class:"form-floating"},oe={for:"price-cost"},ie={key:0},ne={key:1},re={class:"row"},le={class:"col-12"},ae={class:"alert alert-danger alert-dismissible fade show",role:"alert"},de=e("strong",null,"Внимание!",-1),ce=["onClick"],_e={class:"row mt-5"},he={class:"col-12 d-flex justify-content-center"},pe=["disabled"],me={key:0,class:"fa-regular fa-floppy-disk mr-1"},ue={key:1,class:"spinner-border spinner-border-sm text-success",role:"status"},fe=e("i",{class:"fa-solid fa-xmark mr-1"},null,-1);function be(n,t,r,c,i,_){return s(),o("form",{action:"",onSubmit:t[7]||(t[7]=V((...a)=>_.submit&&_.submit(...a),["prevent"]))},[e("div",M,[p(e("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=a=>i.form.title=a),class:"form-control",id:"door-variant-title",required:""},null,512),[[m,i.form.title]]),O]),e("div",P,[p(e("input",{class:"form-check-input","onUpdate:modelValue":t[1]||(t[1]=a=>i.form.need_percent_price=a),type:"checkbox",role:"switch",id:"is-base"},null,512),[[$,i.form.need_percent_price]]),T]),e("div",U,[N,e("div",S,[e("div",q,[e("div",B,[e("div",E,[p(e("input",{type:"number","onUpdate:modelValue":t[2]||(t[2]=a=>i.form.price.wholesale=a),class:"form-control",id:"price-wholesale",required:""},null,512),[[m,i.form.price.wholesale]]),e("label",G,[d("Опт"),i.form.need_percent_price?(s(),o("span",J,", %")):(s(),o("span",Z,", руб"))])])]),e("div",z,[e("div",H,[p(e("input",{type:"number","onUpdate:modelValue":t[3]||(t[3]=a=>i.form.price.retail=a),class:"form-control",id:"price-retail",required:""},null,512),[[m,i.form.price.retail]]),e("label",K,[d("Розница"),i.form.need_percent_price?(s(),o("span",Q,", %")):(s(),o("span",R,", руб"))])])]),e("div",W,[e("div",X,[p(e("input",{type:"number","onUpdate:modelValue":t[4]||(t[4]=a=>i.form.price.dealer=a),class:"form-control",id:"price-dealer",required:""},null,512),[[m,i.form.price.dealer]]),e("label",Y,[d("Дилер"),i.form.need_percent_price?(s(),o("span",x,", %")):(s(),o("span",ee,", руб"))])])]),e("div",te,[e("div",se,[p(e("input",{type:"number","onUpdate:modelValue":t[5]||(t[5]=a=>i.form.price.cost=a),class:"form-control",id:"price-cost",required:""},null,512),[[m,i.form.price.cost]]),e("label",oe,[d("Себестоимость"),i.form.need_percent_price?(s(),o("span",ie,", %")):(s(),o("span",ne,", руб"))])])])])])]),e("div",re,[e("div",le,[i.messages.length>0?(s(!0),o(u,{key:0},k(i.messages,(a,v)=>(s(),o("div",ae,[de,d(" "+h(a||"Ошибка")+" ",1),e("button",{type:"button",class:"btn-close",onClick:zt=>_.removeMessage(v)},null,8,ce)]))),256)):l("",!0)])]),e("div",_e,[e("div",he,[e("button",{disabled:!_.needClearForm,class:"btn btn-dark rounded-0"},[i.loading?(s(),o("span",ue)):(s(),o("i",me)),d(" Сохранить вариант двери ")],8,pe),_.needClearForm&&!i.loading?(s(),o("button",{key:0,type:"button",onClick:t[6]||(t[6]=(...a)=>_.resetForm&&_.resetForm(...a)),class:"btn btn-outline-secondary rounded-0 ml-2"},[fe,d(" Очистить форму ")])):l("",!0)])])],32)}const y=L(A,[["render",be]]),ge={class:"row"},ke={class:"col-12"},ye={class:"input-group mb-3"},ve={class:"form-floating"},we=e("label",{for:"search-door-variants"},"Поиск по производителям петель",-1),$e=e("i",{class:"fa-solid fa-magnifying-glass"},null,-1),Ve=[$e],De={style:{"overflow-y":"auto"}},Ce={key:0,class:"table"},je={key:0},Fe=e("i",{class:"fa-solid fa-caret-down"},null,-1),Ie=[Fe],Le={key:1},Ae=e("i",{class:"fa-solid fa-caret-up"},null,-1),Me=[Ae],Oe=e("th",{scope:"col",class:"text-center"},"Действие",-1),Pe={key:0},Te=e("i",{class:"fa-solid fa-caret-down"},null,-1),Ue=[Te],Ne={key:1},Se=e("i",{class:"fa-solid fa-caret-up"},null,-1),qe=[Se],Be={key:0},Ee=e("i",{class:"fa-solid fa-caret-down"},null,-1),Ge=[Ee],Je={key:1},Ze=e("i",{class:"fa-solid fa-caret-up"},null,-1),ze=[Ze],He={key:0},Ke=e("i",{class:"fa-solid fa-caret-down"},null,-1),Qe=[Ke],Re={key:1},We=e("i",{class:"fa-solid fa-caret-up"},null,-1),Xe=[We],Ye=C('<table class="w-100"><thead><th style="width:100px;">опт</th><th style="width:100px;">дилер</th><th style="width:100px;">розница</th><th style="width:100px;">себестоимость</th></thead></table>',1),xe={scope:"row"},et={class:"text-center"},tt={class:"dropdown"},st=e("button",{class:"btn btn-link",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-bars"})],-1),ot={class:"dropdown-menu"},it=["onClick"],nt=e("i",{class:"fa-solid fa-pen mr-2"},null,-1),rt=["onClick"],lt=e("i",{class:"fa-solid fa-trash-can mr-2"},null,-1),at=["onClick"],dt={class:"text-center",style:{width:"50px"}},ct={class:"text-center"},_t={class:"w-100"},ht={style:{width:"100px","text-align":"center"}},pt={key:0},mt={key:1},ut={style:{width:"100px","text-align":"center"}},ft={key:0},bt={key:1},gt={style:{width:"100px","text-align":"center"}},kt={key:0},yt={key:1},vt={style:{width:"100px","text-align":"center"}},wt={key:0},$t={key:1},Vt={key:0,class:"alert alert-success",role:"alert"},Dt=e("h4",{class:"alert-heading"},"Варианты дверей",-1),Ct=e("p",null,"К сожалению, раздел Варианты дверей пуст. Вы еще не добавили ни одного варианта дверей, которые можно отобразить на этой странице.",-1),jt=e("hr",null,null,-1),Ft=e("p",{class:"mb-0"},"Воспользуйтесь формой выше и добавьте свой первый вариант дверей",-1),It=[Dt,Ct,jt,Ft],Lt={key:1,class:"row mb-3"},At={class:"col-12"},Mt={class:"modal fade",id:"door-variant-editor-modal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},Ot={class:"modal-dialog modal-lg"},Pt={class:"modal-content rounded-0"},Tt={class:"modal-body"},Ut={data(){return{editor_modal:null,selected_item:null,sort:{column:null,direction:"desc"},search:null,current_page:0,paginate_object:null,items:[{id:null,title:null,price:0}]}},computed:{...D(["getDoorVariants","getDoorVariantsPaginateObject"])},mounted(){this.loadDoorVariants(),this.editor_modal=new bootstrap.Modal(document.getElementById("door-variant-editor-modal"),{})},methods:{sortAndLoad(n){this.sort.column=n,this.sort.direction=this.sort.direction==="desc"?"asc":"desc",this.loadDoorVariants(this.current_page)},loadDoorVariants(n=0){this.current_page=n,this.$store.dispatch("loadDoorVariants",{dataObject:{search:this.search,order:this.sort.column,direction:this.sort.direction},page:this.current_page}).then(t=>{this.items=this.getDoorVariants,this.paginate_object=this.getDoorVariantsPaginateObject}).catch(()=>{this.loading=!1})},selectItem(n){if(n==null){this.selected_item=null,this.editor_modal.hide();return}this.selected_item=null,this.$nextTick(()=>{this.selected_item=n,this.editor_modal.show()})},duplicateItem(n){this.$store.dispatch("duplicateDoorVariant",{doorVariantId:n}).then(()=>{this.sortAndLoad("id")})},removeItem(n){this.$store.dispatch("removeDoorVariant",{doorVariantId:n}).then(()=>{this.sortAndLoad("id")})}}},Nt=Object.assign(Ut,{__name:"DoorVariantTable",setup(n){return(t,r)=>(s(),o(u,null,[e("form",ge,[e("div",ke,[e("div",ye,[e("div",ve,[p(e("input",{type:"search","onUpdate:modelValue":r[0]||(r[0]=c=>t.search=c),class:"form-control",id:"search-door-variants"},null,512),[[m,t.search]]),we]),e("button",{type:"button",onClick:r[1]||(r[1]=c=>t.sortAndLoad("id")),class:"btn btn-outline-secondary rounded-0"},Ve)])])]),e("div",De,[t.items.length>0?(s(),o("table",Ce,[e("thead",null,[e("tr",null,[e("th",{scope:"col",class:"cursor-pointer",onClick:r[2]||(r[2]=c=>t.sortAndLoad("id"))},[d("# "),t.sort.direction==="desc"&&t.sort.column==="id"?(s(),o("span",je,Ie)):l("",!0),t.sort.direction==="asc"&&t.sort.column==="id"?(s(),o("span",Le,Me)):l("",!0)]),Oe,e("th",{scope:"col",class:"text-center cursor-pointer",onClick:r[3]||(r[3]=c=>t.sortAndLoad("title"))},[d("Название "),t.sort.direction==="desc"&&t.sort.column==="title"?(s(),o("span",Pe,Ue)):l("",!0),t.sort.direction==="asc"&&t.sort.column==="title"?(s(),o("span",Ne,qe)):l("",!0)]),e("th",{scope:"col",class:"text-center cursor-pointer",onClick:r[4]||(r[4]=c=>t.sortAndLoad("need_percent_price"))},[d("% "),t.sort.direction==="desc"&&t.sort.column==="need_percent_price"?(s(),o("span",Be,Ge)):l("",!0),t.sort.direction==="asc"&&t.sort.column==="need_percent_price"?(s(),o("span",Je,ze)):l("",!0)]),e("th",{scope:"col",class:"text-center cursor-pointer",onClick:r[5]||(r[5]=c=>t.sortAndLoad("price"))},[d("Цена "),t.sort.direction==="desc"&&t.sort.column==="price"?(s(),o("span",He,Qe)):l("",!0),t.sort.direction==="asc"&&t.sort.column==="price"?(s(),o("span",Re,Xe)):l("",!0),Ye])])]),e("tbody",null,[(s(!0),o(u,null,k(t.items,(c,i)=>(s(),o("tr",null,[e("th",xe,h(c.id||i),1),e("td",et,[e("div",tt,[st,e("ul",ot,[e("li",null,[e("a",{class:"dropdown-item",onClick:_=>t.selectItem(c),href:"javascript:void(0)"},[nt,d("Редактировать")],8,it)]),e("li",null,[e("a",{class:"dropdown-item text-danger",onClick:_=>t.removeItem(c.id),href:"javascript:void(0)"},[lt,d("Удалить")],8,rt)])])])]),e("td",{class:"text-center",onClick:_=>t.selectItem(c)},h(c.title||"-"),9,at),e("td",dt,h(c.need_percent_price?"да":"нет"),1),e("td",ct,[e("table",_t,[e("tbody",null,[e("tr",null,[e("td",ht,[d(h(t.items[i].price.wholesale||0),1),t.items[i].need_percent_price?(s(),o("span",pt,", %")):(s(),o("span",mt,", ₽"))]),e("td",ut,[d(h(t.items[i].price.dealer||0),1),t.items[i].need_percent_price?(s(),o("span",ft,", %")):(s(),o("span",bt,", ₽"))]),e("td",gt,[d(h(t.items[i].price.retail||0),1),t.items[i].need_percent_price?(s(),o("span",kt,", %")):(s(),o("span",yt,", ₽"))]),e("td",vt,[d(h(t.items[i].price.cost||0),1),t.items[i].need_percent_price?(s(),o("span",wt,", %")):(s(),o("span",$t,", ₽"))])])])])])]))),256))])])):l("",!0)]),t.items.length===0?(s(),o("div",Vt,It)):l("",!0),t.items.length>0?(s(),o("div",Lt,[e("div",At,[t.paginate_object?(s(),f(I,{key:0,onPagination_page:t.loadDoorVariants,pagination:t.paginate_object},null,8,["onPagination_page","pagination"])):l("",!0)])])):l("",!0),e("div",Mt,[e("div",Ot,[e("div",Pt,[e("div",Tt,[t.selected_item?(s(),o(u,{key:0},[t.loading?l("",!0):(s(),f(y,{key:0,item:t.selected_item,onCallback:r[6]||(r[6]=c=>t.selectItem(null))},null,8,["item"]))],64)):l("",!0)])])])])],64))}}),St=e("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"},"Варианты дверей",-1),qt={class:"py-12"},Bt={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},Et={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},Gt={class:"p-6 text-gray-900"},Jt=e("hr",{class:"hr my-5"},null,-1),Zt={data(){return{loading:!1,selectedDoorVariant:null}},methods:{selectDoorVariant(n){this.selectedDoorVariant=n,this.loading=!0,this.$nextTick(()=>{this.loading=!1})},callbackDoorVariantForm(){this.loading=!0,this.selectedDoorVariant=null,this.$nextTick(()=>{this.loading=!1})}}},xt=Object.assign(Zt,{__name:"DoorVariantsPage",setup(n){return(t,r)=>(s(),o(u,null,[b(j(F),{title:"Варианты дверей"}),b(w,null,{header:g(()=>[St]),default:g(()=>[e("div",qt,[e("div",Bt,[e("div",Et,[e("div",Gt,[t.loading?l("",!0):(s(),f(y,{key:0,item:t.selectedDoorVariant,onCallback:t.callbackDoorVariantForm},null,8,["item","onCallback"])),Jt,t.loading?l("",!0):(s(),f(Nt,{key:1,onSelect:t.selectDoorVariant},null,8,["onSelect"]))])])])])]),_:1})],64))}});export{xt as default};
