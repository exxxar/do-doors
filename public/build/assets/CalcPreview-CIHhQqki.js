import{_ as E,a as I}from"./DoorItemEditor-DCfA3PYi.js";import{m as k,k as L,o as e,c as t,b as o,f as a,t as d,n as u,e as i,F as p,r as m,p as g,g as f,d as b,v,a as V,w as j,j as T}from"./app-dkLjEYBu.js";import{L as S,I as O,C as B}from"./IndividualDataForm-B---LEg7.js";import{v as H}from"./vue-the-mask-tpJ3Q-QS.js";const M={key:0,class:"row"},P={class:"col-md-6"},N={class:"row"},U={class:"col-md-6 col-12 mb-2"},W=["disabled"],q=o("i",{class:"fa-solid fa-floppy-disk"},null,-1),J={class:"col-md-6 col-12 mb-2"},G={class:"card rounded-0 border-black"},R={class:"card-body px-2 py-1"},A=o("label",{class:"font-size-10"},[o("i",{class:"fa-solid fa-signs-post"}),a(" Назначение двери")],-1),K={class:"col-md-6 col-12 mb-2"},Q={class:"card rounded-0 border-black"},X={class:"card-body px-2 py-1"},Y=o("label",{class:"font-size-10"},[o("i",{class:"fa-solid fa-ruler-vertical"}),a(" Высота, мм")],-1),Z=["innerHTML"],x={class:"col-md-6 col-12 mb-2"},oo={class:"card rounded-0 border-black"},so={class:"card-body px-2 py-1"},eo=o("label",{class:"font-size-10"},[o("i",{class:"fa-solid fa-ruler-horizontal"}),a(" Ширина, мм ")],-1),to=["innerHTML"],lo={class:"col-md-6 col-12 mb-2"},io={class:"card rounded-0 border-black"},no={class:"card-body px-2 py-1"},ro=o("label",{class:"font-size-10"},[o("i",{class:"fa-brands fa-openid"}),a(" Тип открытия двери и толщина ")],-1),ao={class:"col-md-6 col-12 mb-2"},co={class:"card rounded-0 border-black"},_o={class:"card-body px-2 py-1"},ho=o("label",{class:"font-size-10"},[o("i",{class:"fa-solid fa-door-open"}),a(" Тип двери ")],-1),uo={class:"col-md-6 col-12 mb-2"},po={class:"card rounded-0 border-black"},bo={class:"card-body px-2 py-1"},fo=o("label",{class:"font-size-10"},[o("i",{class:"fa-solid fa-industry"}),a(" Производитель петель ")],-1),mo={class:"col-md-6 col-12 mb-2"},yo={class:"card rounded-0 border-black"},vo={class:"card-body px-2 py-1"},ko=o("label",{class:"font-size-10"},[o("i",{class:"fa-solid fa-angles-left"}),a(" Сторона петель ")],-1),go={class:"col-md-6 col-12 mb-2"},$o={class:"card rounded-0 border-black"},wo={class:"card-body px-2 py-1"},Fo=o("label",{class:"font-size-10"},[o("i",{class:"fa-solid fa-paint-roller"}),a(" Отделка первой стороны ")],-1),Co={class:"col-md-6 col-12 mb-2"},zo={class:"card-body px-2 py-1"},Vo=o("label",{class:"font-size-10"},[o("i",{class:"fa-solid fa-palette"}),a(" Цвет отделки первой стороны ")],-1),Do={key:1,class:"card rounded-0"},Eo=o("div",{class:"card-body p-3 disabled-element"},[o("p",{class:"text-center"},'Выбрано "Под покраску"')],-1),Io=[Eo],Lo={class:"col-md-6 col-12 mb-2"},jo={class:"card rounded-0 border-black"},To={class:"card-body px-2 py-1"},So=o("label",{class:"font-size-10"},[o("i",{class:"fa-solid fa-paint-roller"}),a(" Отделка второй стороны ")],-1),Oo={class:"col-md-6 col-12 mb-2"},Bo={class:"card-body px-2 py-1"},Ho=o("label",{class:"font-size-10"},[o("i",{class:"fa-solid fa-palette"}),a(" Цвет отделки второй стороны ")],-1),Mo={key:1,class:"card rounded-0"},Po=o("div",{class:"card-body p-3 disabled-element"},[o("p",{class:"text-center"},'Выбрано "Под покраску"')],-1),No=[Po],Uo={class:"col-md-6 col-12 mb-2"},Wo={class:"card-body px-2 py-1"},qo=o("label",{class:"font-size-10"},[o("i",{class:"fa-solid fa-palette"}),a(" Цвет короба и каркаса ")],-1),Jo={class:"col-md-6 col-12 mb-2"},Go={class:"card-body px-2 py-1"},Ro=o("label",{class:"font-size-10"},[o("i",{class:"fa-solid fa-palette"}),a(" Цвет уплотнителя ")],-1),Ao={class:"col-md-6 col-12 mb-2"},Ko={class:"card-body px-2 py-1"},Qo=o("label",{class:"font-size-10"},[o("i",{class:"fa-solid fa-palette"}),a(" Цвет фурнитуры ")],-1),Xo={key:0,class:"col-md-6 col-12 mb-2"},Yo={class:"card-body px-2 py-1"},Zo=o("label",{class:"font-size-10"},[o("i",{class:"fa-solid fa-palette"}),a(" Цвет фурнитуры ")],-1),xo={class:"col-12 mb-2"},os={style:{"min-height":"100px"},class:"card rounded-0 border-black"},ss={class:"card-body px-2 py-1"},es=o("label",{class:"font-size-10"},"Комментарий к двери ",-1),ts={key:0,class:"row py-3"},ls={class:"col-12 d-flex align-items-center"},ds={key:0,class:"fw-bold"},is={key:1,class:"fw-bold"},ns={key:0,class:"col-md-6 col-12 mb-2"},rs={class:"card rounded-0 border-black"},as={class:"card-body px-2 py-1"},cs=o("label",{class:"font-size-10"},"Отверстие под ручку ",-1),_s={key:1,class:"col-md-6 col-12 mb-2"},hs={class:"card rounded-0 border-black"},us={class:"card-body px-2 py-1"},ps=o("label",{class:"font-size-10"},"Вариант ручки ",-1),bs={key:2,class:"col-12 mb-2"},fs={class:"card rounded-0 border-black"},ms={class:"card-body px-2 py-1"},ys=o("label",{class:"font-size-10"},"Вариант дополнительного сервиса ",-1),vs={key:3,class:"col-12"},ks={class:"row"},gs={class:"col-12"},$s={class:"mb-2"},ws={class:"col-lg-3 col-md-3 col-12 mb-2"},Fs=["onClick"],Cs={class:"card-img-top",alt:"..."},zs={class:"card-body"},Vs={key:0,class:"font-bold"},Ds={key:1,class:"card-text"},Es={key:4,class:"col-12"},Is=o("div",{class:"alert alert-warning rounded-0",role:"alert"},[o("p",null,"Вариантов изображений ручки нет")],-1),Ls=[Is],js={class:"col-12 d-flex align-items-center"},Ts={key:0,class:"fw-bold"},Ss={key:1,class:"fw-bold"},Os={class:"col-12 d-flex align-items-center"},Bs={key:0,class:"fw-bold"},Hs={key:1,class:"fw-bold"},Ms={key:5,class:"col-12"},Ps={class:"card rounded-0 border-black"},Ns={class:"card-body px-2 py-1"},Us=o("label",{class:"font-size-10"},"Вариант ",-1),Ws={class:"col-12 d-flex align-items-center"},qs={key:0,class:"fw-bold"},Js={key:1,class:"fw-bold"},Gs={key:6,class:"col-12"},Rs={class:"card rounded-0 border-black"},As={class:"card-body px-2 py-1"},Ks=o("label",{class:"font-size-10"},"Вариант ",-1),Qs={class:"col-12 d-flex align-items-center"},Xs={key:0,class:"fw-bold"},Ys={key:1,class:"fw-bold"},Zs={key:7,class:"col-12"},xs={class:"card rounded-0 border-black"},oe={class:"card-body px-2 py-1"},se=o("label",{class:"font-size-10"},"Вариант ",-1),ee={class:"col-12 d-flex align-items-center"},te={key:0,class:"fw-bold"},le={key:1,class:"fw-bold"},de={class:"col-12 d-flex align-items-center"},ie={key:0,class:"fw-bold"},ne={key:1,class:"fw-bold"},re={class:"col-12 d-flex align-items-center"},ae={key:0,class:"fw-bold"},ce={key:1,class:"fw-bold"},_e={class:"col-md-6"},he={class:"preview"},ue={class:"card rounded-0 mt-3"},pe={class:"card-body"},be=o("h6",null,"Характеристики",-1),fe={class:"text-muted font-bold"},me={class:"text-black mb-0"},ye={key:0,class:"mr-1"},ve={key:1,class:"mr-1"},ke={key:2,class:"mr-1"},ge={key:3,class:"mr-1"},$e={key:4,class:"mr-1"},we={key:5,class:"mr-1"},Fe={key:6,class:"mr-1"},Ce={key:7,class:"mr-1"},ze={class:"row row-cols-md-2 mt-3"},Ve={class:"col mb-2"},De={class:"card rounded-0 border-black"},Ee={class:"card-body px-2 py-1"},Ie=o("label",{class:"font-size-10"},"Тип цены ",-1),Le={key:0,class:"col mb-2"},je={class:"card rounded-0 border-black"},Te={class:"card-body px-2 py-1"},Se=o("label",{class:"font-size-10"},"Процент дилера ",-1),Oe={class:"col mb-2"},Be={class:"card rounded-0 border-black"},He={class:"card-body px-2 py-1"},Me=o("label",{class:"font-size-10"},"Кол-во ",-1),Pe={class:"col mb-2"},Ne={class:"card rounded-0 border-black"},Ue={class:"card-body px-2 py-1"},We=o("label",{class:"font-size-10"},"Цена ",-1),qe={key:1,class:"col d-flex mb-2"},Je=o("i",{class:"fa-solid fa-floppy-disk"},null,-1),Ge={key:1,class:"card rounded-0 mt-3"},Re={class:"card-body"},Ae={class:"table"},Ke=o("br",null,null,-1),Qe={key:0},Xe=o("br",null,null,-1),Ye={key:1,class:"row"},Ze=o("div",{class:"col-12"},[o("div",{class:"d-flex justify-content-center align-items-center flex-column",style:{"min-height":"500px"}},[o("h5",null,"Загружаем страничку...."),o("div",{class:"spinner-border my-3",role:"status"},[o("span",{class:"visually-hidden"},"Loading...")])])],-1),xe=[Ze],ot={name:"MyComponent",props:["modelValue","canEdit"],data(){return{loaded:!1,door:null,type_dictionary:{size:"Петли",handle_holes_type:"Отверстие под ручку",opening_type:"Тип открытия двери и толщина",box_and_frame_color:"Цвет короба и каркаса",door_type:"Тип двери",front_side_finish_color:"Цвет отделки внешней стороны",back_side_finish_color:"Цвет отделки внутренней стороны",seal_color:"Цвет уплотнителя",fittings_color:"Цвет фурнитуры",hinge_manufacturer:"Производитель петель",front_side_finish:"Отделка внешней стороны",back_side_finish:"Отделка внутренней стороны",base:"База (под покраску)",service_doorstep:"Работа с порогом",service_painting:"Покраска фурнитуры",service_door_closer:"Работа с доводчиком",service_handle:"Работа с ручками",service_stopper:"Работа со стопором"},tmp_prices:[],need_addition:!0,messages:[],filterHeight:null,filterWidth:null,selectedColorParam:null,loadedParams:!0,confirmModal:null,finishFrontVariantModal:null,finishBackVariantModal:null,colors:[],confirm:{title:null,message:null},color_sync_update:!1}},computed:{...k(["getErrors","getDictionary","cartTotalCount","cartProducts","cartTotalPrice"])},watch:{door:{handler(n){this.$emit("update:modelValue",this.door)},deep:!0}},mounted(){this.door=this.modelValue},methods:{editVariant(){this.$emit("edit")},invertHex(n){if(!n)return"#000000";var s=n.replace(/#/,""),r=parseInt(s.substr(0,2),16),l=parseInt(s.substr(2,2),16),_=parseInt(s.substr(4,2),16),h=(.2126*r+.7152*l+.0722*_)/255;return h>.5?"#000000":"#ffffff"}}},st=Object.assign(ot,{setup(n){return(s,r)=>{var _,h,y,$,w,F,C,z;const l=L("lazy");return s.door?(e(),t("div",M,[o("div",P,[o("div",N,[o("div",U,[o("button",{disabled:!n.canEdit,onClick:r[0]||(r[0]=(...c)=>s.editVariant&&s.editVariant(...c)),type:"button",class:"btn btn-dark rounded-0 w-100 p-3"},[q,a(" Редактировать ")],8,W)]),o("div",J,[o("div",G,[o("div",R,[A,o("p",null,d(s.door.purpose||"Не указано"),1)])])]),o("div",K,[o("div",Q,[o("div",X,[Y,o("p",{innerHTML:s.door.height},null,8,Z)])])]),o("div",x,[o("div",oo,[o("div",so,[eo,o("p",{innerHTML:s.door.width},null,8,to)])])]),o("div",lo,[o("div",io,[o("div",no,[ro,o("p",null,d(s.door.opening_type.title||"-")+" (толщина "+d(s.door.opening_type.depth)+" мм)",1)])])]),o("div",ao,[o("div",co,[o("div",_o,[ho,o("p",null,d(s.door.door_type.title||"-"),1)])])]),o("div",uo,[o("div",po,[o("div",bo,[fo,o("p",null,d(s.door.hinge_manufacturer.title||"-"),1)])])]),o("div",mo,[o("div",yo,[o("div",vo,[ko,o("p",null,d(((_=s.door.loops_variants)==null?void 0:_.title)||"-"),1)])])]),o("div",go,[o("div",$o,[o("div",wo,[Fo,o("p",null,d(((h=s.door.front_side_finish)==null?void 0:h.title)||"-"),1)])])]),o("div",Co,[s.door.front_side_finish.title!=="Под покраску"?(e(),t("div",{key:0,style:u({"background-color":s.door.front_side_finish.code,color:s.invertHex(s.door.front_side_finish.code)}),class:"card rounded-0 border-black"},[o("div",zo,[Vo,o("p",null,d(s.door.front_side_finish.title||"-"),1)])],4)):(e(),t("div",Do,Io))]),o("div",Lo,[o("div",jo,[o("div",To,[So,o("p",null,d(s.door.back_side_finish.title||"-"),1)])])]),o("div",Oo,[s.door.back_side_finish.title!=="Под покраску"?(e(),t("div",{key:0,style:u({"background-color":s.door.back_side_finish.code,color:s.invertHex(s.door.back_side_finish.code)}),class:"card rounded-0 border-black"},[o("div",Bo,[Ho,o("p",null,d(s.door.back_side_finish.title||"-"),1)])],4)):(e(),t("div",Mo,No))]),o("div",Uo,[o("div",{style:u({"background-color":s.door.box_and_frame_color.code,color:s.invertHex(s.door.box_and_frame_color.code)}),class:"card rounded-0 border-black"},[o("div",Wo,[qo,o("p",null,d(s.door.box_and_frame_color.title||"-"),1)])],4)]),o("div",Jo,[o("div",{style:u({"background-color":s.door.seal_color.code,color:s.invertHex(s.door.seal_color.code)}),class:"card rounded-0 border-black"},[o("div",Go,[Ro,o("p",null,d(s.door.seal_color.title||"-"),1)])],4)]),o("div",Ao,[o("div",{style:u({"background-color":s.door.fittings_color.code,color:s.invertHex(s.door.fittings_color.code)}),class:"card rounded-0 border-black"},[o("div",Ko,[Qo,o("p",null,d(s.door.fittings_color.title||"-"),1)])],4)]),s.door.fittings_color.title!=null&&s.door.fittings_color.is_ral?(e(),t("div",Xo,[o("div",{style:u({"background-color":s.door.service_painting.code,color:s.invertHex(s.door.service_painting.code)}),class:"card rounded-0 border-black"},[o("div",Yo,[Zo,o("p",null,d(s.door.service_painting.title||"-"),1)])],4)])):i("",!0),o("div",xo,[o("div",os,[o("div",ss,[es,o("p",null,d(s.door.comment||"-"),1)])])])]),s.need_addition?(e(),t("div",ts,[o("div",ls,[o("p",null,[a(" Ручка: "),s.door.need_handle_holes?(e(),t("span",ds,"нужна")):(e(),t("span",is,"не нужна"))])]),s.door.need_handle_holes?(e(),t("div",ns,[o("div",rs,[o("div",as,[cs,o("p",null,d(((y=s.door.handle_holes_variants)==null?void 0:y.title)||"-"),1)])])])):i("",!0),s.door.need_handle_holes&&s.door.handle_holes.id!==3?(e(),t("div",_s,[o("div",hs,[o("div",us,[ps,o("p",null,d(s.door.handle_holes_type.title||"-"),1)])])])):i("",!0),s.door.need_handle_holes&&s.door.handle_holes.id!==3?(e(),t("div",bs,[o("div",fs,[o("div",ms,[ys,o("p",null,d((($=s.door.service_handle)==null?void 0:$.title)||"-"),1)])])])):i("",!0),(s.door.handle_holes_type.variants||[]).length>0&&s.door.need_handle_holes&&s.door.handle_holes.id!==3?(e(),t("div",vs,[o("div",ks,[o("div",gs,[o("p",$s,[a("Цвет ручки "+d(s.door.handle_holes_type.color||"не указан")+" ",1),s.door.handle_holes_type.color?(e(),t("span",{key:0,class:"d-inline-block",style:u([{"background-color":s.door.handle_holes_type.color},{width:"50px",height:"10px"}])},null,4)):i("",!0)])]),(e(!0),t(p,null,m(s.door.handle_holes_type.variants,(c,D)=>(e(),t("div",ws,[o("div",{class:g(["card cursor-pointer",{"border-secondary shadow-lg":c.selected}]),onClick:ml=>s.selectSideFinish("handle_holes_type","variants",D)},[f(o("img",Cs,null,512),[[l,c.image]]),o("div",zs,[c.title?(e(),t("h6",Vs,d(c.title||"не указано"),1)):i("",!0),c.description?(e(),t("p",Ds,d(c.description||"не указано"),1)):i("",!0)])],10,Fs)]))),256))])])):i("",!0),(s.door.handle_holes_type.variants||[]).length===0&&s.door.need_handle_holes?(e(),t("div",Es,Ls)):i("",!0),o("div",js,[o("p",null,[a(" Верхняя перемычка: "),s.door.need_upper_jumper?(e(),t("span",Ts,"нужна")):(e(),t("span",Ss,"не нужна"))])]),o("div",Os,[o("p",null,[a(" Автоматический порог: "),s.door.need_upper_jumper?(e(),t("span",Bs,"нужен")):(e(),t("span",Hs,"не нужен"))])]),s.door.need_automatic_doorstep?(e(),t("div",Ms,[o("div",Ps,[o("div",Ns,[Us,o("p",null,d(((w=s.door.service_doorstep)==null?void 0:w.title)||"-"),1)])])])):i("",!0),o("div",Ws,[o("p",null,[a(" Скрытый стопор: "),s.door.need_hidden_stopper?(e(),t("span",qs,"нужен")):(e(),t("span",Js,"не нужен"))])]),s.door.need_hidden_stopper?(e(),t("div",Gs,[o("div",Rs,[o("div",As,[Ks,o("p",null,d(((F=s.door.service_stopper)==null?void 0:F.title)||"-"),1)])])])):i("",!0),o("div",Qs,[o("p",null,[a(" Скрытый доводчик: "),s.door.need_hidden_door_closer?(e(),t("span",Xs,"нужен")):(e(),t("span",Ys,"не нужен"))])]),s.door.need_hidden_door_closer?(e(),t("div",Zs,[o("div",xs,[o("div",oe,[se,o("p",null,d(((C=s.door.service_door_closer)==null?void 0:C.title)||"-"),1)])])])):i("",!0),o("div",ee,[o("p",null,[a(" Скрытый плинтус: "),s.door.need_hidden_skirting_board?(e(),t("span",te,"нужен")):(e(),t("span",le,"не нужен"))])]),o("div",de,[o("p",null,[a(" Установка двери: "),s.door.need_door_install?(e(),t("span",ie,"нужна")):(e(),t("span",ne,"не нужна"))])]),o("div",re,[o("p",null,[a(" Упаковка двери: "),s.door.need_wrapper?(e(),t("span",ae,"нужна")):(e(),t("span",ce,"не нужна"))])])])):i("",!0)]),o("div",_e,[o("div",he,[s.loadedParams?(e(),b(E,{key:0,disabled:!0,modelValue:s.door,"onUpdate:modelValue":r[1]||(r[1]=c=>s.door=c)},null,8,["modelValue"])):i("",!0),o("div",ue,[o("div",pe,[be,o("h6",fe,d(s.door.door_type.title)+" "+d(s.door.width)+"x"+d(s.door.height)+"x"+d(((z=s.door.opening_type)==null?void 0:z.depth)||0),1),o("h6",me,[s.door.box_and_frame_color.title?(e(),t("span",ye,"("+d(s.door.box_and_frame_color.title)+"),",1)):i("",!0),s.door.front_side_finish.title?(e(),t("span",ve,"первая сторона "+d(s.door.front_side_finish.title)+", ",1)):i("",!0),s.door.back_side_finish.title?(e(),t("span",ke,"/вторая сторона "+d(s.door.back_side_finish.title)+",",1)):i("",!0),s.door.loops.title?(e(),t("span",ge,"петли "+d(s.door.loops.title),1)):i("",!0),s.door.hinge_manufacturer.title?(e(),t("span",$e,d(s.door.hinge_manufacturer.title),1)):i("",!0),s.door.fittings_color.title?(e(),t("span",we,"("+d(s.door.fittings_color.title)+"),",1)):i("",!0),s.door.opening_type.title?(e(),t("span",Fe,d(s.door.opening_type.title)+",",1)):i("",!0),s.door.handle_holes.title?(e(),t("span",Ce,d(s.door.handle_holes.title),1)):i("",!0)]),o("div",ze,[o("div",Ve,[o("div",De,[o("div",Ee,[Ie,o("p",null,d(s.door.price_type.title||"-"),1)])])]),s.door.price_type.id===3?(e(),t("div",Le,[o("div",je,[o("div",Te,[Se,o("p",null,d(s.door.dealer_percent||"0"),1)])])])):i("",!0),o("div",Oe,[o("div",Be,[o("div",He,[Me,o("p",null,d(s.door.count||"0"),1)])])]),o("div",Pe,[o("div",Ne,[o("div",Ue,[We,o("p",null,d(s.door.price)+" ₽",1)])])]),n.canEdit?(e(),t("div",qe,[o("button",{onClick:r[2]||(r[2]=(...c)=>s.editVariant&&s.editVariant(...c)),type:"button",class:"btn btn-dark rounded-0 w-100"},[Je,a(" Редактировать ")])])):i("",!0)])])]),s.tmp_prices.length>0?(e(),t("div",Ge,[o("div",Re,[o("table",Ae,[o("tbody",null,[(e(!0),t(p,null,m(s.tmp_prices,c=>(e(),t("tr",null,[o("td",null,[a(d(s.type_dictionary[c.type]||c.type)+" ",1),s.door[c.type]?(e(),t(p,{key:0},[Ke,s.door[c.type].description?(e(),t("small",Qe,"("+d(s.door[c.type].description)+")",1)):i("",!0)],64)):i("",!0)]),o("td",null,[a(d(c.price||0)+" руб. ",1),c.full_price?(e(),t(p,{key:0},[Xe,o("small",null,"("+d(c.full_price||0)+" руб.)",1)],64)):i("",!0)])]))),256))])])])])):i("",!0)])])])):(e(),t("div",Ye,xe))}}}),et=o("div",{class:"alert alert-danger"}," Внимание! Редактирование заказа на текущий момент на стадии доработки! ",-1),tt={class:"form-floating mb-2"},lt=o("label",{for:"contractNumber"},"Номер договора",-1),dt={class:"input-group mb-2"},it={class:"form-floating"},nt=o("label",{for:"checkout-name"},"Название компании\\Ф.И.О. ИП",-1),rt={key:0,class:"btn btn-outline-secondary",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},at=o("i",{class:"fa-solid fa-up-right-and-down-left-from-center"},null,-1),ct=[at],_t={style:{"overflow-y":"scroll",height:"400px",width:"100%"},class:"dropdown-menu dropdown-menu-end rounded-0"},ht=o("i",{class:"fa-solid fa-ban"},null,-1),ut=o("li",null,[o("hr",{class:"dropdown-divider"})],-1),pt=o("i",{class:"fa-solid fa-plus"},null,-1),bt=o("li",null,[o("hr",{class:"dropdown-divider"})],-1),ft={class:"p-2"},mt={class:"form-floating mb-3"},yt={for:"floatingInput"},vt=["onClick"],kt=o("br",null,null,-1),gt={class:"badge rounded-0 btn-dark",style:{"font-size":"8px"}},$t=["href"],wt={key:0,class:"d-flex justify-content-center my-3"},Ft=o("div",{class:"spinner-border text-primary mx-2",role:"status"},[o("span",{class:"visually-hidden"},"Loading...")],-1),Ct={key:1,class:"card rounded-0"},zt=o("div",{class:"card-body"},[o("p",null,"Вы должны добавить в корзину хотя бы одно изделие")],-1),Vt=[zt],Dt={props:["type","action","doors","order"],directives:{mask:H.mask},computed:{...k(["getErrors","getDictionary","cartTotalCount","cartTotalPrice","cartProducts"]),filteredClients(){if(!this.search)return this.self_clients||[];const n=this.search.toLowerCase();return this.self_clients.filter(s=>(s.title||"").toLowerCase().includes(n)||(s.fio||"").toLowerCase().includes(n))}},watch:{},data(){return{edit_requisites:!1,search:null,tab:0,timer:null,step:0,editor_modal:null,self_clients:[],clientForm:{id:null,name:null,phone:null,email:null,info:null,promo:null,contract_number:null,dealer_percent:0,summary_price_type:null,work_with_nds:1,items:[],current_payed:0,payed_percent:70,payed_percent_type:1,delivery_terms:null,ascent_floor:!1,work_days:0,installation:{need_door_install:!1,count:0,price:0,recount_type:0},designer:{is_fix:!1,value:0,price:0},passport:null,passport_issued:null,need_delivery:!1,delivery_type:1,delivery_address:null,delivery_price:null,delivery_city:null,delivery_service:null}}},mounted(){var n,s;this.loadSelfClients(),this.clientForm.contract_number=this.order.contract_number||null,this.clientForm.name=this.order.contact_person||null,this.clientForm.phone=((n=this.order.client)==null?void 0:n.phone)||null,this.clientForm.email=((s=this.order.client)==null?void 0:s.email)||null,this.clientForm.work_with_nds=this.order.organizational_form==="individual"?0:1},methods:{showEditorForm(){window.location.href="/clients"},selectItem(){},back(){console.log("click back"),this.$emit("callback")},preparedLawStatus(n){let r=(this.getDictionary.statuses||[]).find(l=>l.value===n)||null;return r?r.title:null},selectInfo(n){if(n==null){this.clientForm.id=null,this.clientForm.name=null,this.clientForm.email=null,this.clientForm.phone=null,this.clientForm.pasport=null,this.clientForm.pasport_issued=null,this.clientForm.fact_address=null;return}this.clientForm.id=n.id||null,this.clientForm.name=n.title||null,this.clientForm.email=n.email||null,this.clientForm.phone=n.phone||null,this.clientForm.delivery_address=n.fact_address||null,this.clientForm.pasport=n.pasport||null,this.clientForm.pasport_issued=n.pasport_issued||null},clearCart(){this.$store.dispatch("clearCart").then(n=>{this.$notify({title:"DoDoors",text:"Успешно очищено",type:"success"})}).catch(n=>{this.$notify({title:"DoDoors",text:"Ошибочка...",type:"error"})})},findPromo(){this.discount=0,!((this.clientForm.promo||"").length<=5)&&this.$store.dispatch("findPromoCode",{code:this.clientForm.promo}).then(n=>{this.discount=n.discount||0})},loadSelfClients(){this.$store.dispatch("loadSelfClients").then(n=>{this.self_clients=n.data||[]}).catch(()=>{})},submit(){this.timer=0;let n=setInterval(()=>{this.timer++},1e3);this.clientForm.items=this.cartProducts;let s=new FormData;Object.keys(this.clientForm).forEach(r=>{const l=this.clientForm[r]||"";typeof l=="object"?s.append(r,JSON.stringify(l)):s.append(r,l)}),s.append("action",this.action),s.append("total_price",this.cartTotalPrice),s.append("total_count",this.cartTotalCount),this.$store.dispatch("checkoutItems",{clientForm:s}).then(r=>{clearInterval(n),this.timer=null,this.step=0,this.tab=0,this.$store.dispatch("clearCart"),this.clientForm={name:null,phone:null,email:null,info:null,passport:null,passport_issued:null,delivery_address:null},this.$notify({title:"DoDoors",text:"Заказ передан менеджеру!",type:"success"}),this.loadSelfClients()}).catch(r=>{clearInterval(n),this.timer=null,this.$notify({title:"DoDoors",text:"Ошибочка...",type:"error"})})}}},Et=Object.assign(Dt,{__name:"CheckoutFormEditor",setup(n){return(s,r)=>(n.doors||[]).length>0?(e(),t("form",{key:0,onSubmit:r[9]||(r[9]=T((...l)=>s.submit&&s.submit(...l),["prevent"]))},[et,o("div",tt,[f(o("input",{type:"text","onUpdate:modelValue":r[0]||(r[0]=l=>s.clientForm.contract_number=l),class:"form-control",id:"contractNumber",required:"",placeholder:"Введите номер договора"},null,512),[[v,s.clientForm.contract_number]]),lt]),o("div",dt,[o("div",it,[f(o("input",{type:"text",class:"form-control","onUpdate:modelValue":r[1]||(r[1]=l=>s.clientForm.name=l),id:"checkout-name",placeholder:"name@example.com",required:""},null,512),[[v,s.clientForm.name]]),nt]),s.self_clients.length>0?(e(),t("button",rt,ct)):i("",!0),o("ul",_t,[o("li",null,[o("a",{class:"dropdown-item",onClick:r[2]||(r[2]=l=>s.selectInfo(null)),href:"javascript:void(0)"},[ht,a(" Не выбрано")])]),ut,o("li",null,[o("a",{class:"dropdown-item",onClick:r[3]||(r[3]=(...l)=>s.showEditorForm&&s.showEditorForm(...l)),href:"javascript:void(0)"},[pt,a(" Создать нового")])]),bt,o("li",null,[o("div",ft,[o("div",mt,[f(o("input",{type:"search","onUpdate:modelValue":r[4]||(r[4]=l=>s.search=l),class:"form-control",id:"floatingInput",placeholder:"Имя"},null,512),[[v,s.search]]),o("label",yt,"Поиск (найдено "+d(s.filteredClients.length||0)+" клиентов) ",1)])]),(e(!0),t(p,null,m(s.filteredClients,(l,_)=>(e(),t("a",{class:g([{"btn-light":_%2===0},"p-2 d-block btn rounded-0"]),style:{"word-wrap":"break-word","overflow-wrap":"break-word"},href:"javascript:void(0)",onClick:h=>s.selectInfo(l)},[a(d(l.title||l.phone)+" ",1),kt,o("span",gt,d(s.preparedLawStatus(l.status)||"Не указан"),1)],10,vt))),256))])])]),s.clientForm.id?(e(),t("a",{key:0,class:"btn btn-link mb-2 p-0",href:"/client/"+s.clientForm.id,target:"_blank"},"Редактировать клиента",8,$t)):i("",!0),(n.type||0)===0?(e(),b(S,{key:1,modelValue:s.clientForm,"onUpdate:modelValue":r[5]||(r[5]=l=>s.clientForm=l)},null,8,["modelValue"])):i("",!0),(n.type||0)===1?(e(),b(O,{key:2,modelValue:s.clientForm,"onUpdate:modelValue":r[6]||(r[6]=l=>s.clientForm=l)},null,8,["modelValue"])):i("",!0),V(B,{disabled:s.timer||!0,modelValue:s.clientForm,"onUpdate:modelValue":r[7]||(r[7]=l=>s.clientForm=l)},{loader:j(()=>[s.timer?(e(),t("div",wt,[Ft,a(" Отправляем... ")])):i("",!0)]),_:1},8,["disabled","modelValue"]),o("button",{type:"button",class:"btn btn-outline-secondary w-100 rounded-0",onClick:r[8]||(r[8]=(...l)=>s.back&&s.back(...l))},"Назад ")],32)):(e(),t("div",Ct,Vt))}}),It={class:"row"},Lt={class:"col-12 mb-2 d-flex align-items-center"},jt={class:"fw-bold"},Tt=o("button",{class:"btn btn-dark rounded-0 ml-2",type:"button","data-bs-toggle":"offcanvas","data-bs-target":"#offcanvasWithBothOptions","aria-controls":"offcanvasWithBothOptions"},[o("i",{class:"fa-solid fa-arrow-up-right-from-square"}),a(" Список дверей в заказе ")],-1),St=["href"],Ot=o("i",{class:"fa-solid fa-up-right-from-square"},null,-1),Bt=[Ot],Ht={key:0,class:"row"},Mt={class:"col-lg-12"},Pt={key:1,class:"row"},Nt={class:"col-lg-12"},Ut={class:"offcanvas offcanvas-end","data-bs-scroll":"true",tabindex:"-1",id:"offcanvasWithBothOptions","aria-labelledby":"offcanvasWithBothOptionsLabel"},Wt={class:"offcanvas-header"},qt={key:0,class:"offcanvas-title fw-bold",id:"offcanvasWithBothOptionsLabel"},Jt={key:1,class:"offcanvas-title fw-bold",id:"offcanvasWithBothOptionsLabel"},Gt=o("button",{type:"button",class:"btn-close","data-bs-dismiss":"offcanvas","aria-label":"Close"},null,-1),Rt={key:0,class:"offcanvas-body"},At=["onClick"],Kt={class:"card-body"},Qt={class:"text-muted font-bold"},Xt={class:"text-black mb-0"},Yt={key:0},Zt={key:1,class:"ml-1"},xt={key:2,class:"ml-1"},ol={key:3},sl={key:4,class:"ml-1"},el={key:5,class:"ml-1"},tl={key:6,class:"ml-1"},ll={key:7,class:"ml-1"},dl={key:8,class:"ml-1"},il={key:9,class:"ml-1"},nl={key:10,class:"ml-1"},rl={key:11,class:"ml-1"},al={key:12,class:"ml-1"},cl={key:13,class:"ml-1"},_l={key:14,class:"ml-1"},hl={key:15,class:"ml-1"},ul={key:16,class:"ml-1"},pl={key:1,class:"offcanvas-body p-3"},bl={key:2,class:"offcanvas-footer p-3"},fl={props:["doors","order","canEdit"],name:"MyComponent",data(){return{loading:!1,tab:0,cart_tab:0,timer:null,selected_index:0,formData:{contract_number:null,work_with_nds:null}}},computed:{...k(["getErrors"])},mounted(){this.formData.contract_number=this.order.contract_number||null},methods:{submit(){this.timer=0;let n=setInterval(()=>{this.timer++},1e3);this.formData.id=this.order.id;let s=new FormData;Object.keys(this.formData).forEach(r=>{const l=this.formData[r]||"";typeof l=="object"?s.append(r,JSON.stringify(l)):s.append(r,l)}),this.$store.dispatch("contractProcessing",{processingForm:s}).then(r=>{clearInterval(n),this.timer=null,this.$notify({title:"DoDoors",text:"Номер договора успешно установлен!",type:"success"})}).catch(r=>{clearInterval(n),this.timer=null,this.$notify({title:"DoDoors",text:"Ошибочка...",type:"error"})})},selectDoor(n){this.loading=!0,this.tab=0,this.selected_index=n,this.$nextTick(()=>{this.loading=!1})},onStartEdit(){this.tab=1}}},$l=Object.assign(fl,{setup(n){return(s,r)=>(e(),t(p,null,[o("div",It,[o("div",Lt,[o("p",null,[a("Информация о заказе: "),o("span",jt,"№"+d(n.order.id),1)]),Tt,o("a",{href:"/link/"+n.order.id,target:"_blank",class:"btn btn-dark rounded-0 ml-2"},Bt,8,St)])]),s.tab===0?(e(),t("div",Ht,[o("div",Mt,[s.loading?i("",!0):(e(),b(st,{key:0,"can-edit":n.canEdit,onEdit:s.onStartEdit,modelValue:n.doors[s.selected_index].door,"onUpdate:modelValue":r[0]||(r[0]=l=>n.doors[s.selected_index].door=l)},null,8,["can-edit","onEdit","modelValue"]))])])):i("",!0),s.tab===1?(e(),t("div",Pt,[o("div",Nt,[s.loading?i("",!0):(e(),b(I,{key:0,"edit-order":!0,door:n.doors[s.selected_index]},null,8,["door"]))])])):i("",!0),o("div",Ut,[o("div",Wt,[s.cart_tab===0?(e(),t("h5",qt,"Двери в заказе")):i("",!0),s.cart_tab===1?(e(),t("h5",Jt,"Параметры заказа")):i("",!0),Gt]),s.cart_tab===0?(e(),t("div",Rt,[(e(!0),t(p,null,m(n.doors,(l,_)=>{var h;return e(),t("div",{onClick:y=>s.selectDoor(_),class:g([{"border-black":s.selected_index===_},"card btn btn-light text-left p-0 rounded-0 mb-2 cursor-pointer"])},[o("div",Kt,[o("h6",Qt,d(l.door.purpose||"-")+": "+d(l.door.door_type.title)+" "+d(l.door.width)+"x"+d(l.door.height)+"x "+d(((h=l.door.opening_type)==null?void 0:h.depth)||0),1),o("h6",Xt,[l.door.box_and_frame_color.title?(e(),t("span",Yt,"("+d(l.door.box_and_frame_color.title)+")",1)):i("",!0),a(" лицо "),l.door.front_side_finish.title?(e(),t("span",Zt,d(l.door.front_side_finish.title),1)):i("",!0),a("/ "),l.door.back_side_finish.title?(e(),t("span",xt,d(l.door.back_side_finish.title)+",",1)):i("",!0),a(" петли "),l.door.loops.title?(e(),t("span",ol,d(l.door.loops.title)+",",1)):i("",!0),l.door.hinge_manufacturer.title?(e(),t("span",sl,d(l.door.hinge_manufacturer.title)+",",1)):i("",!0),l.door.fittings_color.title?(e(),t("span",el,"("+d(l.door.fittings_color.title)+"),",1)):i("",!0),l.door.opening_type.title?(e(),t("span",tl,d(l.door.opening_type.title)+",",1)):i("",!0),l.door.handle_holes.title?(e(),t("span",ll,d(l.door.handle_holes.title)+",",1)):i("",!0),l.door.need_automatic_doorstep?(e(),t("span",dl," автоматический порожек,")):i("",!0),l.door.need_upper_jumper?(e(),t("span",il," верхняя перемычка,")):i("",!0),l.door.need_handle_holes?(e(),t("span",nl," дверная ручка,")):i("",!0),l.door.handle_holes_type.title?(e(),t("span",rl,d(l.door.handle_holes_type.title)+",",1)):i("",!0),l.door.handle_holes.title?(e(),t("span",al,d(l.door.handle_holes.title)+",",1)):i("",!0),l.door.need_hidden_door_closer?(e(),t("span",cl," скрытый доводчик,")):i("",!0),l.door.need_hidden_skirting_board?(e(),t("span",_l," скрытый плинтус,")):i("",!0),l.door.need_hidden_stopper?(e(),t("span",hl," скрытый стопор,")):i("",!0),l.door.need_door_install?(e(),t("span",ul," установка двери")):i("",!0)])])],10,At)}),256))])):i("",!0),s.cart_tab===1?(e(),t("div",pl,[V(Et,{onBack:r[1]||(r[1]=l=>s.cart_tab=0),order:n.order,doors:n.doors},null,8,["order","doors"])])):i("",!0),s.cart_tab===0?(e(),t("div",bl,[o("button",{type:"button",onClick:r[2]||(r[2]=l=>s.cart_tab=1),class:"btn btn-outline-dark p-3 w-100 rounded-0"},"Редактировать параметры заказа")])):i("",!0)])],64))}});export{$l as _};
