import{o as r,c as n,b as e,p as a,e as c,f as d,j as p,t as h,g as f,v as u,F as g}from"./app-Dewx7fOe.js";import{_ as b}from"./_plugin-vue_export-helper-DlAUqK2U.js";const y={data(){return{timer:null,affected:null,generateForm:{base_width:0,base_height:0,base_koef:0,base_loops:0,base_price:0,width_step:0,height_step:0,koef_step:0,loops_step:0,price_step:0,selected_material:null,steps:0},need_import_from_google:!1,importGoogleForm:{sheet_id:null,use_price_koef:!1,need_rewrite:!0},importForm:{need_rewrite:!0,use_price_koef:!1,files:[]},recountForm:{selected_material:null,need_recount_by_width:!1,need_recount_by_height:!1,base_width:null,base_height:null,recount_price:null},confirmModal:null,importPricesModal:null}},mounted(){this.confirmModal=new bootstrap.Modal(document.getElementById("confirm-modal"),{}),this.importPricesModal=new bootstrap.Modal(document.getElementById("import-prices-form"),{}),this.importGoogleForm.sheet_id=localStorage.getItem("google_excel_export_sheet_id")||null},methods:{openConfirmModal(){this.confirmModal.show()},onChangeFile(l){const t=l.target.files;for(let i=0;i<t.length;i++)this.importForm.files.push(t[i])},saveFormattedSizes(){this.$store.dispatch("updatedFormattedSizes").then(l=>{this.confirmModal.hide(),window.dispatchEvent(new CustomEvent("load-sizes",{detail:null})),this.$notify({title:"DoDoors",text:"Вы успешно обновили данные"}),window.location.reload()}).catch(()=>{this.$notify({title:"DoDoors",text:"Ошибка обновления данных",type:"error"}),window.location.reload()})},openImportFormModal(){this.importPricesModal.show()},importFromGoogleSubmit(){let l=new FormData;localStorage.setItem("google_excel_export_sheet_id",this.importGoogleForm.sheet_id),this.timer=0;let t=setInterval(()=>{this.timer++},1e3);Object.keys(this.importGoogleForm).forEach(i=>{const _=this.importGoogleForm[i]||"";typeof _=="object"?l.append(i,JSON.stringify(_)):l.append(i,_)}),this.$store.dispatch("importSizesFromGoogle",{importForm:l}).then(i=>{window.open(i.url,"_blank").focus(),window.dispatchEvent(new CustomEvent("load-sizes",{detail:null})),this.importPricesModal.hide(),this.$notify({title:"DoDoors",text:"Вы успешно загрузили данные"}),clearInterval(t),this.timer=null,this.confirmModal.show()}).catch(()=>{clearInterval(t),this.timer=null,this.$notify({title:"DoDoors",text:"Ошибка загрузки данных",type:"error"})})},importSubmit(){let l=new FormData;this.timer=0;let t=setInterval(()=>{this.timer++},1e3);if(Object.keys(this.importForm).forEach(i=>{const _=this.importForm[i]||"";typeof _=="object"?l.append(i,JSON.stringify(_)):l.append(i,_)}),this.importForm.files.length>0){l.delete("files");for(let i=0;i<this.importForm.files.length;i++)l.append("files[]",this.importForm.files[i])}this.$store.dispatch("importSizes",{importForm:l}).then(i=>{window.dispatchEvent(new CustomEvent("load-sizes",{detail:null})),this.importPricesModal.hide(),this.$notify({title:"DoDoors",text:"Вы успешно загрузили данные"}),clearInterval(t),this.timer=null,this.confirmModal.show()}).catch(()=>{clearInterval(t),this.timer=null,this.$notify({title:"DoDoors",text:"Ошибка загрузки данных",type:"error"})})}}},v={class:"row"},x={class:"col-12 d-flex"},w={class:"dropdown mb-2"},k=e("button",{class:"btn btn-outline-secondary dropdown-toggle w-100 rounded-0 p-3",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-bars mr-2"}),d("Управление разделом ")],-1),F={class:"dropdown-menu rounded-0"},j=e("li",null,[e("a",{class:"dropdown-item",href:"/sizes/export-prices"},"Скачать шаблон таблицы")],-1),C={class:"modal fade",id:"import-prices-form",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},M={class:"modal-dialog"},G={class:"modal-content rounded-0"},S=e("div",{class:"modal-header"},[e("h1",{class:"modal-title fs-5",id:"exampleModalLabel"},"Форма загрузки таблицы"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),D={class:"modal-body"},E={class:"row mb-3"},I={class:"col"},z={class:"card-body d-flex justify-content-center align-items-center text-center cursor-pointer"},N={style:{"line-height":"100%"},class:"d-flex justify-content-center align-items-center text-center mb-0"},O={key:0,class:"fa-solid fa-check mr-2"},P={class:"col"},B={class:"card-body d-flex justify-content-center align-items-center text-center cursor-pointer"},J={style:{"line-height":"100%"},class:"d-flex justify-content-center align-items-center text-center mb-0"},T={key:0,class:"fa-solid fa-check mr-2"},V={class:"row mb-3"},L={class:"col"},U={class:"card-body cursor-pointer d-flex justify-content-center align-items-center"},q={style:{"line-height":"100%"},class:"d-flex justify-content-center align-items-center text-center mb-0"},A={key:0,class:"fa-solid fa-check mr-2"},H={class:"col"},K={class:"card-body d-flex justify-content-center align-items-center text-center cursor-pointer"},Q={style:{"line-height":"100%"},class:"d-flex justify-content-center align-items-center text-center mb-0"},R={key:0,class:"fa-solid fa-check mr-2"},W={class:"row mb-3"},X={class:"col"},Y={class:"card-body d-flex justify-content-center align-items-center text-center cursor-pointer"},Z={style:{"line-height":"100%"},class:"d-flex justify-content-center align-items-center text-center mb-0"},$={key:0,class:"fa-solid fa-check mr-2"},ee={class:"col"},te={class:"card-body d-flex justify-content-center align-items-center text-center cursor-pointer"},oe={style:{"line-height":"100%"},class:"d-flex justify-content-center align-items-center text-center mb-0"},se={key:0,class:"fa-solid fa-check mr-2"},ie={class:"form-floating my-3 border-gray-100 border"},re=e("label",{for:"excel-file-for-import"},"Файл-эксель",-1),ne=["disabled"],le={key:0},de={class:"row mb-3"},ce={class:"col"},me={class:"card-body d-flex justify-content-center align-items-center text-center cursor-pointer"},ae={style:{"line-height":"100%"},class:"d-flex justify-content-center align-items-center text-center mb-0"},_e={key:0,class:"fa-solid fa-check mr-2"},pe={class:"col"},he={class:"card-body d-flex justify-content-center align-items-center text-center cursor-pointer"},fe={style:{"line-height":"100%"},class:"d-flex justify-content-center align-items-center text-center mb-0"},ue={key:0,class:"fa-solid fa-check mr-2"},ge={class:"row mb-3"},be={class:"col"},ye={class:"card-body d-flex justify-content-center align-items-center text-center cursor-pointer"},ve={style:{"line-height":"100%"},class:"d-flex justify-content-center align-items-center text-center mb-0"},xe={key:0,class:"fa-solid fa-check mr-2"},we={class:"col"},ke={class:"card-body d-flex justify-content-center align-items-center text-center cursor-pointer"},Fe={style:{"line-height":"100%"},class:"d-flex justify-content-center align-items-center text-center mb-0"},je={key:0,class:"fa-solid fa-check mr-2"},Ce={class:"form-floating my-3 border-gray-100 border"},Me=e("label",{for:"sheet-id"},"Идентификатор таблицы",-1),Ge=["disabled"],Se={key:0},De=e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-outline-secondary rounded-0","data-bs-dismiss":"modal"},"Закрыть")],-1),Ee={class:"modal fade",id:"confirm-modal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},Ie={class:"modal-dialog"},ze={class:"modal-content rounded-0"},Ne={class:"modal-body"},Oe=e("p",null,"Вы хотите обновить JSON-файл с размерами?",-1),Pe={class:"row"},Be={class:"col-6"},Je={class:"col-6"};function Te(l,t,i,_,o,m){return r(),n(g,null,[e("div",v,[e("div",x,[e("div",w,[k,e("ul",F,[j,e("li",null,[e("a",{class:"dropdown-item",href:"javascript:void(0)",onClick:t[0]||(t[0]=(...s)=>m.openImportFormModal&&m.openImportFormModal(...s))},"Загрузить данные")]),e("li",null,[e("a",{class:"dropdown-item",href:"javascript:void(0)",onClick:t[1]||(t[1]=(...s)=>m.openConfirmModal&&m.openConfirmModal(...s))},"Обновить JSON")])])])])]),e("div",C,[e("div",M,[e("div",G,[S,e("div",D,[e("div",E,[e("div",I,[e("div",{style:{"min-height":"80px"},onClick:t[2]||(t[2]=s=>o.need_import_from_google=!0),class:a([{"bg-dark text-white":o.need_import_from_google},"card rounded-0"])},[e("div",z,[e("p",N,[o.need_import_from_google?(r(),n("i",O)):c("",!0),d(" Загрузить из Google-таблицы")])])],2)]),e("div",P,[e("div",{style:{"min-height":"80px"},onClick:t[3]||(t[3]=s=>o.need_import_from_google=!1),class:a([{"bg-dark text-white":!o.need_import_from_google},"card rounded-0"])},[e("div",B,[e("p",J,[o.need_import_from_google?c("",!0):(r(),n("i",T)),d(" Загрузить из Excel-файла")])])],2)])]),o.need_import_from_google?(r(),n("form",{key:1,onSubmit:t[15]||(t[15]=p((...s)=>m.importFromGoogleSubmit&&m.importFromGoogleSubmit(...s),["prevent"]))},[e("div",de,[e("div",ce,[e("div",{style:{"min-height":"80px"},onClick:t[10]||(t[10]=s=>o.importGoogleForm.need_rewrite=!0),class:a([{"bg-dark text-white":o.importGoogleForm.need_rewrite},"card rounded-0"])},[e("div",me,[e("p",ae,[o.importGoogleForm.need_rewrite?(r(),n("i",_e)):c("",!0),d(" Перезаписать старые значения")])])],2)]),e("div",pe,[e("div",{style:{"min-height":"80px"},onClick:t[11]||(t[11]=s=>o.importGoogleForm.need_rewrite=!1),class:a([{"bg-dark text-white":!o.importGoogleForm.need_rewrite},"card rounded-0"])},[e("div",he,[e("p",fe,[o.importGoogleForm.need_rewrite?c("",!0):(r(),n("i",ue)),d(" Добавить новые значения")])])],2)])]),e("div",ge,[e("div",be,[e("div",{style:{"min-height":"80px"},onClick:t[12]||(t[12]=s=>o.importGoogleForm.use_price_koef=!0),class:a([{"bg-dark text-white":o.importGoogleForm.use_price_koef},"card rounded-0"])},[e("div",ye,[e("p",ve,[o.importGoogleForm.use_price_koef?(r(),n("i",xe)):c("",!0),d(" Пересчитать по коэффициентам")])])],2)]),e("div",we,[e("div",{style:{"min-height":"80px"},onClick:t[13]||(t[13]=s=>o.importGoogleForm.use_price_koef=!1),class:a([{"bg-dark text-white":!o.importGoogleForm.use_price_koef},"card rounded-0"])},[e("div",ke,[e("p",Fe,[o.importGoogleForm.use_price_koef?c("",!0):(r(),n("i",je)),d(" Записать как есть")])])],2)])]),e("div",Ce,[f(e("input",{type:"text",class:"form-control","onUpdate:modelValue":t[14]||(t[14]=s=>o.importGoogleForm.sheet_id=s),id:"sheet-id",placeholder:"name@example.com"},null,512),[[u,o.importGoogleForm.sheet_id]]),Me]),e("button",{type:"submit",disabled:o.timer!=null,class:"btn btn-dark rounded-0 w-100 p-3"},[d("Загрузить "),o.timer!=null?(r(),n("span",Se,h(o.timer)+" сек",1)):c("",!0)],8,Ge)],32)):(r(),n("form",{key:0,onSubmit:t[9]||(t[9]=p((...s)=>m.importSubmit&&m.importSubmit(...s),["prevent"]))},[e("div",V,[e("div",L,[e("div",{style:{"min-height":"80px"},onClick:t[4]||(t[4]=s=>o.importForm.need_rewrite=!0),class:a([{"bg-dark text-white":o.importForm.need_rewrite},"card rounded-0"])},[e("div",U,[e("p",q,[o.importForm.need_rewrite?(r(),n("i",A)):c("",!0),d("Перезаписать старые значения")])])],2)]),e("div",H,[e("div",{style:{"min-height":"80px"},onClick:t[5]||(t[5]=s=>o.importForm.need_rewrite=!1),class:a([{"bg-dark text-white":!o.importForm.need_rewrite},"card rounded-0"])},[e("div",K,[e("p",Q,[o.importForm.need_rewrite?c("",!0):(r(),n("i",R)),d(" Добавить новые значения")])])],2)])]),e("div",W,[e("div",X,[e("div",{style:{"min-height":"80px"},onClick:t[6]||(t[6]=s=>o.importForm.use_price_koef=!0),class:a([{"bg-dark text-white":o.importForm.use_price_koef},"card rounded-0"])},[e("div",Y,[e("p",Z,[o.importForm.use_price_koef?(r(),n("i",$)):c("",!0),d(" Пересчитать по коэффициентам")])])],2)]),e("div",ee,[e("div",{style:{"min-height":"80px"},onClick:t[7]||(t[7]=s=>o.importForm.use_price_koef=!1),class:a([{"bg-dark text-white":!o.importForm.use_price_koef},"card rounded-0"])},[e("div",te,[e("p",oe,[o.importForm.use_price_koef?c("",!0):(r(),n("i",se)),d(" Записать как есть")])])],2)])]),e("div",ie,[e("input",{type:"file",class:"form-control",accept:".csv, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel",id:"excel-file-for-import",ref:"importPriceFromExcel",onChange:t[8]||(t[8]=s=>m.onChangeFile(s))},null,544),re]),e("button",{type:"submit",disabled:o.timer!=null,class:"btn btn-dark rounded-0 w-100 p-3"},[d("Загрузить "),o.timer!=null?(r(),n("span",le,h(o.timer)+" сек",1)):c("",!0)],8,ne)],32))]),De])])]),e("div",Ee,[e("div",Ie,[e("div",ze,[e("div",Ne,[Oe,e("div",Pe,[e("div",Be,[e("button",{class:"btn btn-dark rounded-0 w-100",type:"button",onClick:t[16]||(t[16]=(...s)=>m.saveFormattedSizes&&m.saveFormattedSizes(...s))},"Да, продолжить ")]),e("div",Je,[e("button",{class:"btn btn-outline-secondary rounded-0 w-100",onClick:t[17]||(t[17]=s=>o.confirmModal.hide())},"Нет, отменить ")])])])])])])],64)}const Ue=b(y,[["render",Te]]);export{Ue as S};
