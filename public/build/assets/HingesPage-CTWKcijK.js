import{_ as w}from"./AuthenticatedLayout-BF5q2yhP.js";import{o,c as n,b as e,f as m,v as _,F as p,r as v,e as d,i as h,j as $,t as u,m as H,d as g,l as C,a as f,u as j,w as b,Z as F}from"./app-CVZ-3-e_.js";import{P as V}from"./Pagination-D2K4Aw9P.js";import{_ as I}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ApplicationLogo-BVqzOZzU.js";import"./vue-the-mask-CRw-LUie.js";const L={props:["item"],data(){return{messages:[],loading:!1,form:{id:null,title:null,price:{wholesale:0,dealer:0,retail:0,cost:0}}}},computed:{needClearForm(){return this.form.id||this.form.title||this.form.price}},mounted(){this.item&&this.$nextTick(()=>{this.form={id:this.item.id||null,title:this.item.title||null,price:this.item.price||{wholesale:0,dealer:0,retail:0,cost:0}}})},methods:{alert(s){this.messages.push(s)},resetForm(){this.form.id=null,this.form.title=null,this.form.price={wholesale:0,dealer:0,retail:0,cost:0},this.$emit("callback")},removeMessage(s){this.messages.splice(s,1)},submit(){let s=new FormData;Object.keys(this.form).forEach(t=>{const l=this.form[t]||"";typeof l=="object"?s.append(t,JSON.stringify(l)):s.append(t,l)}),this.$store.dispatch("storeHinge",{hingeForm:s}).then(t=>{this.$emit("callback"),this.$store.dispatch("updatedFormattedSizes").then(l=>{window.dispatchEvent(new CustomEvent("load-sizes",{detail:null})),this.$notify({title:"DoDoors",text:"Вы успешно обновили данные"})}),this.resetForm()}).catch(t=>{})}}},A={class:"form-floating mb-3"},O=e("label",{for:"hinge-title"},"Наименование производителя петель",-1),P={class:"card rounded-0 mb-3 border-black"},S=e("div",{class:"card-header bg-dark text-white rounded-0"},[e("h6",null,"Настройка цены")],-1),T={class:"card-body"},M={class:"row"},N={class:"col-6"},U={class:"form-floating mb-3"},q=e("label",{for:"price-wholesale"},"Опт",-1),x={class:"col-6"},B={class:"form-floating mb-3"},D=e("label",{for:"price-retail"},"Розница",-1),E={class:"col-6"},z={class:"form-floating"},G=e("label",{for:"price-dealer"},"Дилер",-1),J={class:"col-6"},Z={class:"form-floating"},K=e("label",{for:"price-cost"},"Себестоимость",-1),Q={class:"row"},R={class:"col-12"},W={class:"alert alert-danger alert-dismissible fade show",role:"alert"},X=e("strong",null,"Внимание!",-1),Y=["onClick"],ee={class:"row mt-5"},te={class:"col-12 d-flex justify-content-center"},se=["disabled"],oe={key:0,class:"fa-regular fa-floppy-disk mr-1"},ie={key:1,class:"spinner-border spinner-border-sm text-success",role:"status"},le=e("i",{class:"fa-solid fa-xmark mr-1"},null,-1);function ne(s,t,l,a,i,c){return o(),n("form",{action:"",onSubmit:t[6]||(t[6]=$((...r)=>c.submit&&c.submit(...r),["prevent"]))},[e("div",A,[m(e("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=r=>i.form.title=r),class:"form-control",id:"hinge-title",required:""},null,512),[[_,i.form.title]]),O]),e("div",P,[S,e("div",T,[e("div",M,[e("div",N,[e("div",U,[m(e("input",{type:"number","onUpdate:modelValue":t[1]||(t[1]=r=>i.form.price.wholesale=r),class:"form-control",id:"price-wholesale",required:""},null,512),[[_,i.form.price.wholesale]]),q])]),e("div",x,[e("div",B,[m(e("input",{type:"number","onUpdate:modelValue":t[2]||(t[2]=r=>i.form.price.retail=r),class:"form-control",id:"price-retail",required:""},null,512),[[_,i.form.price.retail]]),D])]),e("div",E,[e("div",z,[m(e("input",{type:"number","onUpdate:modelValue":t[3]||(t[3]=r=>i.form.price.dealer=r),class:"form-control",id:"price-dealer",required:""},null,512),[[_,i.form.price.dealer]]),G])]),e("div",J,[e("div",Z,[m(e("input",{type:"number","onUpdate:modelValue":t[4]||(t[4]=r=>i.form.price.cost=r),class:"form-control",id:"price-cost",required:""},null,512),[[_,i.form.price.cost]]),K])])])])]),e("div",Q,[e("div",R,[i.messages.length>0?(o(!0),n(p,{key:0},v(i.messages,(r,k)=>(o(),n("div",W,[X,h(" "+u(r||"Ошибка")+" ",1),e("button",{type:"button",class:"btn-close",onClick:vt=>c.removeMessage(k)},null,8,Y)]))),256)):d("",!0)])]),e("div",ee,[e("div",te,[e("button",{disabled:!c.needClearForm,class:"btn btn-dark rounded-0"},[i.loading?(o(),n("span",ie)):(o(),n("i",oe)),h(" Сохранить производителя петель ")],8,se),c.needClearForm&&!i.loading?(o(),n("button",{key:0,type:"button",onClick:t[5]||(t[5]=(...r)=>c.resetForm&&c.resetForm(...r)),class:"btn btn-outline-secondary rounded-0 ml-2"},[le,h(" Очистить форму ")])):d("",!0)])])],32)}const y=I(L,[["render",ne]]),re={class:"row"},de={class:"col-12"},ae={class:"input-group mb-3"},ce={class:"form-floating"},he=e("label",{for:"search-hinges"},"Поиск по производителям петель",-1),ue=e("i",{class:"fa-solid fa-magnifying-glass"},null,-1),me=[ue],_e={style:{"overflow-y":"auto"}},pe={key:0,class:"table"},ge={key:0},fe=e("i",{class:"fa-solid fa-caret-down"},null,-1),be=[fe],ve={key:1},ye=e("i",{class:"fa-solid fa-caret-up"},null,-1),ke=[ye],we=e("th",{scope:"col",class:"text-center"},"Действие",-1),$e={key:0},He=e("i",{class:"fa-solid fa-caret-down"},null,-1),Ce=[He],je={key:1},Fe=e("i",{class:"fa-solid fa-caret-up"},null,-1),Ve=[Fe],Ie={key:0},Le=e("i",{class:"fa-solid fa-caret-down"},null,-1),Ae=[Le],Oe={key:1},Pe=e("i",{class:"fa-solid fa-caret-up"},null,-1),Se=[Pe],Te=C('<table class="w-100"><thead><th style="width:100px;">опт</th><th style="width:100px;">дилер</th><th style="width:100px;">розница</th><th style="width:100px;">себестоимость</th></thead></table>',1),Me={scope:"row"},Ne={class:"text-center"},Ue={class:"dropdown"},qe=e("button",{class:"btn btn-link",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-bars"})],-1),xe={class:"dropdown-menu"},Be=["onClick"],De=e("i",{class:"fa-solid fa-pen mr-2"},null,-1),Ee=["onClick"],ze=e("i",{class:"fa-solid fa-trash-can mr-2"},null,-1),Ge=["onClick"],Je={class:"text-center"},Ze={class:"w-100"},Ke={style:{width:"100px","text-align":"center"}},Qe={style:{width:"100px","text-align":"center"}},Re={style:{width:"100px","text-align":"center"}},We={style:{width:"100px","text-align":"center"}},Xe={key:0,class:"alert alert-success",role:"alert"},Ye=e("h4",{class:"alert-heading"},"Петли",-1),et=e("p",null,"К сожалению, раздел петель пуст. Вы еще не добавили ни одного производителя петель, которые можно отобразить на этой странице.",-1),tt=e("hr",null,null,-1),st=e("p",{class:"mb-0"},"Воспользуйтесь формой выше и добавьте своего первого производителя петель",-1),ot=[Ye,et,tt,st],it={key:1,class:"row mb-3"},lt={class:"col-12"},nt={class:"modal fade",id:"hinges-editor-modal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},rt={class:"modal-dialog modal-lg"},dt={class:"modal-content rounded-0"},at={class:"modal-body"},ct={data(){return{editor_modal:null,selected_item:null,sort:{column:null,direction:"desc"},search:null,current_page:0,paginate_object:null,items:[{id:null,title:null,price:0}]}},computed:{...H(["getHinges","getHingesPaginateObject"])},mounted(){this.loadHinges(),this.editor_modal=new bootstrap.Modal(document.getElementById("hinges-editor-modal"),{})},methods:{sortAndLoad(s){this.sort.column=s,this.sort.direction=this.sort.direction==="desc"?"asc":"desc",this.loadHinges(this.current_page)},loadHinges(s=0){this.current_page=s,this.$store.dispatch("loadHinges",{dataObject:{search:this.search,order:this.sort.column,direction:this.sort.direction},page:this.current_page}).then(t=>{this.items=this.getHinges,this.paginate_object=this.getHingesPaginateObject}).catch(()=>{this.loading=!1})},selectItem(s){if(s==null){this.selected_item=null,this.editor_modal.hide();return}this.selected_item=null,this.$nextTick(()=>{this.selected_item=s,this.editor_modal.show()})},duplicateItem(s){this.$store.dispatch("duplicateHinge",{hingeId:s}).then(()=>{this.sortAndLoad("id")})},removeItem(s){this.$store.dispatch("removeHinge",{hingeId:s}).then(()=>{this.sortAndLoad("id")})}}},ht=Object.assign(ct,{__name:"HingeTable",setup(s){return(t,l)=>(o(),n(p,null,[e("form",re,[e("div",de,[e("div",ae,[e("div",ce,[m(e("input",{type:"search","onUpdate:modelValue":l[0]||(l[0]=a=>t.search=a),class:"form-control",id:"search-hinges"},null,512),[[_,t.search]]),he]),e("button",{type:"button",onClick:l[1]||(l[1]=a=>t.sortAndLoad("id")),class:"btn btn-outline-secondary rounded-0"},me)])])]),e("div",_e,[t.items.length>0?(o(),n("table",pe,[e("thead",null,[e("tr",null,[e("th",{scope:"col",class:"cursor-pointer",onClick:l[2]||(l[2]=a=>t.sortAndLoad("id"))},[h("# "),t.sort.direction==="desc"&&t.sort.column==="id"?(o(),n("span",ge,be)):d("",!0),t.sort.direction==="asc"&&t.sort.column==="id"?(o(),n("span",ve,ke)):d("",!0)]),we,e("th",{scope:"col",class:"text-center cursor-pointer",onClick:l[3]||(l[3]=a=>t.sortAndLoad("title"))},[h("Название "),t.sort.direction==="desc"&&t.sort.column==="title"?(o(),n("span",$e,Ce)):d("",!0),t.sort.direction==="asc"&&t.sort.column==="title"?(o(),n("span",je,Ve)):d("",!0)]),e("th",{scope:"col",class:"text-center cursor-pointer",onClick:l[4]||(l[4]=a=>t.sortAndLoad("price"))},[h("Цена,₽ "),t.sort.direction==="desc"&&t.sort.column==="price"?(o(),n("span",Ie,Ae)):d("",!0),t.sort.direction==="asc"&&t.sort.column==="price"?(o(),n("span",Oe,Se)):d("",!0),Te])])]),e("tbody",null,[(o(!0),n(p,null,v(t.items,(a,i)=>(o(),n("tr",null,[e("th",Me,u(a.id||i),1),e("td",Ne,[e("div",Ue,[qe,e("ul",xe,[e("li",null,[e("a",{class:"dropdown-item",onClick:c=>t.selectItem(a),href:"javascript:void(0)"},[De,h("Редактировать")],8,Be)]),e("li",null,[e("a",{class:"dropdown-item text-danger",onClick:c=>t.removeItem(a.id),href:"javascript:void(0)"},[ze,h("Удалить")],8,Ee)])])])]),e("td",{class:"text-center",onClick:c=>t.selectItem(a)},u(a.title||"-"),9,Ge),e("td",Je,[e("table",Ze,[e("tbody",null,[e("tr",null,[e("td",Ke,u(t.items[i].price.wholesale||0),1),e("td",Qe,u(t.items[i].price.dealer||0),1),e("td",Re,u(t.items[i].price.retail||0),1),e("td",We,u(t.items[i].price.cost||0),1)])])])])]))),256))])])):d("",!0)]),t.items.length===0?(o(),n("div",Xe,ot)):d("",!0),t.items.length>0?(o(),n("div",it,[e("div",lt,[t.paginate_object?(o(),g(V,{key:0,onPagination_page:t.loadHinges,pagination:t.paginate_object},null,8,["onPagination_page","pagination"])):d("",!0)])])):d("",!0),e("div",nt,[e("div",rt,[e("div",dt,[e("div",at,[t.selected_item?(o(),g(y,{key:0,item:t.selected_item,onCallback:l[5]||(l[5]=a=>t.selectItem(null))},null,8,["item"])):d("",!0)])])])])],64))}}),ut=e("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"},"Петли",-1),mt={class:"py-12"},_t={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},pt={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},gt={class:"p-6 text-gray-900"},ft=e("hr",{class:"hr my-5"},null,-1),bt={data(){return{loading:!1,selectedHinge:null}},methods:{selectHinge(s){this.selectedHinge=s,this.loading=!0,this.$nextTick(()=>{this.loading=!1})},callbackHingeForm(){this.loading=!0,this.selectedHinge=null,this.$nextTick(()=>{this.loading=!1})}}},jt=Object.assign(bt,{__name:"HingesPage",setup(s){return(t,l)=>(o(),n(p,null,[f(j(F),{title:"Петли"}),f(w,null,{header:b(()=>[ut]),default:b(()=>[e("div",mt,[e("div",_t,[e("div",pt,[e("div",gt,[t.loading?d("",!0):(o(),g(y,{key:0,item:t.selectedHinge,onCallback:t.callbackHingeForm},null,8,["item","onCallback"])),ft,t.loading?d("",!0):(o(),g(ht,{key:1,onSelect:t.selectHinge},null,8,["onSelect"]))])])])])]),_:1})],64))}});export{jt as default};
