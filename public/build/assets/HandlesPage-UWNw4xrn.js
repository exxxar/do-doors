import{_ as C}from"./AuthenticatedLayout-6ypEtMm1.js";import{k as H,o as i,c as n,b as e,g as h,v as p,n as k,e as d,F as _,r as b,f as m,j as $,a as v,t as u,m as j,d as g,l as x,p as f,u as I,w,Z as M}from"./app-YZRH68sT.js";import{P as D}from"./Pagination-iosrvHgU.js";import{R as S}from"./RalColorSelector-Civt6WOF.js";import{H as E}from"./HandleDetail-CcwWMjFZ.js";import{_ as G}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ApplicationLogo-6QMNzGz8.js";import"./vue-the-mask-IigEC89I.js";const L={class:"form-floating mb-3"},U=e("label",{for:"handle-title"},"Название ручки",-1),V={class:"card rounded-0 mb-3 border-black"},O=e("div",{class:"card-header bg-dark text-white rounded-0"},[e("h6",null,"Настройка цены")],-1),T={class:"card-body"},P={class:"row"},A={class:"col-6"},N={class:"form-floating mb-3"},R=e("label",{for:"price-wholesale"},"Опт",-1),q={class:"col-6"},B={class:"form-floating mb-3"},z=e("label",{for:"price-retail"},"Розница",-1),J={class:"col-6"},W={class:"form-floating"},Z=e("label",{for:"price-dealer"},"Дилер",-1),K={class:"col-6"},Q={class:"form-floating"},X=e("label",{for:"price-cost"},"Себестоимость",-1),Y={class:"input-group mb-3"},ee={class:"form-floating"},te=e("label",{for:"fittings_color"},[e("i",{class:"fa-solid fa-palette"}),m(" Цвет ручки")],-1),oe=e("button",{class:"btn btn-outline-secondary",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-up-right-and-down-left-from-center"})],-1),se={class:"dropdown-menu dropdown-menu-end"},le=e("li",null,[e("hr",{class:"dropdown-divider"})],-1),ie={class:"form-floating mb-3 border-gray-100 border"},ne=e("label",{for:"door-handle"},"Вариант ручки",-1),re={class:"row"},ae={key:0,class:"col-12"},de=e("h6",{class:"font-bold my-3"},"Новые фотографии к ручке",-1),ce=[de],me={class:"col-md-4 mb-2 image-preview d-flex align-items-start"},he={class:"card w-100 rounded-0"},pe={style:{"min-height":"200px"},class:"card-img-top uploaded-image-mini",alt:""},ue={class:"card-body d-flex justify-center"},_e=["onClick"],fe={class:"card-body"},ge={class:"form-floating mb-2"},be=["onUpdate:modelValue"],ve=e("label",{for:"floatingInput"},"Название",-1),ye={class:"form-floating"},$e=["onUpdate:modelValue"],we=e("label",{for:"floatingTextarea"},"Описание",-1),ke={key:2,class:"col-12"},Fe=e("h6",{class:"font-bold my-3"},"Ранее загруженные фотографии к ручке",-1),Ce=[Fe],He={class:"col-md-4 mb-2 image-preview d-flex align-items-start"},je={class:"card w-100"},xe={style:{"min-height":"200px"},class:"card-img-top uploaded-image-mini",alt:""},Ie={class:"card-body d-flex justify-center"},Me=["onClick"],De={class:"card-body"},Se={class:"form-floating mb-3"},Ee=["onUpdate:modelValue"],Ge=e("label",{for:"floatingInput"},"Название",-1),Le={class:"form-floating"},Ue=["onUpdate:modelValue"],Ve=e("label",{for:"floatingTextarea"},"Описание",-1),Oe={class:"row"},Te={class:"col-12"},Pe={class:"alert alert-danger alert-dismissible fade show",role:"alert"},Ae=e("strong",null,"Внимание!",-1),Ne=["onClick"],Re={class:"row mt-5"},qe={class:"col-12 d-flex justify-content-center"},Be=["disabled"],ze={key:0,class:"fa-regular fa-floppy-disk mr-1"},Je={key:1,class:"spinner-border spinner-border-sm text-success",role:"status"},We=e("i",{class:"fa-solid fa-xmark mr-1"},null,-1),Ze={class:"modal fade",id:"choose-color-handle",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},Ke={class:"modal-dialog"},Qe={class:"modal-content"},Xe=e("div",{class:"modal-header"},[e("h1",{class:"modal-title fs-5",id:"exampleModalLabel"},"Выбор цвета RAL"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),Ye={class:"modal-body"},et={props:["item"],data(){return{messages:[],need_import_from_google:!1,uploaded_variants_image:[],loading:!1,colorModal:null,form:{id:null,title:null,price:{wholesale:0,dealer:0,retail:0,cost:0},color:null,variants:[]}}},computed:{needClearForm(){return this.form.id||this.form.title||this.form.price||this.form.color||this.uploaded_variants_image.length>0}},mounted(){this.colorModal=new bootstrap.Modal(document.getElementById("choose-color-handle"),{}),this.item&&this.$nextTick(()=>{this.form={id:this.item.id||null,title:this.item.title||null,price:this.item.price||{wholesale:0,dealer:0,retail:0,cost:0},color:this.item.color||null,variants:this.item.variants||[]}})},methods:{prepareImage(s){return typeof s!="string"||!s.trim()?"/images/default.png":s.startsWith("http://")||s.startsWith("https://")?s:`/images/${s}`},callbackSelectColor(s){this.form.color=s.color.hex,this.colorModal.hide()},selectColor(){this.colorModal.show()},isHex(s){return/^#[0-9A-F]{6}$/i.test(s)},alert(s){this.messages.push(s)},resetForm(){this.uploaded_variants_image=[],this.form.id=null,this.form.title=null,this.form.price={wholesale:0,dealer:0,retail:0,cost:0},this.form.color=null,this.form.variants=[],this.$refs.handleImageRef.value=null,this.$emit("callback")},removeUploadedPhoto(s,t){this.form[s].splice(t,1)},removePhoto(s,t){this[s].splice(t,1)},getPhoto(s){return{imageUrl:URL.createObjectURL(s)}},onChangePhotos(s,t){const o=t.target.files;for(let c=0;c<o.length;c++)this[s].push({image:o[c],title:null,description:null})},removeMessage(s){this.messages.splice(s,1)},submit(){let s=new FormData;if(Object.keys(this.form).forEach(t=>{const o=this.form[t]||"";typeof o=="object"?s.append(t,JSON.stringify(o)):s.append(t,o)}),this.uploaded_variants_image.length>0){for(let t=0;t<this.uploaded_variants_image.length;t++)s.append("uploaded_variants_image[]",this.uploaded_variants_image[t].image),this.uploaded_variants_image[t].image_name=this.uploaded_variants_image[t].image.name||null;s.append("uploaded_image_info",JSON.stringify(this.uploaded_variants_image))}this.$store.dispatch("storeHandle",{handleForm:s}).then(t=>{this.$store.dispatch("updatedFormattedSizes").then(o=>{window.dispatchEvent(new CustomEvent("load-sizes",{detail:null})),window.dispatchEvent(new CustomEvent("load-handles",{detail:null})),this.$notify({title:"DoDoors",text:"Вы успешно обновили данные"})}),this.$emit("callback"),this.resetForm()}).catch(t=>{})},importFromGoogleSubmit(){let s=new FormData;localStorage.setItem("google_excel_handles_export_sheet_id",this.importGoogleForm.sheet_id),this.timer=0;let t=setInterval(()=>{this.timer++},1e3);Object.keys(this.importGoogleForm).forEach(o=>{const c=this.importGoogleForm[o]||"";typeof c=="object"?s.append(o,JSON.stringify(c)):s.append(o,c)}),this.$store.dispatch("importHandlesFromGoogle",{importForm:s}).then(o=>{window.open(o.url,"_blank").focus(),window.dispatchEvent(new CustomEvent("load-handles",{detail:null})),this.importHandlesModal.hide(),this.$notify({title:"DoDoors",text:"Вы успешно загрузили данные"}),clearInterval(t),this.timer=null}).catch(()=>{clearInterval(t),this.timer=null,this.$notify({title:"DoDoors",text:"Ошибка загрузки данных",type:"error"})})},importSubmit(){let s=new FormData;this.timer=0;let t=setInterval(()=>{this.timer++},1e3);if(Object.keys(this.importForm).forEach(o=>{const c=this.importForm[o]||"";typeof c=="object"?s.append(o,JSON.stringify(c)):s.append(o,c)}),this.importForm.files.length>0){s.delete("files");for(let o=0;o<this.importForm.files.length;o++)s.append("files[]",this.importForm.files[o])}this.$store.dispatch("importHandlesFromExcel",{importForm:s}).then(o=>{window.dispatchEvent(new CustomEvent("load-handles",{detail:null})),this.importHandlesModal.hide(),this.$notify({title:"DoDoors",text:"Вы успешно загрузили данные"}),clearInterval(t),this.timer=null}).catch(()=>{clearInterval(t),this.timer=null,this.$notify({title:"DoDoors",text:"Ошибка загрузки данных",type:"error"})})}}},F=Object.assign(et,{__name:"HandleForm",setup(s){return(t,o)=>{const c=H("lazy");return i(),n(_,null,[e("form",{action:"",onSubmit:o[11]||(o[11]=$((...l)=>t.submit&&t.submit(...l),["prevent"]))},[e("div",L,[h(e("input",{type:"text","onUpdate:modelValue":o[0]||(o[0]=l=>t.form.title=l),class:"form-control",id:"handle-title",required:""},null,512),[[p,t.form.title]]),U]),e("div",V,[O,e("div",T,[e("div",P,[e("div",A,[e("div",N,[h(e("input",{type:"number","onUpdate:modelValue":o[1]||(o[1]=l=>t.form.price.wholesale=l),class:"form-control",id:"price-wholesale",required:""},null,512),[[p,t.form.price.wholesale]]),R])]),e("div",q,[e("div",B,[h(e("input",{type:"number","onUpdate:modelValue":o[2]||(o[2]=l=>t.form.price.retail=l),class:"form-control",id:"price-retail",required:""},null,512),[[p,t.form.price.retail]]),z])]),e("div",J,[e("div",W,[h(e("input",{type:"number","onUpdate:modelValue":o[3]||(o[3]=l=>t.form.price.dealer=l),class:"form-control",id:"price-dealer",required:""},null,512),[[p,t.form.price.dealer]]),Z])]),e("div",K,[e("div",Q,[h(e("input",{type:"number","onUpdate:modelValue":o[4]||(o[4]=l=>t.form.price.cost=l),class:"form-control",id:"price-cost",required:""},null,512),[[p,t.form.price.cost]]),X])])])])]),e("div",Y,[t.isHex(t.form.color)?(i(),n("span",{key:0,class:"input-group-text border-secondary rounded-0",style:k([{"background-color":t.form.color},{width:"40px"}]),id:"basic-addon1"},null,4)):d("",!0),e("div",ee,[h(e("input",{type:"text",onInvalid:o[5]||(o[5]=l=>t.alert("Вы не выбрали цвет фурнитуры")),"onUpdate:modelValue":o[6]||(o[6]=l=>t.form.color=l),class:"form-control",id:"fittings_color",required:""},null,544),[[p,t.form.color]]),te]),oe,e("ul",se,[e("li",null,[e("a",{class:"dropdown-item",href:"#",onClick:o[7]||(o[7]=l=>t.form.color=null)},"Не выбрано")]),le,e("li",null,[e("a",{class:"dropdown-item",onClick:o[8]||(o[8]=(...l)=>t.selectColor&&t.selectColor(...l)),href:"javascript:void(0)"},"Цвет RAL")])])]),e("div",ie,[e("input",{type:"file",class:"form-control",accept:"image/*",id:"door-handle",ref:"handleImageRef",onChange:o[9]||(o[9]=l=>t.onChangePhotos("uploaded_variants_image",l)),multiple:""},null,544),ne]),e("div",re,[t.uploaded_variants_image.length>0?(i(),n("div",ae,ce)):d("",!0),t.uploaded_variants_image.length>0?(i(!0),n(_,{key:1},b(t.uploaded_variants_image,(l,r)=>(i(),n("div",me,[e("div",he,[h(e("img",pe,null,512),[[c,t.getPhoto(l.image).imageUrl]]),e("div",ue,[e("a",{href:"javascript:void(0)",class:"text-danger",onClick:a=>t.removePhoto("uploaded_variants_image",r)},"Удалить фото",8,_e)]),e("div",fe,[e("div",ge,[h(e("input",{type:"text","onUpdate:modelValue":a=>t.uploaded_variants_image[r].title=a,class:"form-control border-gray-300 rounded-0",id:"floatingInput",required:""},null,8,be),[[p,t.uploaded_variants_image[r].title]]),ve]),e("div",ye,[h(e("textarea",{class:"form-control rounded-0","onUpdate:modelValue":a=>t.uploaded_variants_image[r].description=a,placeholder:"Leave a comment here",id:"floatingTextarea",required:""},null,8,$e),[[p,t.uploaded_variants_image[r].description]]),we])])])]))),256)):d("",!0),t.form.variants.length>0?(i(),n("div",ke,Ce)):d("",!0),(i(!0),n(_,null,b(t.form.variants,(l,r)=>(i(),n("div",He,[e("div",je,[h(e("img",xe,null,512),[[c,t.prepareImage(l.image)]]),e("div",Ie,[e("a",{href:"javascript:void(0)",class:"text-danger",onClick:a=>t.removeUploadedPhoto("variants",r)},"Удалить",8,Me)]),e("div",De,[e("div",Se,[h(e("input",{type:"text","onUpdate:modelValue":a=>t.form.variants[r].title=a,class:"form-control border-gray-300 rounded-md",id:"floatingInput"},null,8,Ee),[[p,t.form.variants[r].title]]),Ge]),e("div",Le,[h(e("textarea",{class:"form-control","onUpdate:modelValue":a=>t.form.variants[r].description=a,placeholder:"Leave a comment here",id:"floatingTextarea"},null,8,Ue),[[p,t.form.variants[r].description]]),Ve])])])]))),256))]),e("div",Oe,[e("div",Te,[t.messages.length>0?(i(!0),n(_,{key:0},b(t.messages,(l,r)=>(i(),n("div",Pe,[Ae,m(" "+u(l||"Ошибка")+" ",1),e("button",{type:"button",class:"btn-close",onClick:a=>t.removeMessage(r)},null,8,Ne)]))),256)):d("",!0)])]),e("div",Re,[e("div",qe,[e("button",{disabled:!t.needClearForm,class:"btn btn-dark rounded-0"},[t.loading?(i(),n("span",Je)):(i(),n("i",ze)),m(" Сохранить ручку ")],8,Be),t.needClearForm&&!t.loading?(i(),n("button",{key:0,type:"button",onClick:o[10]||(o[10]=(...l)=>t.resetForm&&t.resetForm(...l)),class:"btn btn-outline-secondary rounded-0 ml-2"},[We,m(" Очистить форму ")])):d("",!0)])])],32),e("div",Ze,[e("div",Ke,[e("div",Qe,[Xe,e("div",Ye,[v(S,{onSelect:t.callbackSelectColor},null,8,["onSelect"])])])])])],64)}}}),tt={class:"row"},ot={class:"col-12"},st={class:"input-group mb-3"},lt={class:"form-floating"},it=e("label",{for:"search-handles"},"Поиск по ручкам",-1),nt=e("i",{class:"fa-solid fa-magnifying-glass"},null,-1),rt=[nt],at={style:{"overflow-y":"auto"}},dt={class:"fw-bold m-0"},ct={key:0,class:"table"},mt={key:0},ht=e("i",{class:"fa-solid fa-caret-down"},null,-1),pt=[ht],ut={key:1},_t=e("i",{class:"fa-solid fa-caret-up"},null,-1),ft=[_t],gt=e("th",{scope:"col",class:"text-center"},"Действие",-1),bt={key:0},vt=e("i",{class:"fa-solid fa-caret-down"},null,-1),yt=[vt],$t={key:1},wt=e("i",{class:"fa-solid fa-caret-up"},null,-1),kt=[wt],Ft={key:0},Ct=e("i",{class:"fa-solid fa-caret-down"},null,-1),Ht=[Ct],jt={key:1},xt=e("i",{class:"fa-solid fa-caret-up"},null,-1),It=[xt],Mt=x('<table class="w-100"><thead><th style="width:100px;">опт</th><th style="width:100px;">дилер</th><th style="width:100px;">розница</th><th style="width:100px;">себестоимость</th></thead></table>',1),Dt={key:0},St=e("i",{class:"fa-solid fa-caret-down"},null,-1),Et=[St],Gt={key:1},Lt=e("i",{class:"fa-solid fa-caret-up"},null,-1),Ut=[Lt],Vt=e("th",{scope:"col",class:"text-center"},"Изображения к ручке",-1),Ot={scope:"row"},Tt={class:"text-center"},Pt={class:"dropdown"},At=e("button",{class:"btn btn-link",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-bars"})],-1),Nt={class:"dropdown-menu"},Rt=["onClick"],qt=e("i",{class:"fa-solid fa-info mr-2"},null,-1),Bt=["onClick"],zt=e("i",{class:"fa-solid fa-pen mr-2"},null,-1),Jt=["onClick"],Wt=e("i",{class:"fa-solid fa-trash-can mr-2"},null,-1),Zt=["onClick"],Kt={class:"text-center"},Qt={class:"w-100"},Xt={style:{width:"100px","text-align":"center"}},Yt={style:{width:"100px","text-align":"center"}},eo={style:{width:"100px","text-align":"center"}},to={style:{width:"100px","text-align":"center"}},oo={class:"text-center"},so={class:"d-flex justify-center flex-column align-items-center"},lo={class:"text-center"},io={key:0,class:"alert alert-success",role:"alert"},no=e("h4",{class:"alert-heading"},"Ручки",-1),ro=e("p",null,"К сожалению, раздел ручек пуст. Вы еще не добавили ни одной ручки, которые можно отобразить на этой странице.",-1),ao=e("hr",null,null,-1),co=e("p",{class:"mb-0"},"Воспользуйтесь формой выше и добавьте свою первую ручку",-1),mo=[no,ro,ao,co],ho={key:1,class:"row mb-3"},po={class:"col-12"},uo={class:"modal fade",id:"show-current-handle-details",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},_o={class:"modal-dialog"},fo={class:"modal-content"},go=e("div",{class:"modal-header"},[e("h1",{class:"modal-title fs-5",id:"exampleModalLabel"},"Просмотр деталей"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),bo={class:"modal-body"},vo={class:"modal fade",id:"handle-editor-modal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},yo={class:"modal-dialog modal-lg"},$o={class:"modal-content rounded-0"},wo={class:"modal-body"},ko={data(){return{editor_modal:null,selected_item:null,selectedHandle:null,detailsModal:null,sort:{column:null,direction:"desc"},search:null,current_page:0,paginate_object:null,items:[{id:null,title:null,price:0,variants:[]}]}},computed:{...j(["getHandles","getHandlesPaginateObject"])},mounted(){this.loadHandles(),window.addEventListener("load-handles",()=>{this.loadHandles()}),this.editor_modal=new bootstrap.Modal(document.getElementById("handle-editor-modal"),{}),this.detailsModal=new bootstrap.Modal(document.getElementById("show-current-handle-details"),{})},methods:{showDetails(s){this.selectedHandle=null,this.$nextTick(()=>{this.selectedHandle=s,this.detailsModal.show()})},isHex(s){return/^#[0-9A-F]{6}$/i.test(s)},sortAndLoad(s){this.sort.column=s,this.sort.direction=this.sort.direction==="desc"?"asc":"desc",this.loadHandles(this.current_page)},loadHandles(s=0){this.current_page=s,this.$store.dispatch("loadHandles",{dataObject:{search:this.search,order:this.sort.column,direction:this.sort.direction},page:this.current_page}).then(t=>{this.items=this.getHandles,this.paginate_object=this.getHandlesPaginateObject}).catch(()=>{this.loading=!1})},selectItem(s){if(s==null){this.selected_item=null,this.editor_modal.hide();return}this.selected_item=null,this.$nextTick(()=>{this.selected_item=s,this.editor_modal.show()})},duplicateItem(s){this.$store.dispatch("duplicateHandle",{handleId:s}).then(()=>{this.sortAndLoad("id")})},removeItem(s){this.$store.dispatch("removeHandle",{handleId:s}).then(()=>{this.sortAndLoad("id")})}}},Fo=Object.assign(ko,{__name:"HandleTable",setup(s){return(t,o)=>{var c,l;return i(),n(_,null,[e("form",tt,[e("div",ot,[e("div",st,[e("div",lt,[h(e("input",{type:"search","onUpdate:modelValue":o[0]||(o[0]=r=>t.search=r),class:"form-control",id:"search-handles"},null,512),[[p,t.search]]),it]),e("button",{type:"button",onClick:o[1]||(o[1]=r=>t.sortAndLoad("id")),class:"btn btn-outline-secondary rounded-0"},rt)])])]),e("div",at,[e("p",dt,"Всего элементов: "+u(((l=(c=t.paginate_object)==null?void 0:c.meta)==null?void 0:l.total)||0),1),t.items.length>0?(i(),n("table",ct,[e("thead",null,[e("tr",null,[e("th",{scope:"col",class:"cursor-pointer",onClick:o[2]||(o[2]=r=>t.sortAndLoad("id"))},[m("# "),t.sort.direction==="desc"&&t.sort.column==="id"?(i(),n("span",mt,pt)):d("",!0),t.sort.direction==="asc"&&t.sort.column==="id"?(i(),n("span",ut,ft)):d("",!0)]),gt,e("th",{scope:"col",class:"text-center cursor-pointer",onClick:o[3]||(o[3]=r=>t.sortAndLoad("title"))},[m("Название "),t.sort.direction==="desc"&&t.sort.column==="title"?(i(),n("span",bt,yt)):d("",!0),t.sort.direction==="asc"&&t.sort.column==="title"?(i(),n("span",$t,kt)):d("",!0)]),e("th",{scope:"col",class:"text-center cursor-pointer",onClick:o[4]||(o[4]=r=>t.sortAndLoad("price"))},[m("Цена, ₽ "),t.sort.direction==="desc"&&t.sort.column==="price"?(i(),n("span",Ft,Ht)):d("",!0),t.sort.direction==="asc"&&t.sort.column==="price"?(i(),n("span",jt,It)):d("",!0),Mt]),e("th",{scope:"col",class:"text-center cursor-pointer",onClick:o[5]||(o[5]=r=>t.sortAndLoad("color"))},[m("Цвет "),t.sort.direction==="desc"&&t.sort.column==="color"?(i(),n("span",Dt,Et)):d("",!0),t.sort.direction==="asc"&&t.sort.column==="color"?(i(),n("span",Gt,Ut)):d("",!0)]),Vt])]),e("tbody",null,[(i(!0),n(_,null,b(t.items,(r,a)=>(i(),n("tr",null,[e("th",Ot,u(r.id||a),1),e("td",Tt,[e("div",Pt,[At,e("ul",Nt,[e("li",null,[e("a",{class:"dropdown-item",onClick:y=>t.showDetails(r),href:"javascript:void(0)"},[qt,m("Детали")],8,Rt)]),e("li",null,[e("a",{class:"dropdown-item",onClick:y=>t.selectItem(r),href:"javascript:void(0)"},[zt,m("Редактировать")],8,Bt)]),e("li",null,[e("a",{class:"dropdown-item text-danger",onClick:y=>t.removeItem(r.id),href:"javascript:void(0)"},[Wt,m("Удалить")],8,Jt)])])])]),e("td",{class:"text-center",onClick:y=>t.selectItem(r)},u(r.title||"-"),9,Zt),e("td",Kt,[e("table",Qt,[e("tbody",null,[e("tr",null,[e("td",Xt,u(t.items[a].price.wholesale||0),1),e("td",Yt,u(t.items[a].price.dealer||0),1),e("td",eo,u(t.items[a].price.retail||0),1),e("td",to,u(t.items[a].price.cost||0),1)])])])]),e("td",oo,[e("div",so,[e("p",null,u(r.color??"-"),1),t.isHex(r.color)?(i(),n("span",{key:0,class:"d-block shadow-md mt-1",style:k([{"background-color":r.color},{width:"50px",height:"50px"}])},null,4)):d("",!0)])]),e("td",lo,u(r.variants.length),1)]))),256))])])):d("",!0)]),t.items.length===0?(i(),n("div",io,mo)):d("",!0),t.items.length>0?(i(),n("div",ho,[e("div",po,[t.paginate_object?(i(),g(D,{key:0,onPagination_page:t.loadHandles,pagination:t.paginate_object},null,8,["onPagination_page","pagination"])):d("",!0)])])):d("",!0),e("div",uo,[e("div",_o,[e("div",fo,[go,e("div",bo,[t.selectedHandle?(i(),g(E,{key:0,"selected-handle":t.selectedHandle},null,8,["selected-handle"])):d("",!0)])])])]),e("div",vo,[e("div",yo,[e("div",$o,[e("div",wo,[t.selected_item?(i(),g(F,{key:0,item:t.selected_item,onCallback:o[6]||(o[6]=r=>t.selectItem(null))},null,8,["item"])):d("",!0)])])])])],64)}}}),Co={props:["item"],data(){return{need_import_from_google:!1,uploaded_variants_image:[],timer:null,importHandlesModal:null,importGoogleForm:{sheet_id:null,part:"handles",need_rewrite:!0},importForm:{files:[],need_rewrite:!0}}},mounted(){this.importHandlesModal=new bootstrap.Modal(document.getElementById("import-handles-form"),{}),this.importGoogleForm.sheet_id=localStorage.getItem("google_excel_handles_export_sheet_id")||null},methods:{onChangeFile(s){const t=s.target.files;for(let o=0;o<t.length;o++)this.importForm.files.push(t[o])},openImportFormModal(){this.importHandlesModal.show()},importFromGoogleSubmit(){let s=new FormData;localStorage.setItem("google_excel_handles_export_sheet_id",this.importGoogleForm.sheet_id),this.timer=0;let t=setInterval(()=>{this.timer++},1e3);Object.keys(this.importGoogleForm).forEach(o=>{const c=this.importGoogleForm[o]||"";typeof c=="object"?s.append(o,JSON.stringify(c)):s.append(o,c)}),this.$store.dispatch("importHandlesFromGoogle",{importForm:s}).then(o=>{window.open(o.url,"_blank").focus(),window.dispatchEvent(new CustomEvent("load-handles",{detail:null})),this.importHandlesModal.hide(),this.$notify({title:"DoDoors",text:"Вы успешно загрузили данные"}),clearInterval(t),this.timer=null}).catch(()=>{clearInterval(t),this.timer=null,this.$notify({title:"DoDoors",text:"Ошибка загрузки данных",type:"error"})})},importSubmit(){let s=new FormData;this.timer=0;let t=setInterval(()=>{this.timer++},1e3);if(Object.keys(this.importForm).forEach(o=>{const c=this.importForm[o]||"";typeof c=="object"?s.append(o,JSON.stringify(c)):s.append(o,c)}),this.importForm.files.length>0){s.delete("files");for(let o=0;o<this.importForm.files.length;o++)s.append("files[]",this.importForm.files[o])}this.$store.dispatch("importHandlesFromExcel",{importForm:s}).then(o=>{window.dispatchEvent(new CustomEvent("load-handles",{detail:null})),this.importHandlesModal.hide(),this.$notify({title:"DoDoors",text:"Вы успешно загрузили данные"}),clearInterval(t),this.timer=null}).catch(()=>{clearInterval(t),this.timer=null,this.$notify({title:"DoDoors",text:"Ошибка загрузки данных",type:"error"})})}}},Ho=e("i",{class:"fa-solid fa-file-import"},null,-1),jo={class:"modal fade",id:"import-handles-form",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},xo={class:"modal-dialog"},Io={class:"modal-content rounded-0"},Mo=e("div",{class:"modal-header"},[e("h1",{class:"modal-title fs-5",id:"exampleModalLabel"},"Форма загрузки таблицы"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),Do={class:"modal-body"},So={class:"row mb-3"},Eo={class:"col"},Go={class:"card-body d-flex justify-content-center align-items-center text-center cursor-pointer"},Lo={style:{"line-height":"100%"},class:"d-flex justify-content-center align-items-center text-center mb-0"},Uo={key:0,class:"fa-solid fa-check mr-2"},Vo={class:"col"},Oo={class:"card-body d-flex justify-content-center align-items-center text-center cursor-pointer"},To={style:{"line-height":"100%"},class:"d-flex justify-content-center align-items-center text-center mb-0"},Po={key:0,class:"fa-solid fa-check mr-2"},Ao={class:"row mb-3"},No={class:"col"},Ro={class:"card-body cursor-pointer d-flex justify-content-center align-items-center"},qo={style:{"line-height":"100%"},class:"d-flex justify-content-center align-items-center text-center mb-0"},Bo={key:0,class:"fa-solid fa-check mr-2"},zo={class:"col"},Jo={class:"card-body d-flex justify-content-center align-items-center text-center cursor-pointer"},Wo={style:{"line-height":"100%"},class:"d-flex justify-content-center align-items-center text-center mb-0"},Zo={key:0,class:"fa-solid fa-check mr-2"},Ko={class:"form-floating my-3 border-gray-100 border"},Qo=e("label",{for:"excel-file-for-import"},"Файл-эксель",-1),Xo=["disabled"],Yo={key:0},es={class:"row mb-3"},ts={class:"col"},os={class:"card-body d-flex justify-content-center align-items-center text-center cursor-pointer"},ss={style:{"line-height":"100%"},class:"d-flex justify-content-center align-items-center text-center mb-0"},ls={key:0,class:"fa-solid fa-check mr-2"},is={class:"col"},ns={class:"card-body d-flex justify-content-center align-items-center text-center cursor-pointer"},rs={style:{"line-height":"100%"},class:"d-flex justify-content-center align-items-center text-center mb-0"},as={key:0,class:"fa-solid fa-check mr-2"},ds={class:"form-floating my-3 border-gray-100 border"},cs=e("label",{for:"sheet-id"},"Идентификатор таблицы",-1),ms=["disabled"],hs={key:0},ps=e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-outline-secondary rounded-0","data-bs-dismiss":"modal"},"Закрыть")],-1);function us(s,t,o,c,l,r){return i(),n(_,null,[e("button",{class:"my-3 p-3 border-gray-100 border btn rounded-0",type:"button",onClick:t[0]||(t[0]=(...a)=>r.openImportFormModal&&r.openImportFormModal(...a))},[Ho,m(" Загрузить данные из таблицы ")]),e("div",jo,[e("div",xo,[e("div",Io,[Mo,e("div",Do,[e("div",So,[e("div",Eo,[e("div",{style:{"min-height":"80px"},onClick:t[1]||(t[1]=a=>l.need_import_from_google=!0),class:f([{"bg-dark text-white":l.need_import_from_google},"card rounded-0"])},[e("div",Go,[e("p",Lo,[l.need_import_from_google?(i(),n("i",Uo)):d("",!0),m(" Загрузить из Google-таблицы")])])],2)]),e("div",Vo,[e("div",{style:{"min-height":"80px"},onClick:t[2]||(t[2]=a=>l.need_import_from_google=!1),class:f([{"bg-dark text-white":!l.need_import_from_google},"card rounded-0"])},[e("div",Oo,[e("p",To,[l.need_import_from_google?d("",!0):(i(),n("i",Po)),m(" Загрузить из Excel-файла")])])],2)])]),l.need_import_from_google?(i(),n("form",{key:1,onSubmit:t[10]||(t[10]=$((...a)=>r.importFromGoogleSubmit&&r.importFromGoogleSubmit(...a),["prevent"]))},[e("div",es,[e("div",ts,[e("div",{style:{"min-height":"80px"},onClick:t[7]||(t[7]=a=>l.importGoogleForm.need_rewrite=!0),class:f([{"bg-dark text-white":l.importGoogleForm.need_rewrite},"card rounded-0"])},[e("div",os,[e("p",ss,[l.importGoogleForm.need_rewrite?(i(),n("i",ls)):d("",!0),m(" Перезаписать старые значения")])])],2)]),e("div",is,[e("div",{style:{"min-height":"80px"},onClick:t[8]||(t[8]=a=>l.importGoogleForm.need_rewrite=!1),class:f([{"bg-dark text-white":!l.importGoogleForm.need_rewrite},"card rounded-0"])},[e("div",ns,[e("p",rs,[l.importGoogleForm.need_rewrite?d("",!0):(i(),n("i",as)),m(" Добавить новые значения")])])],2)])]),e("div",ds,[h(e("input",{type:"text",class:"form-control","onUpdate:modelValue":t[9]||(t[9]=a=>l.importGoogleForm.sheet_id=a),id:"sheet-id",placeholder:"name@example.com"},null,512),[[p,l.importGoogleForm.sheet_id]]),cs]),e("button",{type:"submit",disabled:l.timer!=null,class:"btn btn-dark rounded-0 w-100 p-3"},[m("Загрузить "),l.timer!=null?(i(),n("span",hs,u(l.timer)+" сек",1)):d("",!0)],8,ms)],32)):(i(),n("form",{key:0,onSubmit:t[6]||(t[6]=$((...a)=>r.importSubmit&&r.importSubmit(...a),["prevent"]))},[e("div",Ao,[e("div",No,[e("div",{style:{"min-height":"80px"},onClick:t[3]||(t[3]=a=>l.importForm.need_rewrite=!0),class:f([{"bg-dark text-white":l.importForm.need_rewrite},"card rounded-0"])},[e("div",Ro,[e("p",qo,[l.importForm.need_rewrite?(i(),n("i",Bo)):d("",!0),m("Перезаписать старые значения")])])],2)]),e("div",zo,[e("div",{style:{"min-height":"80px"},onClick:t[4]||(t[4]=a=>l.importForm.need_rewrite=!1),class:f([{"bg-dark text-white":!l.importForm.need_rewrite},"card rounded-0"])},[e("div",Jo,[e("p",Wo,[l.importForm.need_rewrite?d("",!0):(i(),n("i",Zo)),m(" Добавить новые значения")])])],2)])]),e("div",Ko,[e("input",{type:"file",class:"form-control",accept:".csv, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel",id:"excel-file-for-import",ref:"importPriceFromExcel",onChange:t[5]||(t[5]=a=>r.onChangeFile(a))},null,544),Qo]),e("button",{type:"submit",disabled:l.timer!=null,class:"btn btn-dark rounded-0 w-100 p-3"},[m("Загрузить "),l.timer!=null?(i(),n("span",Yo,u(l.timer)+" сек",1)):d("",!0)],8,Xo)],32))]),ps])])])],64)}const _s=G(Co,[["render",us]]),fs=e("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"},"Ручки",-1),gs={class:"py-12"},bs={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},vs={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},ys={class:"p-6 text-gray-900"},$s={key:0,class:"fa-solid fa-file-import"},ws={key:1,class:"spinner-border spinner-border-sm text-primary",role:"status"},ks=e("span",{class:"visually-hidden"},"Loading...",-1),Fs=[ks],Cs=e("hr",{class:"hr my-5"},null,-1),Hs={data(){return{loading:!1,moysklad_loading:!1,selectedHandle:null}},mounted(){this.$store.dispatch("loadRalColors")},methods:{importHandlesFromMoySklad(){this.$notify({title:"DoDoors",text:"Началась загрузка данных"}),this.moysklad_loading=!0,this.$store.dispatch("importHandlesFromMoySklad").then(()=>{this.$notify({title:"DoDoors",text:"Данные успешно загружены",type:"success"}),this.loading=!0,this.$nextTick(()=>{this.loading=!1,this.moysklad_loading=!1})}).catch(()=>{this.$notify({title:"DoDoors",text:"Ошибка загрузки данных",type:"error"}),this.moysklad_loading=!1})},selectHandle(s){this.selectedHandle=s,this.loading=!0,this.$nextTick(()=>{this.loading=!1})},callbackHandleForm(){this.loading=!0,this.selectedHandle=null,this.$nextTick(()=>{this.loading=!1})}}},Ls=Object.assign(Hs,{__name:"HandlesPage",setup(s){return(t,o)=>(i(),n(_,null,[v(I(M),{title:"Ручки"}),v(C,null,{header:w(()=>[fs]),default:w(()=>[e("div",gs,[e("div",bs,[e("div",vs,[e("div",ys,[v(_s),e("button",{class:"my-3 p-3 border-gray-100 border btn rounded-0 mx-2",type:"button",onClick:o[0]||(o[0]=(...c)=>t.importHandlesFromMoySklad&&t.importHandlesFromMoySklad(...c))},[t.moysklad_loading?(i(),n("div",ws,Fs)):(i(),n("i",$s)),m(" Загрузить данные из Мой Склад ")]),t.loading?d("",!0):(i(),g(F,{key:0,item:t.selectedHandle,onCallback:t.callbackHandleForm},null,8,["item","onCallback"])),Cs,t.loading?d("",!0):(i(),g(Fo,{key:1,onSelect:t.selectHandle},null,8,["onSelect"]))])])])])]),_:1})],64))}});export{Ls as default};
