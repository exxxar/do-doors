import{m as p,o as n,c as i,b as t,g as m,v as f,f as d,e as l,F as u,r as k,d as _,t as r}from"./app-CegKs4JJ.js";import{P as g}from"./Pagination-Do3MMCUo.js";import{_ as v}from"./ClientForm-C6sKddSi.js";const y={class:"row"},b={class:"col-12"},C={class:"input-group mb-3"},w={class:"form-floating"},$=t("label",{for:"search-clients"},"Поиск по клиентам",-1),L=t("i",{class:"fa-solid fa-magnifying-glass"},null,-1),A=[L],I={class:"d-flex scrollable-area py-5 mb-3"},j={key:0,class:"table table-responsive"},P={key:0},B=t("i",{class:"fa-solid fa-caret-down"},null,-1),D=[B],O={key:1},T=t("i",{class:"fa-solid fa-caret-up"},null,-1),V=[T],M=t("th",{scope:"col",class:"text-center"},"Действие",-1),N={key:0},S=t("i",{class:"fa-solid fa-caret-down"},null,-1),E=[S],F={key:1},q=t("i",{class:"fa-solid fa-caret-up"},null,-1),G=[q],U={key:0},z=t("i",{class:"fa-solid fa-caret-down"},null,-1),H=[z],J={key:1},K=t("i",{class:"fa-solid fa-caret-up"},null,-1),Q=[K],R={key:0},W=t("i",{class:"fa-solid fa-caret-down"},null,-1),X=[W],Y={key:1},Z=t("i",{class:"fa-solid fa-caret-up"},null,-1),x=[Z],ss={key:0},ts=t("i",{class:"fa-solid fa-caret-down"},null,-1),os=[ts],es={key:1},ns=t("i",{class:"fa-solid fa-caret-up"},null,-1),is=[ns],ls={key:0},ds=t("i",{class:"fa-solid fa-caret-down"},null,-1),as=[ds],rs={key:1},cs=t("i",{class:"fa-solid fa-caret-up"},null,-1),us=[cs],_s={key:0},hs=t("i",{class:"fa-solid fa-caret-down"},null,-1),ps=[hs],ms={key:1},fs=t("i",{class:"fa-solid fa-caret-up"},null,-1),ks=[fs],gs={key:0},vs=t("i",{class:"fa-solid fa-caret-down"},null,-1),ys=[vs],bs={key:1},Cs=t("i",{class:"fa-solid fa-caret-up"},null,-1),ws=[Cs],$s={key:0},Ls=t("i",{class:"fa-solid fa-caret-down"},null,-1),As=[Ls],Is={key:1},js=t("i",{class:"fa-solid fa-caret-up"},null,-1),Ps=[js],Bs={key:0},Ds=t("i",{class:"fa-solid fa-caret-down"},null,-1),Os=[Ds],Ts={key:1},Vs=t("i",{class:"fa-solid fa-caret-up"},null,-1),Ms=[Vs],Ns={key:0},Ss=t("i",{class:"fa-solid fa-caret-down"},null,-1),Es=[Ss],Fs={key:1},qs=t("i",{class:"fa-solid fa-caret-up"},null,-1),Gs=[qs],Us={key:0},zs=t("i",{class:"fa-solid fa-caret-down"},null,-1),Hs=[zs],Js={key:1},Ks=t("i",{class:"fa-solid fa-caret-up"},null,-1),Qs=[Ks],Rs={scope:"row"},Ws={class:"text-center"},Xs={class:"dropdown"},Ys=t("button",{class:"btn btn-link",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[t("i",{class:"fa-solid fa-bars"})],-1),Zs={class:"dropdown-menu"},xs=["onClick"],st=t("i",{class:"fa-solid fa-pen mr-2"},null,-1),tt=["onClick"],ot=t("i",{class:"fa-solid fa-trash-can mr-2"},null,-1),et=["onClick"],nt=["onClick"],it={class:"text-center"},lt={class:"text-center"},dt={class:"text-center"},at={class:"text-center"},rt={class:"text-center"},ct={class:"text-center"},ut={class:"text-center"},_t={class:"text-center"},ht={class:"text-center"},pt={key:0,class:"alert alert-success",role:"alert"},mt=t("h4",{class:"alert-heading"},"Клиенты",-1),ft=t("p",null,"К сожалению, раздел клиентов пуст. Вы еще не добавили ни одного клиента, которых можно отобразить на этой странице.",-1),kt=t("hr",null,null,-1),gt=t("p",{class:"mb-0"},"Воспользуйтесь формой выше и добавьте своего первого клиента",-1),vt=[mt,ft,kt,gt],yt={key:1,class:"row mb-3"},bt={class:"col-12"},Ct={class:"modal fade",id:"client-editor-modal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},wt={class:"modal-dialog modal-lg"},$t={class:"modal-content rounded-0"},Lt={class:"modal-body"},At={data(){return{editor_modal:null,selected_item:null,sort:{column:null,direction:"desc"},search:null,current_page:0,paginate_object:null,statuses:[],items:[{id:null,status:null,phone:null,email:null,fact_address:null,comment:null,user_id:null,title:null,fio:null,law_address:null,inn:null,kpp:null,ogrn:null,okpo:null,requisites:[]}]}},computed:{...p(["getClients","getClientsPaginateObject","getDictionary"])},mounted(){this.loadClients(),this.statuses=this.getDictionary.statuses||[],this.editor_modal=new bootstrap.Modal(document.getElementById("client-editor-modal"),{})},methods:{preparedLawStatus(a){let s=this.statuses.find(o=>o.value===a)||null;return s?s.title:null},sortAndLoad(a){this.sort.column=a,this.sort.direction=this.sort.direction==="desc"?"asc":"desc",this.loadClients(this.current_page)},loadClients(a=0){this.current_page=a,this.$store.dispatch("loadClients",{dataObject:{search:this.search,order:this.sort.column,direction:this.sort.direction},page:this.current_page}).then(s=>{this.items=this.getClients,this.paginate_object=this.getClientsPaginateObject}).catch(()=>{this.loading=!1})},selectItem(a){if(a==null){this.selected_item=null,this.editor_modal.hide();return}this.selected_item=null,this.$nextTick(()=>{this.selected_item=a,this.editor_modal.show()})},duplicateItem(a){this.$store.dispatch("duplicateClient",{materialId:a}).then(()=>{this.sortAndLoad("id")})},removeItem(a){this.$store.dispatch("removeClient",{materialId:a}).then(()=>{this.sortAndLoad("id")})}}},Bt=Object.assign(At,{__name:"ClientTable",setup(a){return(s,o)=>(n(),i(u,null,[t("form",y,[t("div",b,[t("div",C,[t("div",w,[m(t("input",{type:"search","onUpdate:modelValue":o[0]||(o[0]=e=>s.search=e),class:"form-control",id:"search-clients"},null,512),[[f,s.search]]),$]),t("button",{type:"button",onClick:o[1]||(o[1]=e=>s.sortAndLoad("id")),class:"btn btn-outline-secondary rounded-0"},A)])])]),t("div",I,[s.items.length>0?(n(),i("table",j,[t("thead",null,[t("tr",null,[t("th",{scope:"col",class:"cursor-pointer",onClick:o[2]||(o[2]=e=>s.sortAndLoad("id"))},[d("# "),s.sort.direction==="desc"&&s.sort.column==="id"?(n(),i("span",P,D)):l("",!0),s.sort.direction==="asc"&&s.sort.column==="id"?(n(),i("span",O,V)):l("",!0)]),M,t("th",{scope:"col",class:"text-center cursor-pointer",onClick:o[3]||(o[3]=e=>s.sortAndLoad("title"))},[d("Название "),s.sort.direction==="desc"&&s.sort.column==="title"?(n(),i("span",N,E)):l("",!0),s.sort.direction==="asc"&&s.sort.column==="title"?(n(),i("span",F,G)):l("",!0)]),t("th",{scope:"col",class:"text-center cursor-pointer",onClick:o[4]||(o[4]=e=>s.sortAndLoad("title"))},[d(" ФИО "),s.sort.direction==="desc"&&s.sort.column==="fio"?(n(),i("span",U,H)):l("",!0),s.sort.direction==="asc"&&s.sort.column==="fio"?(n(),i("span",J,Q)):l("",!0)]),t("th",{scope:"col",class:"text-center cursor-pointer",onClick:o[5]||(o[5]=e=>s.sortAndLoad("phone"))},[d("Телефон "),s.sort.direction==="desc"&&s.sort.column==="phone"?(n(),i("span",R,X)):l("",!0),s.sort.direction==="asc"&&s.sort.column==="phone"?(n(),i("span",Y,x)):l("",!0)]),t("th",{scope:"col",class:"text-center cursor-pointer",onClick:o[6]||(o[6]=e=>s.sortAndLoad("status"))},[d("Статус клиента "),s.sort.direction==="desc"&&s.sort.column==="status"?(n(),i("span",ss,os)):l("",!0),s.sort.direction==="asc"&&s.sort.column==="status"?(n(),i("span",es,is)):l("",!0)]),t("th",{scope:"col",class:"text-center cursor-pointer",onClick:o[7]||(o[7]=e=>s.sortAndLoad("fact_address"))},[d("Фактический адрес "),s.sort.direction==="desc"&&s.sort.column==="fact_address"?(n(),i("span",ls,as)):l("",!0),s.sort.direction==="asc"&&s.sort.column==="fact_address"?(n(),i("span",rs,us)):l("",!0)]),t("th",{scope:"col",class:"text-center cursor-pointer",onClick:o[8]||(o[8]=e=>s.sortAndLoad("law_address"))},[d("Юридический адрес "),s.sort.direction==="desc"&&s.sort.column==="law_address"?(n(),i("span",_s,ps)):l("",!0),s.sort.direction==="asc"&&s.sort.column==="law_address"?(n(),i("span",ms,ks)):l("",!0)]),t("th",{scope:"col",class:"text-center cursor-pointer",onClick:o[9]||(o[9]=e=>s.sortAndLoad("inn"))},[d("ИНН "),s.sort.direction==="desc"&&s.sort.column==="inn"?(n(),i("span",gs,ys)):l("",!0),s.sort.direction==="asc"&&s.sort.column==="inn"?(n(),i("span",bs,ws)):l("",!0)]),t("th",{scope:"col",class:"text-center cursor-pointer",onClick:o[10]||(o[10]=e=>s.sortAndLoad("kpp"))},[d("КПП "),s.sort.direction==="desc"&&s.sort.column==="kpp"?(n(),i("span",$s,As)):l("",!0),s.sort.direction==="asc"&&s.sort.column==="kpp"?(n(),i("span",Is,Ps)):l("",!0)]),t("th",{scope:"col",class:"text-center cursor-pointer",onClick:o[11]||(o[11]=e=>s.sortAndLoad("ogrn"))},[d("ОГРН "),s.sort.direction==="desc"&&s.sort.column==="ogrn"?(n(),i("span",Bs,Os)):l("",!0),s.sort.direction==="asc"&&s.sort.column==="ogrn"?(n(),i("span",Ts,Ms)):l("",!0)]),t("th",{scope:"col",class:"text-center cursor-pointer",onClick:o[12]||(o[12]=e=>s.sortAndLoad("okpo"))},[d("ОКПО "),s.sort.direction==="desc"&&s.sort.column==="okpo"?(n(),i("span",Ns,Es)):l("",!0),s.sort.direction==="asc"&&s.sort.column==="okpo"?(n(),i("span",Fs,Gs)):l("",!0)]),t("th",{scope:"col",class:"text-center cursor-pointer",onClick:o[13]||(o[13]=e=>s.sortAndLoad("comment"))},[d("Комментарий "),s.sort.direction==="desc"&&s.sort.column==="comment"?(n(),i("span",Us,Hs)):l("",!0),s.sort.direction==="asc"&&s.sort.column==="comment"?(n(),i("span",Js,Qs)):l("",!0)])])]),t("tbody",null,[(n(!0),i(u,null,k(s.items,(e,h)=>(n(),i("tr",null,[t("th",Rs,r(e.id||h),1),t("td",Ws,[t("div",Xs,[Ys,t("ul",Zs,[t("li",null,[t("a",{class:"dropdown-item",onClick:c=>s.selectItem(e),href:"javascript:void(0)"},[st,d("Редактировать")],8,xs)]),t("li",null,[t("a",{class:"dropdown-item text-danger",onClick:c=>s.removeItem(e.id),href:"javascript:void(0)"},[ot,d("Удалить")],8,tt)])])])]),t("td",{class:"text-center",onClick:c=>s.selectItem(e)},r(e.title||"-"),9,et),t("td",{class:"text-center",onClick:c=>s.selectItem(e)},r(e.fio||"-"),9,nt),t("td",it,r(e.phone||"-"),1),t("td",lt,r(s.preparedLawStatus(e.status)||"-"),1),t("td",dt,r(e.fact_address||"-"),1),t("td",at,r(e.law_address||"-"),1),t("td",rt,r(e.inn||"-"),1),t("td",ct,r(e.kpp||"-"),1),t("td",ut,r(e.ogrn||"-"),1),t("td",_t,r(e.okpo||"-"),1),t("td",ht,r(e.comment||"-"),1)]))),256))])])):l("",!0)]),s.items.length===0?(n(),i("div",pt,vt)):l("",!0),s.items.length>0?(n(),i("div",yt,[t("div",bt,[s.paginate_object?(n(),_(g,{key:0,onPagination_page:s.loadClients,pagination:s.paginate_object},null,8,["onPagination_page","pagination"])):l("",!0)])])):l("",!0),t("div",Ct,[t("div",wt,[t("div",$t,[t("div",Lt,[s.selected_item?(n(),_(v,{key:0,item:s.selected_item,onCallback:o[14]||(o[14]=e=>s.selectItem(null))},null,8,["item"])):l("",!0)])])])])],64))}});export{Bt as _};
