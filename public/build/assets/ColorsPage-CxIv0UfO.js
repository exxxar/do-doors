import{_ as $}from"./AuthenticatedLayout-D79ieTT2.js";import{o as l,c as n,b as e,g as c,v as h,h as k,e as d,i as v,F as m,r as _,f as a,t as r,j as w,a as b,m as C,d as p,u as j,w as g,Z as F}from"./app-z9kiq6Oc.js";import{P as L}from"./Pagination-gYfE1NDs.js";import{R as M}from"./RalColorSelector-CoeeZOx-.js";import"./ApplicationLogo-_MoZeCtH.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./IndividualDataForm-192GgHrx.js";import"./vue-the-mask-5y75_0cE.js";const z={class:"form-floating mb-3"},I=e("label",{for:"color-title"},"Наименование цвета",-1),S={class:"form-check form-switch mb-3"},V=e("label",{class:"form-check-label",for:"color-assign_with_size"}," Цена связана с таблицей размеров (по названию цвета) ",-1),A={key:0,class:"card rounded-0 mb-3 border-black"},O=e("div",{class:"card-header bg-dark text-white rounded-0"},[e("h6",null,"Настройка цены")],-1),T={class:"card-body"},U={class:"row"},E={class:"col-6"},P={class:"form-floating mb-3"},q=e("label",{for:"price-wholesale"},"Опт",-1),B={class:"col-6"},R={class:"form-floating mb-3"},N=e("label",{for:"price-retail"},"Розница",-1),D={class:"col-6"},G={class:"form-floating"},J=e("label",{for:"price-dealer"},"Дилер",-1),Z={class:"col-6"},H={class:"form-floating"},K=e("label",{for:"price-cost"},"Себестоимость",-1),Q={class:"input-group mb-3"},W={class:"form-floating"},X=e("label",{for:"color-title"},"Код цвета",-1),Y=e("i",{class:"fa-solid fa-palette"},null,-1),x=[Y],ee={class:"row"},se={class:"col-md-6 col-12"},te={class:"form-floating mb-3"},oe=e("option",{value:null},"Выберите один из вариантов",-1),le=["value"],ie=e("label",{for:"floatingSelect"},"Вариант применения",-1),ne={class:"col-md-6 col-12"},de={class:"dropdown"},re={class:"btn d-flex justify-content-start align-items-center btn-outline-secondary rounded-0 w-100 p-3",type:"button","data-bs-auto-close":"outside","data-bs-toggle":"dropdown","aria-expanded":"false"},ae={key:0,class:"fw-bold ml-1"},ce={class:"dropdown-menu rounded-0 w-100"},ue=["onClick"],he={key:0,class:"fa-solid fa-check"},me={class:"row"},_e={class:"col-12"},pe={class:"alert alert-danger alert-dismissible fade show",role:"alert"},fe=e("strong",null,"Внимание!",-1),be=["onClick"],ge={class:"row mt-5"},ye={class:"col-12 d-flex justify-content-center"},$e=["disabled"],ke={key:0,class:"fa-regular fa-floppy-disk mr-1"},ve={key:1,class:"spinner-border spinner-border-sm text-success",role:"status"},we=e("i",{class:"fa-solid fa-xmark mr-1"},null,-1),Ce=["id"],je={class:"modal-dialog"},Fe={class:"modal-content rounded-0"},Le=e("div",{class:"modal-header"},[e("h1",{class:"modal-title fs-5",id:"exampleModalLabel"},"Выбор цвета RAL"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),Me={class:"modal-body"},ze={props:["item","id"],data(){return{messages:[],loading:!1,colorModal:null,types:[{title:"Для всех",key:"all",usage:["type"]},{title:"Отделка сторон",key:"side_finish",usage:["type"]},{title:"Короб и каркас",key:"box_and_frame",usage:["type","excludes"]},{title:"Фурнитура",key:"fittings",usage:["type","excludes"]},{title:"Уплотнитель",key:"seal",usage:["type","excludes"]}],form:{id:null,title:null,price:{wholesale:0,dealer:0,retail:0,cost:0},code:null,type:null,excludes:[],assign_with_size:!1}}},computed:{filteredTypes(){return this.types.filter(i=>i.usage.indexOf("type")!==-1)},filteredExcludes(){return this.types.filter(i=>i.usage.indexOf("excludes")!==-1)},needClearForm(){return this.form.id||this.form.title||this.form.price||this.form.code||this.form.type}},mounted(){this.item&&this.$nextTick(()=>{this.form={id:this.item.id||null,title:this.item.title||null,price:this.item.price||{wholesale:0,dealer:0,retail:0,cost:0},excludes:this.item.excludes||[],code:this.item.code||null,type:this.item.type||null,assign_with_size:this.item.assign_with_size||!1}})},methods:{addToExcludes(i){this.form.excludes||(this.form.excludes=[]);let s=this.form.excludes.findIndex(o=>o===i.key);s===-1?this.form.excludes.push(i.key):this.form.excludes.splice(s,1)},callbackSelectColor(i){this.form.title=i.names.en||i.color.code,this.form.code=i.color.code||i.color.hex||null,this.colorModal.hide()},selectColor(){this.loadRalColors(),this.colorModal=new bootstrap.Modal(document.getElementById(this.id+"-choose-color"),{}),this.colorModal.show()},loadRalColors(){this.$store.dispatch("loadRalColors")},alert(i){this.messages.push(i)},resetForm(){this.form.id=null,this.form.title=null,this.form.price={wholesale:0,dealer:0,retail:0,cost:0},this.form.code=null,this.form.type=null,this.form.excludes=[],this.$emit("callback")},removeMessage(i){this.messages.splice(i,1)},submit(){let i=new FormData;Object.keys(this.form).forEach(s=>{const o=this.form[s]||"";typeof o=="object"?i.append(s,JSON.stringify(o)):i.append(s,o)}),this.$store.dispatch("storeColor",{colorForm:i}).then(s=>{this.$emit("callback"),this.resetForm()}).catch(s=>{})}}},y=Object.assign(ze,{__name:"ColorForm",setup(i){return(s,o)=>(l(),n(m,null,[e("form",{action:"",onSubmit:o[11]||(o[11]=w((...t)=>s.submit&&s.submit(...t),["prevent"]))},[e("div",z,[c(e("input",{type:"text","onUpdate:modelValue":o[0]||(o[0]=t=>s.form.title=t),class:"form-control",id:"color-title",required:""},null,512),[[h,s.form.title]]),I]),e("div",S,[c(e("input",{class:"form-check-input","onUpdate:modelValue":o[1]||(o[1]=t=>s.form.assign_with_size=t),type:"checkbox",role:"switch",id:"color-assign_with_size",checked:""},null,512),[[k,s.form.assign_with_size]]),V]),s.form.assign_with_size?d("",!0):(l(),n("div",A,[O,e("div",T,[e("div",U,[e("div",E,[e("div",P,[c(e("input",{type:"number","onUpdate:modelValue":o[2]||(o[2]=t=>s.form.price.wholesale=t),class:"form-control",id:"price-wholesale",required:""},null,512),[[h,s.form.price.wholesale]]),q])]),e("div",B,[e("div",R,[c(e("input",{type:"number","onUpdate:modelValue":o[3]||(o[3]=t=>s.form.price.retail=t),class:"form-control",id:"price-retail",required:""},null,512),[[h,s.form.price.retail]]),N])]),e("div",D,[e("div",G,[c(e("input",{type:"number","onUpdate:modelValue":o[4]||(o[4]=t=>s.form.price.dealer=t),class:"form-control",id:"price-dealer",required:""},null,512),[[h,s.form.price.dealer]]),J])]),e("div",Z,[e("div",H,[c(e("input",{type:"number","onUpdate:modelValue":o[5]||(o[5]=t=>s.form.price.cost=t),class:"form-control",id:"price-cost",required:""},null,512),[[h,s.form.price.cost]]),K])])])])])),e("div",Q,[e("div",W,[c(e("input",{type:"text","onUpdate:modelValue":o[6]||(o[6]=t=>s.form.code=t),class:"form-control",id:"color-code"},null,512),[[h,s.form.code]]),X]),e("button",{type:"button",onClick:o[7]||(o[7]=(...t)=>s.selectColor&&s.selectColor(...t)),class:"btn btn-outline-secondary rounded-0",id:"basic-addon1"},x)]),e("div",ee,[e("div",se,[e("div",te,[c(e("select",{class:"form-select",onInvalid:o[8]||(o[8]=t=>s.alert("Вы не выбрали вариант использования!")),"onUpdate:modelValue":o[9]||(o[9]=t=>s.form.type=t),id:"floatingSelect","aria-label":"Floating label select example",required:""},[oe,(l(!0),n(m,null,_(s.filteredTypes,t=>(l(),n("option",{value:t.key},r(t.title),9,le))),256))],544),[[v,s.form.type]]),ie])]),e("div",ne,[e("div",de,[e("button",re,[a(" Исключения из расчёта "),(s.form.excludes||[]).length>0?(l(),n("span",ae,"("+r(s.form.excludes.length)+")",1)):d("",!0)]),e("ul",ce,[(l(!0),n(m,null,_(s.filteredExcludes,t=>(l(),n("li",null,[e("a",{class:"dropdown-item",onClick:u=>s.addToExcludes(t),href:"javascript:void(0)"},[s.form.excludes.indexOf(t.key)!=-1?(l(),n("i",he)):d("",!0),a(" "+r(t.title),1)],8,ue)]))),256))])])])]),e("div",me,[e("div",_e,[s.messages.length>0?(l(!0),n(m,{key:0},_(s.messages,(t,u)=>(l(),n("div",pe,[fe,a(" "+r(t||"Ошибка")+" ",1),e("button",{type:"button",class:"btn-close",onClick:f=>s.removeMessage(u)},null,8,be)]))),256)):d("",!0)])]),e("div",ge,[e("div",ye,[e("button",{disabled:!s.needClearForm,class:"btn btn-dark rounded-0"},[s.loading?(l(),n("span",ve)):(l(),n("i",ke)),a(" Сохранить цвет ")],8,$e),s.needClearForm&&!s.loading?(l(),n("button",{key:0,type:"button",onClick:o[10]||(o[10]=(...t)=>s.resetForm&&s.resetForm(...t)),class:"btn btn-outline-secondary rounded-0 ml-2"},[we,a(" Очистить форму ")])):d("",!0)])])],32),e("div",{style:{"z-index":"10000"},class:"modal fade",id:i.id+"-choose-color",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},[e("div",je,[e("div",Fe,[Le,e("div",Me,[b(M,{"need-load-color":!0,onSelect:s.callbackSelectColor},null,8,["onSelect"])])])])],8,Ce)],64))}}),Ie={class:"row"},Se={class:"col-12"},Ve={class:"input-group mb-3"},Ae={class:"form-floating"},Oe=e("label",{for:"search-colors"},"Поиск по цвету",-1),Te=e("i",{class:"fa-solid fa-magnifying-glass"},null,-1),Ue=[Te],Ee={style:{"overflow-y":"auto"}},Pe={key:0,class:"table"},qe={key:0},Be=e("i",{class:"fa-solid fa-caret-down"},null,-1),Re=[Be],Ne={key:1},De=e("i",{class:"fa-solid fa-caret-up"},null,-1),Ge=[De],Je=e("th",{scope:"col",class:"text-center"},"Действие",-1),Ze={key:0},He=e("i",{class:"fa-solid fa-caret-down"},null,-1),Ke=[He],Qe={key:1},We=e("i",{class:"fa-solid fa-caret-up"},null,-1),Xe=[We],Ye={key:0},xe=e("i",{class:"fa-solid fa-caret-down"},null,-1),es=[xe],ss={key:1},ts=e("i",{class:"fa-solid fa-caret-up"},null,-1),os=[ts],ls={key:0},is=e("i",{class:"fa-solid fa-caret-down"},null,-1),ns=[is],ds={key:1},rs=e("i",{class:"fa-solid fa-caret-up"},null,-1),as=[rs],cs={key:0},us=e("i",{class:"fa-solid fa-caret-down"},null,-1),hs=[us],ms={key:1},_s=e("i",{class:"fa-solid fa-caret-up"},null,-1),ps=[_s],fs={key:0},bs=e("i",{class:"fa-solid fa-caret-down"},null,-1),gs=[bs],ys={key:1},$s=e("i",{class:"fa-solid fa-caret-up"},null,-1),ks=[$s],vs={scope:"row"},ws={class:"text-center"},Cs={class:"dropdown"},js=e("button",{class:"btn btn-link",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-bars"})],-1),Fs={class:"dropdown-menu"},Ls=["onClick"],Ms=e("i",{class:"fa-solid fa-pen mr-2"},null,-1),zs=["onClick"],Is=e("i",{class:"fa-solid fa-trash-can mr-2"},null,-1),Ss=["onClick"],Vs={class:"text-center"},As={key:0,class:"w-100"},Os=e("thead",null,[e("th",null,"опт"),e("th",null,"дилер"),e("th",null,"розница"),e("th",null,"себестоимость")],-1),Ts={style:{"min-width":"100px","text-align":"center"}},Us={style:{"min-width":"100px","text-align":"center"}},Es={style:{"min-width":"100px","text-align":"center"}},Ps={style:{"min-width":"100px","text-align":"center"}},qs={key:1},Bs={class:"text-center"},Rs={class:"text-center"},Ns={class:"text-center"},Ds={key:0,class:"alert alert-success",role:"alert"},Gs=e("h4",{class:"alert-heading"},"Цвета",-1),Js=e("p",null,"К сожалению, раздел петель пуст. Вы еще не добавили ни одного цвета, которые можно отобразить на этой странице.",-1),Zs=e("hr",null,null,-1),Hs=e("p",{class:"mb-0"},"Воспользуйтесь формой выше и добавьте первый цвет",-1),Ks=[Gs,Js,Zs,Hs],Qs={key:1,class:"row mb-3"},Ws={class:"col-12"},Xs={class:"modal fade",id:"color-editor-modal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},Ys={class:"modal-dialog modal-lg"},xs={class:"modal-content rounded-0"},et={class:"modal-body"},st={data(){return{editor_modal:null,selected_item:null,sort:{column:null,direction:"desc"},search:null,current_page:0,paginate_object:null,items:[{id:null,title:null,price:0}]}},computed:{...C(["getColors","getColorsPaginateObject"])},mounted(){this.loadColors(),this.editor_modal=new bootstrap.Modal(document.getElementById("color-editor-modal"),{})},methods:{sortAndLoad(i){this.sort.column=i,this.sort.direction=this.sort.direction==="desc"?"asc":"desc",this.loadColors(this.current_page)},loadColors(i=0){this.current_page=i,this.$store.dispatch("loadColors",{dataObject:{search:this.search,order:this.sort.column,direction:this.sort.direction},page:this.current_page}).then(s=>{this.items=this.getColors,this.paginate_object=this.getColorsPaginateObject}).catch(()=>{this.loading=!1})},selectItem(i){if(i==null){this.selected_item=null,this.editor_modal.hide();return}this.selected_item=null,this.$nextTick(()=>{this.selected_item=i,this.editor_modal.show()})},duplicateItem(i){this.$store.dispatch("duplicateColor",{colorId:i}).then(()=>{this.sortAndLoad("id")})},removeItem(i){this.$store.dispatch("removeColor",{colorId:i}).then(()=>{this.sortAndLoad("id")})}}},tt=Object.assign(st,{__name:"ColorTable",setup(i){return(s,o)=>(l(),n(m,null,[e("form",Ie,[e("div",Se,[e("div",Ve,[e("div",Ae,[c(e("input",{type:"search","onUpdate:modelValue":o[0]||(o[0]=t=>s.search=t),class:"form-control",id:"search-colors"},null,512),[[h,s.search]]),Oe]),e("button",{type:"button",onClick:o[1]||(o[1]=t=>s.sortAndLoad("id")),class:"btn btn-outline-secondary rounded-0"},Ue)])])]),e("div",Ee,[s.items.length>0?(l(),n("table",Pe,[e("thead",null,[e("tr",null,[e("th",{scope:"col",class:"cursor-pointer",onClick:o[2]||(o[2]=t=>s.sortAndLoad("id"))},[a("# "),s.sort.direction==="desc"&&s.sort.column==="id"?(l(),n("span",qe,Re)):d("",!0),s.sort.direction==="asc"&&s.sort.column==="id"?(l(),n("span",Ne,Ge)):d("",!0)]),Je,e("th",{scope:"col",class:"text-center cursor-pointer",onClick:o[3]||(o[3]=t=>s.sortAndLoad("title"))},[a("Название "),s.sort.direction==="desc"&&s.sort.column==="title"?(l(),n("span",Ze,Ke)):d("",!0),s.sort.direction==="asc"&&s.sort.column==="title"?(l(),n("span",Qe,Xe)):d("",!0)]),e("th",{scope:"col",class:"text-center cursor-pointer",onClick:o[4]||(o[4]=t=>s.sortAndLoad("price"))},[a("Цена "),s.sort.direction==="desc"&&s.sort.column==="price"?(l(),n("span",Ye,es)):d("",!0),s.sort.direction==="asc"&&s.sort.column==="price"?(l(),n("span",ss,os)):d("",!0)]),e("th",{scope:"col",class:"text-center cursor-pointer",onClick:o[5]||(o[5]=t=>s.sortAndLoad("code"))},[a("Код цвета "),s.sort.direction==="desc"&&s.sort.column==="code"?(l(),n("span",ls,ns)):d("",!0),s.sort.direction==="asc"&&s.sort.column==="code"?(l(),n("span",ds,as)):d("",!0)]),e("th",{scope:"col",class:"text-center cursor-pointer",onClick:o[6]||(o[6]=t=>s.sortAndLoad("assign_with_size"))},[a("Привязан к размеру "),s.sort.direction==="desc"&&s.sort.column==="assign_with_size"?(l(),n("span",cs,hs)):d("",!0),s.sort.direction==="asc"&&s.sort.column==="assign_with_size"?(l(),n("span",ms,ps)):d("",!0)]),e("th",{scope:"col",class:"text-center cursor-pointer",onClick:o[7]||(o[7]=t=>s.sortAndLoad("type"))},[a("Тип "),s.sort.direction==="desc"&&s.sort.column==="type"?(l(),n("span",fs,gs)):d("",!0),s.sort.direction==="asc"&&s.sort.column==="type"?(l(),n("span",ys,ks)):d("",!0)])])]),e("tbody",null,[(l(!0),n(m,null,_(s.items,(t,u)=>(l(),n("tr",null,[e("th",vs,r(t.id||u),1),e("td",ws,[e("div",Cs,[js,e("ul",Fs,[e("li",null,[e("a",{class:"dropdown-item",onClick:f=>s.selectItem(t),href:"javascript:void(0)"},[Ms,a("Редактировать")],8,Ls)]),e("li",null,[e("a",{class:"dropdown-item text-danger",onClick:f=>s.removeItem(t.id),href:"javascript:void(0)"},[Is,a("Удалить")],8,zs)])])])]),e("td",{class:"text-center",onClick:f=>s.selectItem(t)},r(t.title||"-"),9,Ss),e("td",Vs,[t.assign_with_size?(l(),n("p",qs," Цены к цвету указаны в таблице размеров ")):(l(),n("table",As,[Os,e("tbody",null,[e("tr",null,[e("td",Ts,r(s.items[u].price.wholesale||0),1),e("td",Us,r(s.items[u].price.dealer||0),1),e("td",Es,r(s.items[u].price.retail||0),1),e("td",Ps,r(s.items[u].price.cost||0),1)])])]))]),e("td",Bs,r(t.code||"Не задан"),1),e("td",Rs,r(t.assign_with_size?"Да":"Нет"),1),e("td",Ns,r(t.type||"Не задан"),1)]))),256))])])):d("",!0)]),s.items.length===0?(l(),n("div",Ds,Ks)):d("",!0),s.items.length>0?(l(),n("div",Qs,[e("div",Ws,[s.paginate_object?(l(),p(L,{key:0,onPagination_page:s.loadColors,pagination:s.paginate_object},null,8,["onPagination_page","pagination"])):d("",!0)])])):d("",!0),e("div",Xs,[e("div",Ys,[e("div",xs,[e("div",et,[s.selected_item?(l(),p(y,{key:0,id:"color-form-2",item:s.selected_item,onCallback:o[8]||(o[8]=t=>s.selectItem(null))},null,8,["item"])):d("",!0)])])])])],64))}}),ot=e("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"},"Цвета",-1),lt={class:"py-12"},it={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},nt={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},dt={class:"p-6 text-gray-900"},rt=e("hr",{class:"hr my-5"},null,-1),at={data(){return{loading:!1,selectedColor:null}},methods:{selectColor(i){this.selectedColor=i,this.loading=!0,this.$nextTick(()=>{this.loading=!1})},callbackColorForm(){this.loading=!0,this.selectedColor=null,this.$nextTick(()=>{this.loading=!1})}}},gt=Object.assign(at,{__name:"ColorsPage",setup(i){return(s,o)=>(l(),n(m,null,[b(j(F),{title:"Цвета"}),b($,null,{header:g(()=>[ot]),default:g(()=>[e("div",lt,[e("div",it,[e("div",nt,[e("div",dt,[s.loading?d("",!0):(l(),p(y,{key:0,id:"color-form-1",item:s.selectedColor,onCallback:s.callbackColorForm},null,8,["item","onCallback"])),rt,s.loading?d("",!0):(l(),p(tt,{key:1,onSelect:s.selectColor},null,8,["onSelect"]))])])])])]),_:1})],64))}});export{gt as default};
